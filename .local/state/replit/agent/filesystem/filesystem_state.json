{"file_contents":{"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport {\n  loadRequests,\n  loadLearningPeers,\n  loadVolunteerSchedules,\n  loadLearnerSchedules,\n} from \"./googleSheets\";\nimport { runMatchingAlgorithm } from \"./matchingAlgorithm\";\nimport { generateMatchConfirmationEmail } from \"./emailTemplate\";\nimport { setupAuth, isAuthenticated } from \"./replitAuth\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Setup authentication\n  await setupAuth(app);\n\n  // Auth endpoint - get current user (NOT protected - allows checking auth status)\n  app.get('/api/auth/user', async (req: any, res) => {\n    if (!req.isAuthenticated() || !req.user?.claims?.sub) {\n      return res.status(401).json({ message: \"Unauthorized\" });\n    }\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // POST /api/matching-runs - Start a new matching run\n  app.post(\"/api/matching-runs\", isAuthenticated, async (req, res) => {\n    try {\n      const { newRequestsOnly } = req.body || {};\n      console.log(`Starting new matching run... (newRequestsOnly: ${newRequestsOnly})`);\n      \n      // Create initial run record\n      const run = await storage.createMatchingRun({\n        timestamp: new Date(),\n        totalLearners: 0,\n        totalPeers: 0,\n        matchedLearners: 0,\n        unmatchedLearners: 0,\n        proposedGroups: 0,\n        status: 'running',\n        newRequestsOnly: newRequestsOnly || false,\n      });\n\n      // Ingest data from Google Sheets asynchronously\n      Promise.resolve().then(async () => {\n        try {\n          console.log('Loading data from Google Sheets...');\n          \n          const [requests, peers, volunteerSchedules, learnerSchedules] = await Promise.all([\n            loadRequests(),\n            loadLearningPeers(),\n            loadVolunteerSchedules(),\n            loadLearnerSchedules(),\n          ]);\n\n          console.log(`Loaded ${requests.length} requests, ${peers.length} peers`);\n\n          // Get approved learner emails if doing incremental matching\n          let excludedLearnerEmails: string[] = [];\n          if (newRequestsOnly) {\n            excludedLearnerEmails = await storage.getApprovedLearnerEmails();\n            console.log(`Incremental matching: Excluding ${excludedLearnerEmails.length} already-approved learners`);\n          }\n\n          // Run matching algorithm\n          console.log('Running matching algorithm...');\n          const result = runMatchingAlgorithm({\n            requests,\n            peers,\n            learnerSchedules,\n            volunteerSchedules,\n            excludedLearnerEmails,\n          });\n\n          console.log(`Matched ${result.groups.length} groups, ${result.unmatched.length} unmatched`);\n\n          // Store results\n          for (const group of result.groups) {\n            await storage.createGroup(run.id, group);\n          }\n\n          await storage.setUnmatchedParticipants(run.id, result.unmatched);\n\n          // Update run record with metrics\n          const matchedLearners = result.groups.reduce((sum, g) => sum + g.learners.length, 0);\n          const unmatchedLearners = result.unmatched.filter(u => u.role === 'Learner').length;\n          \n          await storage.updateMatchingRunMetrics(run.id, {\n            totalLearners: requests.length,\n            totalPeers: peers.length,\n            matchedLearners,\n            unmatchedLearners,\n            proposedGroups: result.groups.length,\n          });\n          \n          await storage.updateMatchingRunStatus(run.id, 'completed');\n\n          console.log('Matching run completed successfully');\n        } catch (error) {\n          console.error('Error during matching run:', error);\n          await storage.updateMatchingRunStatus(run.id, 'failed');\n        }\n      });\n\n      // Return immediately with run ID\n      res.json({\n        success: true,\n        runId: run.id,\n        status: 'running',\n        message: 'Matching run started. Processing data from Google Sheets...',\n      });\n    } catch (error) {\n      console.error('Error starting matching run:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/matching-runs/:id - Get matching run details\n  app.get(\"/api/matching-runs/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const run = await storage.getMatchingRun(req.params.id);\n      \n      if (!run) {\n        return res.status(404).json({\n          success: false,\n          error: 'Matching run not found',\n        });\n      }\n\n      // Serialize date to string for JSON\n      const serializedRun = {\n        ...run,\n        timestamp: run.timestamp.toISOString(),\n      };\n\n      res.json({\n        success: true,\n        run: serializedRun,\n      });\n    } catch (error) {\n      console.error('Error fetching matching run:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/matching-runs - Get all matching runs\n  app.get(\"/api/matching-runs\", isAuthenticated, async (req, res) => {\n    try {\n      const runs = await storage.getAllMatchingRuns();\n      \n      // Serialize dates to strings for JSON\n      const serializedRuns = runs.map(run => ({\n        ...run,\n        timestamp: run.timestamp.toISOString(),\n      }));\n      \n      res.json({\n        success: true,\n        runs: serializedRuns,\n      });\n    } catch (error) {\n      console.error('Error fetching matching runs:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/groups - Get all groups (pending and approved)\n  app.get(\"/api/groups\", isAuthenticated, async (req, res) => {\n    try {\n      const runs = await storage.getAllMatchingRuns();\n      \n      if (runs.length === 0) {\n        return res.json({\n          success: true,\n          groups: [],\n        });\n      }\n\n      const latestRun = runs[0]; // Most recent run\n      \n      // If incremental matching (newRequestsOnly: true), preserve approved groups from all runs\n      // If full matching (newRequestsOnly: false), only show groups from latest run\n      let groups;\n      \n      if (latestRun.newRequestsOnly) {\n        // Incremental: Show all approved groups + latest run's pending groups\n        const allGroups = await storage.getAllGroups();\n        const approvedGroups = allGroups.filter(g => g.status === 'approved');\n        \n        const latestRunGroups = await storage.getGroupsByRunId(latestRun.id);\n        const pendingGroups = latestRunGroups.filter(g => g.status === 'pending');\n        \n        groups = [...approvedGroups, ...pendingGroups];\n      } else {\n        // Full match: Only show groups from latest run (clears previous matches)\n        groups = await storage.getGroupsByRunId(latestRun.id);\n      }\n      \n      res.json({\n        success: true,\n        groups,\n      });\n    } catch (error) {\n      console.error('Error fetching groups:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // POST /api/groups/bulk-approve - Bulk approve multiple groups\n  app.post(\"/api/groups/bulk-approve\", isAuthenticated, async (req, res) => {\n    try {\n      const { groupIds } = req.body;\n      \n      if (!Array.isArray(groupIds) || groupIds.length === 0) {\n        return res.status(400).json({\n          success: false,\n          error: 'groupIds must be a non-empty array',\n        });\n      }\n\n      const results = [];\n      const runs = await storage.getAllMatchingRuns();\n      const latestRun = runs[0];\n      \n      for (const groupId of groupIds) {\n        const group = await storage.getGroup(groupId);\n        if (group) {\n          await storage.updateGroupStatus(groupId, 'approved');\n          results.push({ groupId, status: 'approved' });\n          \n          // Calculate group number for this peer\n          if (latestRun) {\n            const allGroups = await storage.getGroupsByRunId(latestRun.id);\n            const peerGroups = allGroups.filter(g => g.peerId === group.peerId && g.status === 'approved');\n            const peerGroupNumber = peerGroups.length;\n            \n            // Generate confirmation email\n            const { subject, body } = generateMatchConfirmationEmail(group, peerGroupNumber);\n            console.log(`Bulk approved group ${groupId}: ${group.peerEmail}, ${group.learners.map(l => l.email).join(', ')}`);\n            console.log(`Email subject: ${subject}`);\n          }\n        } else {\n          results.push({ groupId, status: 'not_found' });\n        }\n      }\n\n      res.json({\n        success: true,\n        message: `Approved ${results.filter(r => r.status === 'approved').length} groups`,\n        results,\n      });\n    } catch (error) {\n      console.error('Error bulk approving groups:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // POST /api/groups/:id/approve - Approve a group\n  app.post(\"/api/groups/:id/approve\", isAuthenticated, async (req, res) => {\n    try {\n      const group = await storage.getGroup(req.params.id);\n      \n      if (!group) {\n        return res.status(404).json({\n          success: false,\n          error: 'Group not found',\n        });\n      }\n\n      // Update group status\n      await storage.updateGroupStatus(req.params.id, 'approved');\n\n      // Calculate group number for this peer\n      const runs = await storage.getAllMatchingRuns();\n      const latestRun = runs[0];\n      let peerGroupNumber = 1;\n      \n      if (latestRun) {\n        const allGroups = await storage.getGroupsByRunId(latestRun.id);\n        const peerGroups = allGroups.filter(g => g.peerId === group.peerId && g.status === 'approved');\n        peerGroupNumber = peerGroups.length;\n      }\n\n      // Generate confirmation email\n      const { subject, body } = generateMatchConfirmationEmail(group, peerGroupNumber);\n\n      // Log email that would be sent (in production, this would send via email service)\n      console.log(`Sending email notifications for group ${req.params.id}`);\n      console.log(`Recipients: ${group.peerEmail}, ${group.learners.map(l => l.email).join(', ')}`);\n      console.log(`Subject: ${subject}`);\n      console.log(`Body: ${body}`);\n\n      res.json({\n        success: true,\n        message: 'Group approved and notifications sent',\n        group: await storage.getGroup(req.params.id),\n      });\n    } catch (error) {\n      console.error('Error approving group:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // POST /api/groups/:id/reject - Reject and re-queue a group\n  app.post(\"/api/groups/:id/reject\", isAuthenticated, async (req, res) => {\n    try {\n      const group = await storage.getGroup(req.params.id);\n      \n      if (!group) {\n        return res.status(404).json({\n          success: false,\n          error: 'Group not found',\n        });\n      }\n\n      // Mark as rejected and delete\n      await storage.updateGroupStatus(req.params.id, 'rejected');\n      await storage.deleteGroup(req.params.id);\n\n      // In a real implementation, participants would be added back to the pool\n      console.log(`Participants re-queued for group ${req.params.id}`);\n\n      res.json({\n        success: true,\n        message: 'Group rejected and participants re-queued',\n      });\n    } catch (error) {\n      console.error('Error rejecting group:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // PATCH /api/groups/:id - Update a group manually\n  app.patch(\"/api/groups/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const group = await storage.getGroup(req.params.id);\n      \n      if (!group) {\n        return res.status(404).json({\n          success: false,\n          error: 'Group not found',\n        });\n      }\n\n      // Update the group with provided fields\n      await storage.updateGroup(req.params.id, req.body);\n\n      res.json({\n        success: true,\n        message: 'Group updated successfully',\n        group: await storage.getGroup(req.params.id),\n      });\n    } catch (error) {\n      console.error('Error updating group:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/unmatched - Get unmatched participants\n  app.get(\"/api/unmatched\", isAuthenticated, async (req, res) => {\n    try {\n      const participants = await storage.getLatestUnmatchedParticipants();\n      \n      res.json({\n        success: true,\n        participants,\n      });\n    } catch (error) {\n      console.error('Error fetching unmatched participants:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/peers/without-groups - Get learning peers with no assigned groups\n  app.get(\"/api/peers/without-groups\", isAuthenticated, async (req, res) => {\n    try {\n      // Load all peers from Google Sheets\n      const allPeers = await loadLearningPeers();\n      \n      // Get all groups from the latest matching run\n      const runs = await storage.getAllMatchingRuns();\n      const latestRun = runs[0];\n      \n      let assignedPeerEmails = new Set<string>();\n      if (latestRun) {\n        const allGroups = await storage.getGroupsByRunId(latestRun.id);\n        assignedPeerEmails = new Set(allGroups.map(g => g.peerEmail));\n      }\n      \n      // Filter peers to only those not in any groups\n      const peersWithoutGroups = allPeers.filter(peer => !assignedPeerEmails.has(peer.email));\n      \n      res.json({\n        success: true,\n        peers: peersWithoutGroups,\n      });\n    } catch (error) {\n      console.error('Error fetching peers without groups:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/export/groups - Export groups as CSV\n  app.get(\"/api/export/groups\", isAuthenticated, async (req, res) => {\n    try {\n      const runs = await storage.getAllMatchingRuns();\n      const latestRun = runs[0];\n      \n      if (!latestRun) {\n        return res.status(404).json({\n          success: false,\n          error: 'No matching runs found',\n        });\n      }\n\n      const allGroups = await storage.getGroupsByRunId(latestRun.id);\n      \n      // Build CSV content\n      const headers = ['Group ID', 'Course Code', 'Peer Name', 'Peer Email', 'Status', 'Day', 'Start Time', 'End Time', 'Learner Names', 'Learner Instructors', 'Learner Emails'];\n      const rows = allGroups.map(g => [\n        g.id,\n        g.courseCode,\n        g.peerName,\n        g.peerEmail,\n        g.status,\n        g.timeSlot.day,\n        g.timeSlot.start,\n        g.timeSlot.end,\n        g.learners.map(l => l.name).join('; '),\n        g.learners.map(l => l.instructor || 'N/A').join('; '),\n        g.learners.map(l => l.email).join('; '),\n      ]);\n\n      const csv = [headers.join(','), ...rows.map(row => row.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(','))].join('\\n');\n\n      res.setHeader('Content-Type', 'text/csv');\n      res.setHeader('Content-Disposition', `attachment; filename=\"groups-${new Date().toISOString().split('T')[0]}.csv\"`);\n      res.send(csv);\n    } catch (error) {\n      console.error('Error exporting groups:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/export/unmatched - Export unmatched participants as CSV\n  app.get(\"/api/export/unmatched\", isAuthenticated, async (req, res) => {\n    try {\n      const participants = await storage.getLatestUnmatchedParticipants();\n      \n      // Build CSV content\n      const headers = ['Name', 'Email', 'Role', 'Course Code', 'Constraint Failure'];\n      const rows = participants.map(p => [\n        p.name,\n        p.email,\n        p.role,\n        p.courseCode,\n        p.constraintFailure || '',\n      ]);\n\n      const csv = [headers.join(','), ...rows.map(row => row.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(','))].join('\\n');\n\n      res.setHeader('Content-Type', 'text/csv');\n      res.setHeader('Content-Disposition', `attachment; filename=\"unmatched-${new Date().toISOString().split('T')[0]}.csv\"`);\n      res.send(csv);\n    } catch (error) {\n      console.error('Error exporting unmatched:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/dashboard-stats - Get aggregated dashboard statistics\n  app.get(\"/api/dashboard-stats\", isAuthenticated, async (req, res) => {\n    try {\n      const runs = await storage.getAllMatchingRuns();\n      const latestRun = runs[0]; // Most recent run\n      \n      // Get stats from latest completed run\n      let stats = {\n        totalLearners: 0,\n        totalPeers: 0,\n        matchedLearners: 0,\n        matchRate: 0,\n        pendingGroups: 0,\n        approvedGroups: 0,\n        unmatchedCount: 0,\n      };\n      \n      if (latestRun && latestRun.status === 'completed') {\n        stats.totalLearners = latestRun.totalLearners;\n        stats.totalPeers = latestRun.totalPeers;\n        stats.matchedLearners = latestRun.matchedLearners;\n        stats.matchRate = latestRun.totalLearners > 0 \n          ? Math.round((latestRun.matchedLearners / latestRun.totalLearners) * 100) \n          : 0;\n        \n        // Get group counts by status\n        const allGroups = await storage.getGroupsByRunId(latestRun.id);\n        stats.pendingGroups = allGroups.filter(g => g.status === 'pending').length;\n        stats.approvedGroups = allGroups.filter(g => g.status === 'approved').length;\n        \n        // Get unmatched count\n        const unmatched = await storage.getLatestUnmatchedParticipants();\n        stats.unmatchedCount = unmatched.length;\n      }\n      \n      // Build recent activity from matching runs\n      const recentActivity = runs.slice(0, 5).map(run => ({\n        id: run.id,\n        type: 'run' as const,\n        description: run.status === 'completed' \n          ? `Matching run completed: ${run.matchedLearners} learners matched into ${run.proposedGroups} groups`\n          : run.status === 'running' \n            ? 'Matching run in progress...'\n            : 'Matching run failed',\n        timestamp: run.timestamp,\n        status: run.status,\n      }));\n      \n      res.json({\n        success: true,\n        stats,\n        recentActivity,\n        lastRunTimestamp: latestRun?.timestamp,\n      });\n    } catch (error) {\n      console.error('Error fetching dashboard stats:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // POST /api/sync-data - Sync data from Google Sheets\n  app.post(\"/api/sync-data\", isAuthenticated, async (req, res) => {\n    try {\n      console.log('Syncing data from Google Sheets...');\n      \n      const [requests, peers, volunteerSchedules, learnerSchedules] = await Promise.all([\n        loadRequests(),\n        loadLearningPeers(),\n        loadVolunteerSchedules(),\n        loadLearnerSchedules(),\n      ]);\n\n      res.json({\n        success: true,\n        message: 'Data synced successfully',\n        data: {\n          requests: requests.length,\n          peers: peers.length,\n          volunteerSchedules: volunteerSchedules.length,\n          learnerSchedules: learnerSchedules.length,\n        },\n        timestamp: new Date(),\n      });\n    } catch (error) {\n      console.error('Error syncing data:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/settings - Get current system settings and status\n  app.get(\"/api/settings\", isAuthenticated, async (req, res) => {\n    try {\n      const runs = await storage.getAllMatchingRuns();\n      const latestRun = runs[0];\n      \n      // Get counts from latest run\n      let totalLearners = 0;\n      let totalPeers = 0;\n      let totalGroups = 0;\n      \n      if (latestRun) {\n        totalLearners = latestRun.totalLearners;\n        totalPeers = latestRun.totalPeers;\n        totalGroups = latestRun.proposedGroups;\n      }\n      \n      res.json({\n        success: true,\n        settings: {\n          dataSource: {\n            connected: true,\n            type: 'Google Sheets',\n            lastSync: latestRun?.timestamp || null,\n          },\n          matchingConstraints: {\n            maxGroupSize: 4,\n            minGroupSize: 1,\n            maxPeerGroups: 2,\n            travelBufferMinutes: 5,\n            availabilityStart: '08:00',\n            availabilityEnd: '20:00',\n          },\n          statistics: {\n            totalMatchingRuns: runs.length,\n            totalLearners,\n            totalPeers,\n            totalGroups,\n            lastRunStatus: latestRun?.status || 'none',\n          },\n        },\n      });\n    } catch (error) {\n      console.error('Error fetching settings:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // POST /api/admin/reset-semester - Reset all matching data for new semester\n  app.post(\"/api/admin/reset-semester\", isAuthenticated, async (req, res) => {\n    try {\n      console.log('Resetting semester data...');\n      await storage.resetSemester();\n      console.log('Semester data reset successfully');\n      \n      res.json({\n        success: true,\n        message: 'All matching data has been cleared. Ready for new semester.',\n      });\n    } catch (error) {\n      console.error('Error resetting semester:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // GET /api/admin/allowed-emails - Get all allowed emails\n  app.get(\"/api/admin/allowed-emails\", isAuthenticated, async (req, res) => {\n    try {\n      const emails = await storage.getAllowedEmails();\n      res.json(emails);\n    } catch (error) {\n      console.error('Error fetching allowed emails:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // POST /api/admin/allowed-emails - Add a new allowed email\n  app.post(\"/api/admin/allowed-emails\", isAuthenticated, async (req: any, res) => {\n    try {\n      const { email } = req.body;\n      if (!email || typeof email !== 'string') {\n        return res.status(400).json({\n          success: false,\n          error: 'Email is required',\n        });\n      }\n\n      // Get the current user's email as addedBy\n      const addedBy = req.user?.claims?.email || 'unknown';\n      \n      const newEmail = await storage.addAllowedEmail(email, addedBy);\n      res.json(newEmail);\n    } catch (error: any) {\n      console.error('Error adding allowed email:', error);\n      // Handle duplicate email error\n      if (error.code === '23505') {\n        return res.status(400).json({\n          success: false,\n          error: 'This email is already on the allowlist',\n        });\n      }\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  // DELETE /api/admin/allowed-emails/:id - Remove an allowed email\n  app.delete(\"/api/admin/allowed-emails/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const { id } = req.params;\n      await storage.removeAllowedEmail(id);\n      res.json({ success: true });\n    } catch (error) {\n      console.error('Error removing allowed email:', error);\n      res.status(500).json({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  });\n\n  const httpServer = createServer(app);\n\n  return httpServer;\n}\n","path":null,"size_bytes":24744,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 0 0% 100%;\n  --foreground: 195 100% 16%;\n  --border: 0 0% 89%;\n  --card: 0 0% 98%;\n  --card-foreground: 195 100% 16%;\n  --card-border: 0 0% 94%;\n  --sidebar: 0 0% 96%;\n  --sidebar-foreground: 195 100% 16%;\n  --sidebar-border: 0 0% 92%;\n  --sidebar-primary: 195 100% 16%;\n  --sidebar-primary-foreground: 0 0% 98%;\n  --sidebar-accent: 195 6% 88%;\n  --sidebar-accent-foreground: 195 100% 16%;\n  --sidebar-ring: 195 100% 16%;\n  --popover: 0 0% 94%;\n  --popover-foreground: 195 100% 16%;\n  --popover-border: 0 0% 90%;\n  --primary: 195 100% 16%;\n  --primary-foreground: 0 0% 98%;\n  --secondary: 195 6% 88%;\n  --secondary-foreground: 195 100% 16%;\n  --muted: 195 8% 91%;\n  --muted-foreground: 195 60% 28%;\n  --accent: 195 6% 90%;\n  --accent-foreground: 195 100% 16%;\n  --destructive: 0 84% 40%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 0 0% 76%;\n  --ring: 195 100% 16%;\n  --chart-1: 195 100% 26%;\n  --chart-2: 186 85% 30%;\n  --chart-3: 205 90% 28%;\n  --chart-4: 175 75% 32%;\n  --chart-5: 215 80% 30%;\n  --font-sans: Inter, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: JetBrains Mono, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(195 100% 16% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(195 100% 16% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(195 100% 16% / 0.00), 0px 1px 2px -1px hsl(195 100% 16% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(195 100% 16% / 0.00), 0px 1px 2px -1px hsl(195 100% 16% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(195 100% 16% / 0.00), 0px 2px 4px -1px hsl(195 100% 16% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(195 100% 16% / 0.00), 0px 4px 6px -1px hsl(195 100% 16% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(195 100% 16% / 0.00), 0px 8px 10px -1px hsl(195 100% 16% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(195 100% 16% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 0 0% 8%;\n  --foreground: 195 20% 88%;\n  --border: 0 0% 18%;\n  --card: 0 0% 10%;\n  --card-foreground: 195 20% 88%;\n  --card-border: 0 0% 14%;\n  --sidebar: 0 0% 12%;\n  --sidebar-foreground: 195 20% 88%;\n  --sidebar-border: 0 0% 16%;\n  --sidebar-primary: 195 100% 35%;\n  --sidebar-primary-foreground: 0 0% 98%;\n  --sidebar-accent: 195 8% 16%;\n  --sidebar-accent-foreground: 195 40% 82%;\n  --sidebar-ring: 195 100% 35%;\n  --popover: 0 0% 14%;\n  --popover-foreground: 195 20% 88%;\n  --popover-border: 0 0% 18%;\n  --primary: 195 100% 28%;\n  --primary-foreground: 0 0% 98%;\n  --secondary: 195 8% 18%;\n  --secondary-foreground: 195 30% 84%;\n  --muted: 195 10% 16%;\n  --muted-foreground: 195 30% 72%;\n  --accent: 195 8% 15%;\n  --accent-foreground: 195 35% 84%;\n  --destructive: 0 84% 32%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 0 0% 28%;\n  --ring: 195 100% 35%;\n  --chart-1: 195 90% 65%;\n  --chart-2: 186 75% 62%;\n  --chart-3: 205 80% 68%;\n  --chart-4: 175 70% 60%;\n  --chart-5: 215 75% 64%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(195 100% 28% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(195 100% 28% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(195 100% 28% / 0.00), 0px 1px 2px -1px hsl(195 100% 28% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(195 100% 28% / 0.00), 0px 1px 2px -1px hsl(195 100% 28% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(195 100% 28% / 0.00), 0px 2px 4px -1px hsl(195 100% 28% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(195 100% 28% / 0.00), 0px 4px 6px -1px hsl(195 100% 28% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(195 100% 28% / 0.00), 0px 8px 10px -1px hsl(195 100% 28% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(195 100% 28% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","path":null,"size_bytes":10751,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/UnmatchedTable.tsx":{"content":"import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { UserPlus, AlertCircle } from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport { useState } from \"react\";\n\ninterface UnmatchedParticipant {\n  id: string;\n  name: string;\n  email: string;\n  role: 'Learner' | 'Peer';\n  courseCode: string;\n  constraintFailure: string;\n  suggestedAlternative?: string;\n}\n\ninterface UnmatchedTableProps {\n  participants: UnmatchedParticipant[];\n  onManualPlace?: (id: string) => void;\n}\n\nexport function UnmatchedTable({ participants, onManualPlace }: UnmatchedTableProps) {\n  const [searchQuery, setSearchQuery] = useState('');\n\n  const filteredParticipants = participants.filter(p =>\n    p.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    p.courseCode.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    p.constraintFailure.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  return (\n    <div className=\"space-y-4\" data-testid=\"container-unmatched-table\">\n      <div className=\"flex items-center gap-2\">\n        <Input\n          placeholder=\"Search by name, course, or constraint...\"\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"max-w-md\"\n          data-testid=\"input-search-unmatched\"\n        />\n      </div>\n\n      <div className=\"border rounded-md\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead>Name</TableHead>\n              <TableHead>Role</TableHead>\n              <TableHead>Course</TableHead>\n              <TableHead>Constraint Failure</TableHead>\n              <TableHead>Suggested Alternative</TableHead>\n              <TableHead className=\"w-[100px]\">Action</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {filteredParticipants.length === 0 ? (\n              <TableRow>\n                <TableCell colSpan={6} className=\"text-center text-muted-foreground py-8\">\n                  No unmatched participants found\n                </TableCell>\n              </TableRow>\n            ) : (\n              filteredParticipants.map((participant) => (\n                <TableRow key={participant.id} data-testid={`row-participant-${participant.id}`}>\n                  <TableCell>\n                    <div>\n                      <p className=\"font-medium text-sm\" data-testid={`text-name-${participant.id}`}>\n                        {participant.name}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground\">{participant.email}</p>\n                    </div>\n                  </TableCell>\n                  <TableCell>\n                    <Badge variant={participant.role === 'Peer' ? 'default' : 'secondary'}>\n                      {participant.role}\n                    </Badge>\n                  </TableCell>\n                  <TableCell className=\"font-mono text-sm\">{participant.courseCode}</TableCell>\n                  <TableCell>\n                    <div className=\"flex items-start gap-2\">\n                      <AlertCircle className=\"h-4 w-4 text-destructive mt-0.5 flex-shrink-0\" />\n                      <span className=\"text-sm\">{participant.constraintFailure}</span>\n                    </div>\n                  </TableCell>\n                  <TableCell className=\"text-sm\">\n                    {participant.suggestedAlternative || (\n                      <span className=\"text-muted-foreground\">None</span>\n                    )}\n                  </TableCell>\n                  <TableCell>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => onManualPlace?.(participant.id)}\n                      data-testid={`button-place-${participant.id}`}\n                    >\n                      <UserPlus className=\"h-4 w-4\" />\n                    </Button>\n                  </TableCell>\n                </TableRow>\n              ))\n            )}\n          </TableBody>\n        </Table>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":4207,"size_tokens":null},"client/src/components/examples/AppSidebar.tsx":{"content":"import { AppSidebar } from '../AppSidebar';\nimport { SidebarProvider } from '@/components/ui/sidebar';\n\nexport default function AppSidebarExample() {\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\">\n        <AppSidebar />\n      </div>\n    </SidebarProvider>\n  );\n}\n","path":null,"size_bytes":423,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":4050,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"server/matchingAlgorithm.ts":{"content":"import type {\n  LearnerRequest,\n  LearningPeer,\n  ClassSchedule,\n  ProposedGroup,\n  InsertProposedGroup,\n  UnmatchedParticipant,\n  TimeSlot,\n} from '@shared/schema';\nimport {\n  findAvailableSlots,\n  getScheduleForDay,\n  isWithinPreferredProximity,\n  isBetweenClasses,\n  isBetweenClassesForGroup,\n  instructorsMatch,\n  peerCanTeach,\n  normalizeInstructorName,\n  getCanonicalInstructorName,\n} from './matchingUtils';\n\ninterface MatchingInput {\n  requests: LearnerRequest[];\n  peers: LearningPeer[];\n  learnerSchedules: ClassSchedule[];\n  volunteerSchedules: ClassSchedule[];\n  excludedLearnerEmails?: string[];\n}\n\ninterface MatchingResult {\n  groups: InsertProposedGroup[];\n  unmatched: UnmatchedParticipant[];\n}\n\ninterface LearnerWithSchedule extends LearnerRequest {\n  schedule?: ClassSchedule;\n}\n\ninterface PeerWithSchedule extends LearningPeer {\n  schedule?: ClassSchedule;\n  assignedGroups: number; // Track groups assigned in this run\n  daysUsed: Set<'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday'>; // Track which days have groups\n}\n\nconst DAYS: Array<'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday'> = [\n  'monday', 'tuesday', 'wednesday', 'thursday', 'friday'\n];\n\n// Generate combinations of items with a given size\n// Generates more combinations for better schedule matching coverage\nfunction generateCombinations<T>(items: T[], size: number, maxCombinations: number = 100): T[][] {\n  const combinations: T[][] = [];\n  \n  function backtrack(start: number, current: T[]) {\n    if (combinations.length >= maxCombinations) {\n      return;\n    }\n    \n    if (current.length === size) {\n      combinations.push([...current]);\n      return;\n    }\n    \n    for (let i = start; i < items.length; i++) {\n      current.push(items[i]);\n      backtrack(i + 1, current);\n      current.pop();\n    }\n  }\n  \n  backtrack(0, []);\n  return combinations;\n}\n\n// Track specific failure reasons for each learner\ntype FailureReason = {\n  reason: string;\n  details: string;\n};\n\nexport function runMatchingAlgorithm(input: MatchingInput): MatchingResult {\n  const { requests, peers, learnerSchedules, volunteerSchedules, excludedLearnerEmails = [] } = input;\n  const excludedSet = new Set(excludedLearnerEmails);\n  \n  // Filter out already-matched learners\n  const newRequests = requests.filter(req => !excludedSet.has(req.email));\n  \n  // Attach schedules to learners and peers\n  const learnersWithSchedules: LearnerWithSchedule[] = newRequests.map(req => ({\n    ...req,\n    schedule: learnerSchedules.find(s => s.email === req.email),\n  }));\n  \n  const peersWithSchedules: PeerWithSchedule[] = peers.map(peer => ({\n    ...peer,\n    schedule: volunteerSchedules.find(s => s.email === peer.email),\n    assignedGroups: 0, // Track groups assigned in this run\n    daysUsed: new Set(), // Track which days have groups for day variety\n  }));\n  \n  // Track failure reasons for unmatched learners\n  const failureReasons = new Map<string, FailureReason>();\n  \n  // Initialize failure reasons - check for missing schedules first\n  for (const learner of learnersWithSchedules) {\n    if (!learner.schedule) {\n      failureReasons.set(learner.email, {\n        reason: 'Missing schedule',\n        details: `No class schedule found for ${learner.firstName} ${learner.lastName}. Please ensure their schedule is entered in the Learner Class Schedule sheet.`\n      });\n    }\n  }\n  \n  const groups: InsertProposedGroup[] = [];\n  const matched = new Set<string>(); // Track matched learner emails\n  \n  // Group learners by course code and instructor match requirement\n  const learnersByCourse = groupLearnersByCourse(learnersWithSchedules);\n  \n  // Sort course keys to prioritize instructor-required matches FIRST\n  // This ensures peers who can teach specific instructors are reserved for those learners\n  const sortedCourseKeys = Object.keys(learnersByCourse).sort((a, b) => {\n    const [, aRequired] = a.split('::');\n    const [, bRequired] = b.split('::');\n    // Process 'true' (instructor required) before 'false'\n    if (aRequired === 'true' && bRequired === 'false') return -1;\n    if (aRequired === 'false' && bRequired === 'true') return 1;\n    return 0;\n  });\n  \n  // Process each course group in priority order\n  for (const courseKey of sortedCourseKeys) {\n    const courseLearners = learnersByCourse[courseKey];\n    const [courseCode, instructorMatchRequired] = courseKey.split('::');\n    \n    if (instructorMatchRequired === 'true') {\n      // Group by instructor when match is required\n      const learnersByInstructor = groupByInstructor(courseLearners);\n      \n      // Get all instructor-flexible learners for this course to allow mixing\n      const flexibleKey = `${courseCode}::false`;\n      const flexibleLearners = learnersByCourse[flexibleKey] || [];\n      \n      for (const [instructor, instructorLearners] of Object.entries(learnersByInstructor)) {\n        // Combine instructor-required learners with instructor-flexible learners\n        // This allows flexible learners to fill out instructor-specific groups\n        const combinedLearners = [...instructorLearners, ...flexibleLearners.filter(l => !matched.has(l.email))];\n        \n        matchLearnersWithPeers(\n          combinedLearners,\n          peersWithSchedules,\n          courseCode,\n          instructor,\n          true,\n          groups,\n          matched,\n          failureReasons\n        );\n      }\n    } else {\n      // All learners can be mixed regardless of instructor\n      matchLearnersWithPeers(\n        courseLearners,\n        peersWithSchedules,\n        courseCode,\n        null,\n        false,\n        groups,\n        matched,\n        failureReasons\n      );\n    }\n  }\n  \n  // Build unmatched list AFTER all matching is complete\n  const unmatched: UnmatchedParticipant[] = [];\n  for (const learner of learnersWithSchedules) {\n    if (!matched.has(learner.email)) {\n      // Get the specific failure reason, or use a default\n      const failure = failureReasons.get(learner.email);\n      let constraintFailure: string;\n      \n      if (failure) {\n        constraintFailure = `${failure.reason}: ${failure.details}`;\n      } else {\n        // This shouldn't happen, but provide a fallback\n        constraintFailure = 'Unable to find a suitable match. Please review manually.';\n      }\n      \n      unmatched.push({\n        id: `learner-${learner.email}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        name: `${learner.firstName} ${learner.lastName}`,\n        email: learner.email,\n        role: 'Learner',\n        courseCode: learner.courseCode,\n        constraintFailure,\n      });\n    }\n  }\n  \n  return { groups, unmatched };\n}\n\nfunction groupLearnersByCourse(\n  learners: LearnerWithSchedule[]\n): Record<string, LearnerWithSchedule[]> {\n  const grouped: Record<string, LearnerWithSchedule[]> = {};\n  \n  for (const learner of learners) {\n    // If instructor field is blank/empty, treat as instructor match NOT required\n    // regardless of what the instructorMatchRequired flag says\n    const hasInstructor = learner.instructor && learner.instructor.trim() !== '';\n    const effectiveMatchRequired = hasInstructor && learner.instructorMatchRequired;\n    \n    const key = `${learner.courseCode}::${effectiveMatchRequired}`;\n    if (!grouped[key]) {\n      grouped[key] = [];\n    }\n    grouped[key].push(learner);\n  }\n  \n  return grouped;\n}\n\nfunction groupByInstructor(\n  learners: LearnerWithSchedule[]\n): Record<string, LearnerWithSchedule[]> {\n  const grouped: Record<string, LearnerWithSchedule[]> = {};\n  const instructorKeys: string[] = []; // Track the order of keys\n  \n  for (const learner of learners) {\n    // Use canonical instructor name to handle abbreviations (Pete/Peter, etc.)\n    const canonicalInstructor = getCanonicalInstructorName(learner.instructor);\n    \n    // Check if this instructor matches any existing group\n    let foundMatchingKey: string | null = null;\n    for (const existingKey of instructorKeys) {\n      // Use instructorsMatch to check if these are the same person\n      if (instructorsMatch(canonicalInstructor, existingKey)) {\n        foundMatchingKey = existingKey;\n        break;\n      }\n    }\n    \n    if (foundMatchingKey) {\n      // Add to existing group\n      grouped[foundMatchingKey].push(learner);\n    } else {\n      // Create new group\n      if (!grouped[canonicalInstructor]) {\n        grouped[canonicalInstructor] = [];\n        instructorKeys.push(canonicalInstructor);\n      }\n      grouped[canonicalInstructor].push(learner);\n    }\n  }\n  \n  return grouped;\n}\n\nfunction matchLearnersWithPeers(\n  learners: LearnerWithSchedule[],\n  peers: PeerWithSchedule[],\n  courseCode: string,\n  requiredInstructor: string | null,\n  instructorMatchRequired: boolean,\n  groups: InsertProposedGroup[],\n  matched: Set<string>,\n  failureReasons: Map<string, FailureReason>\n): void {\n  // Filter available learners (not yet matched)\n  const availableLearners = learners.filter(l => !matched.has(l.email));\n  \n  if (availableLearners.length === 0) {\n    return;\n  }\n  \n  // Find all peers who teach this course (regardless of capacity)\n  const peersForCourse = peers.filter(peer => {\n    if (instructorMatchRequired && requiredInstructor) {\n      return peerCanTeach(peer, courseCode, requiredInstructor);\n    } else {\n      return peerCanTeach(peer, courseCode, requiredInstructor || '');\n    }\n  });\n  \n  // Check if no peers exist at all for this course/instructor\n  if (peersForCourse.length === 0) {\n    const reason = instructorMatchRequired && requiredInstructor\n      ? `No peers available for ${courseCode} with instructor ${requiredInstructor}`\n      : `No peers available for ${courseCode}`;\n    \n    for (const learner of availableLearners) {\n      if (!failureReasons.has(learner.email)) {\n        failureReasons.set(learner.email, {\n          reason: 'No eligible peers',\n          details: reason\n        });\n      }\n    }\n    return;\n  }\n  \n  // Find eligible peers (has capacity)\n  const eligiblePeers = peersForCourse.filter(peer => {\n    const maxGroups = peer.groups || 2;\n    return peer.assignedGroups < maxGroups;\n  });\n  \n  if (eligiblePeers.length === 0) {\n    // Peers exist but all at capacity\n    const peerNames = peersForCourse.map(p => `${p.preferredName} ${p.lastName}`).join(', ');\n    for (const learner of availableLearners) {\n      if (!failureReasons.has(learner.email)) {\n        failureReasons.set(learner.email, {\n          reason: 'Peer capacity exhausted',\n          details: `All peers for ${courseCode} have reached their maximum group limit. Available peers (at capacity): ${peerNames}`\n        });\n      }\n    }\n    return;\n  }\n  \n  // Try to form groups with each peer\n  // Allow each peer to form multiple groups up to their capacity\n  for (const peer of eligiblePeers) {\n    const maxGroups = peer.groups || 2; // Default to 2 if not specified\n    peer.daysUsed = new Set(); // Initialize day tracking for this peer\n    \n    // Keep trying to form groups for this peer until they reach capacity or no learners left\n    while (peer.assignedGroups < maxGroups) {\n      const currentAvailable = availableLearners.filter(l => !matched.has(l.email));\n      \n      if (currentAvailable.length === 0) {\n        break;\n      }\n      \n      // Get the instructor for this peer's groups\n      let instructorName = '';\n      if (instructorMatchRequired) {\n        instructorName = requiredInstructor || peer.instructor1 || '';\n      }\n      const normalizedInstructor = normalizeInstructorName(instructorName);\n      \n      // Filter learners to prioritize those with matching instructor (if instructor matching is required)\n      // This keeps learners with the same instructor in the same peer's groups\n      let prioritizedLearners = currentAvailable;\n      if (instructorMatchRequired && instructorName) {\n        const matchingInstructor = currentAvailable.filter(l => instructorsMatch(l.instructor, instructorName));\n        if (matchingInstructor.length > 0) {\n          prioritizedLearners = matchingInstructor;\n        }\n      }\n      \n      // Try forming groups of size 4, 3, 2 in that order\n      // Skip size 1 for now - we'll try to merge single learners later\n      // Use true combinatorial search to explore different learner subsets\n      let groupFormed = false;\n      \n      for (let groupSize = Math.min(4, prioritizedLearners.length); groupSize >= 2 && !groupFormed; groupSize--) {\n        // Generate combinations of learners\n        // Use higher limit for better schedule conflict resolution\n        // Smaller group sizes get even more combinations to try\n        const combinationLimit = groupSize === 2 ? 100 : 75;\n        const combinations = generateCombinations(prioritizedLearners, groupSize, combinationLimit);\n        \n        for (const candidateLearners of combinations) {\n          const group = tryFormGroup(\n            candidateLearners,\n            peer,\n            courseCode,\n            normalizedInstructor\n          );\n          \n          if (group) {\n            groups.push(group);\n            peer.assignedGroups++;\n            peer.daysUsed.add(group.timeSlot.day); // Track this day for variety\n            \n            // Mark learners as matched\n            for (const learner of group.learners) {\n              matched.add(learner.email);\n            }\n            \n            groupFormed = true;\n            break; // Found a group for this peer, try to form another\n          }\n        }\n      }\n      \n      // If no group was formed in this iteration, stop trying for this peer\n      if (!groupFormed) {\n        break;\n      }\n    }\n  }\n  \n  // Second pass: Try to form size-1 groups and combine them with unmatched learners if possible\n  // This ensures we have at least 2 learners per group when possible\n  const unAttemptedSingleLearners: LearnerWithSchedule[] = [];\n  const stillUnmatched = availableLearners.filter(l => !matched.has(l.email));\n  \n  // First, try to form groups of size 1 with very relaxed constraints to identify learners\n  for (const peer of eligiblePeers) {\n    const maxGroups = peer.groups || 2;\n    if (peer.assignedGroups >= maxGroups) continue;\n    \n    const currentAvailable = stillUnmatched.filter(l => !matched.has(l.email) && !unAttemptedSingleLearners.includes(l));\n    if (currentAvailable.length === 0) break;\n    \n    // Try to pair single learners together\n    let attemptedIndex = 0;\n    while (attemptedIndex < currentAvailable.length && peer.assignedGroups < maxGroups) {\n      const pairs: LearnerWithSchedule[][] = [];\n      \n      // Try to pair learners together\n      for (let i = attemptedIndex; i < currentAvailable.length; i++) {\n        const learner1 = currentAvailable[i];\n        for (let j = i + 1; j < currentAvailable.length; j++) {\n          const learner2 = currentAvailable[j];\n          // Check if they have matching instructor (if instructor required)\n          if (instructorMatchRequired) {\n            if (instructorsMatch(learner1.instructor, learner2.instructor)) {\n              pairs.push([learner1, learner2]);\n            }\n          } else {\n            pairs.push([learner1, learner2]);\n          }\n        }\n      }\n      \n      // Try each pair\n      let pairedSomeone = false;\n      for (const pairOfLearners of pairs) {\n        if (peer.assignedGroups >= maxGroups) break;\n        \n        const group = tryFormGroup(\n          pairOfLearners,\n          peer,\n          courseCode,\n          requiredInstructor || ''\n        );\n        \n        if (group) {\n          groups.push(group);\n          peer.assignedGroups++;\n          \n          for (const learner of group.learners) {\n            matched.add(learner.email);\n          }\n          pairedSomeone = true;\n          break;\n        }\n      }\n      \n      if (!pairedSomeone) {\n        attemptedIndex++;\n      }\n    }\n  }\n  \n  // After all matching attempts, set schedule conflict reasons for remaining unmatched learners\n  const finalUnmatched = availableLearners.filter(l => !matched.has(l.email));\n  for (const learner of finalUnmatched) {\n    if (!failureReasons.has(learner.email)) {\n      // Build a list of peers that were tried\n      const triedPeers = eligiblePeers.map(p => `${p.preferredName} ${p.lastName}`).join(', ');\n      failureReasons.set(learner.email, {\n        reason: 'Schedule conflict',\n        details: `No common available time slot found between ${learner.firstName} ${learner.lastName} and any eligible peer for ${courseCode}. Peers tried: ${triedPeers}`\n      });\n    }\n  }\n}\n\nfunction tryFormGroup(\n  learners: LearnerWithSchedule[],\n  peer: PeerWithSchedule,\n  courseCode: string,\n  instructor: string\n): InsertProposedGroup | null {\n  // Collect all schedules\n  const allSchedules: ClassSchedule[] = [];\n  \n  // Add peer schedule\n  if (peer.schedule) {\n    allSchedules.push(peer.schedule);\n  } else {\n    return null; // Can't match without peer schedule\n  }\n  \n  // Add learner schedules\n  for (const learner of learners) {\n    if (learner.schedule) {\n      allSchedules.push(learner.schedule);\n    } else {\n      return null; // Can't match without all learner schedules\n    }\n  }\n  \n  // Find common available time slots across all days\n  // Pass peer's daysUsed for day variety across the week\n  const bestSlot = findBestTimeSlot(allSchedules, peer.daysUsed);\n  \n  if (!bestSlot) {\n    return null; // No common time slot found\n  }\n  \n  // Create the proposed group (without id and status - those are added by storage)\n  return {\n    courseCode,\n    instructor,\n    peerId: peer.email,\n    peerName: `${peer.preferredName} ${peer.lastName}`,\n    peerEmail: peer.email,\n    learners: learners.map(l => ({\n      id: l.email,\n      name: `${l.firstName} ${l.lastName}`,\n      email: l.email,\n      instructor: l.instructor,\n    })),\n    timeSlot: bestSlot,\n  };\n}\n\nfunction findBestTimeSlot(\n  schedules: ClassSchedule[],\n  daysUsed: Set<'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday'>\n): {\n  day: 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday';\n  start: string;\n  end: string;\n} | null {\n  let bestSlot: {\n    day: 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday';\n    slot: TimeSlot;\n    score: number;\n    dayScore: number; // Prefer days with fewer groups\n  } | null = null;\n  \n  // Try each day\n  for (const day of DAYS) {\n    const availableSlots = findAvailableSlots(schedules, day);\n    \n    for (const slot of availableSlots) {\n      // Calculate preference score with improved prioritization:\n      // Score 3: Between classes (gap) - students prefer being already on campus\n      // Score 2: Within 1 hour of classes - convenient\n      // Score 1: Within 2 hours of classes - acceptable\n      // Score 0: Far from classes - requires special trip\n      let score = 0;\n      \n      // Check at GROUP level: Is this between classes for the group?\n      // (Anyone has class before AND anyone has class after)\n      if (isBetweenClassesForGroup(slot, schedules, day)) {\n        score = 3; // BEST: Gap between classes\n      } else if (isWithinPreferredProximity(slot, schedules, day, 60)) {\n        score = 2; // Within 1 hour of classes\n      } else if (isWithinPreferredProximity(slot, schedules, day, 120)) {\n        score = 1; // Within 2 hours of classes\n      }\n      \n      // Calculate day score: prefer days with fewer groups (for variety)\n      // Days not yet used get highest priority (dayScore = 1)\n      // Days already used get lower priority (dayScore = 0)\n      const dayScore = daysUsed.has(day) ? 0 : 1;\n      \n      // Compare: first by time slot score, then by day variety\n      if (!bestSlot || \n          score > bestSlot.score || \n          (score === bestSlot.score && dayScore > bestSlot.dayScore)) {\n        bestSlot = { day, slot, score, dayScore };\n      }\n    }\n  }\n  \n  if (!bestSlot) {\n    return null;\n  }\n  \n  return {\n    day: bestSlot.day,\n    start: bestSlot.slot.start,\n    end: bestSlot.slot.end,\n  };\n}\n","path":null,"size_bytes":19888,"size_tokens":null},"client/src/pages/RunMatching.tsx":{"content":"import { MatchingRunPanel } from \"@/components/MatchingRunPanel\";\nimport { useState, useRef, useEffect } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\nexport default function RunMatching() {\n  const [isRunning, setIsRunning] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [newRequestsOnly, setNewRequestsOnly] = useState(false);\n  const [dataSourceSynced, setDataSourceSynced] = useState<Date | undefined>(undefined);\n  const [showClearConfirm, setShowClearConfirm] = useState(false);\n  const { toast } = useToast();\n  const pollIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const pollTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  const { data: latestRunData } = useQuery<{ success: boolean; runs: any[] }>({\n    queryKey: ['/api/matching-runs'],\n  });\n\n  const latestRun = latestRunData?.runs?.[0];\n  const lastRun = latestRun ? new Date(latestRun.timestamp) : undefined;\n\n  // Cleanup polling on unmount\n  useEffect(() => {\n    return () => {\n      if (pollIntervalRef.current) {\n        clearInterval(pollIntervalRef.current);\n      }\n      if (pollTimeoutRef.current) {\n        clearTimeout(pollTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const startRunMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('POST', '/api/matching-runs', {\n        newRequestsOnly,\n      });\n      return response.json();\n    },\n    onSuccess: (data: any) => {\n      console.log('Matching run started:', data);\n      toast({\n        title: \"Matching Run Started\",\n        description: \"Processing student and Learning Peer data from Google Sheets...\",\n      });\n      \n      const runId = data.runId;\n      \n      // Clear any existing polling\n      if (pollIntervalRef.current) {\n        clearInterval(pollIntervalRef.current);\n      }\n      if (pollTimeoutRef.current) {\n        clearTimeout(pollTimeoutRef.current);\n      }\n      \n      const cleanupPolling = () => {\n        if (pollIntervalRef.current) {\n          clearInterval(pollIntervalRef.current);\n          pollIntervalRef.current = null;\n        }\n        if (pollTimeoutRef.current) {\n          clearTimeout(pollTimeoutRef.current);\n          pollTimeoutRef.current = null;\n        }\n      };\n      \n      let failureCount = 0;\n      const MAX_FAILURES = 3;\n      \n      pollIntervalRef.current = setInterval(async () => {\n        try {\n          const response = await fetch(`/api/matching-runs/${runId}`);\n          \n          if (!response.ok) {\n            failureCount++;\n            console.error(`Failed to fetch run status (${failureCount}/${MAX_FAILURES}):`, response.statusText);\n            \n            if (failureCount >= MAX_FAILURES) {\n              cleanupPolling();\n              setIsRunning(false);\n              setProgress(0);\n              toast({\n                title: \"Error\",\n                description: \"Failed to check matching run status. Please refresh the page.\",\n                variant: \"destructive\",\n              });\n            }\n            return;\n          }\n          \n          // Reset failure count on success\n          failureCount = 0;\n          \n          const result = await response.json();\n          \n          if (result.success && result.run) {\n            if (result.run.status === 'completed') {\n              cleanupPolling();\n              setIsRunning(false);\n              setProgress(100);\n              queryClient.invalidateQueries({ queryKey: ['/api/matching-runs'] });\n              queryClient.invalidateQueries({ queryKey: ['/api/groups'] });\n              queryClient.invalidateQueries({ queryKey: ['/api/unmatched'] });\n              toast({\n                title: \"Matching Complete\",\n                description: `Successfully matched ${result.run.matchedLearners} learners into ${result.run.proposedGroups} groups.`,\n              });\n            } else if (result.run.status === 'failed') {\n              cleanupPolling();\n              setIsRunning(false);\n              setProgress(0);\n              toast({\n                title: \"Matching Failed\",\n                description: \"An error occurred during the matching process.\",\n                variant: \"destructive\",\n              });\n            } else {\n              setProgress((prev) => Math.min(prev + 15, 90));\n            }\n          }\n        } catch (error) {\n          failureCount++;\n          console.error(`Error checking progress (${failureCount}/${MAX_FAILURES}):`, error);\n          \n          if (failureCount >= MAX_FAILURES) {\n            cleanupPolling();\n            setIsRunning(false);\n            setProgress(0);\n            toast({\n              title: \"Error\",\n              description: \"Failed to check matching run status. Please refresh the page.\",\n              variant: \"destructive\",\n            });\n          }\n        }\n      }, 1000);\n      \n      pollTimeoutRef.current = setTimeout(() => {\n        cleanupPolling();\n        setIsRunning(false);\n        setProgress(0);\n        toast({\n          title: \"Timeout\",\n          description: \"Matching run is taking longer than expected. Please check the status manually.\",\n          variant: \"destructive\",\n        });\n      }, 60000);\n    },\n    onError: (error) => {\n      console.error('Error starting matching run:', error);\n      setIsRunning(false);\n      setProgress(0);\n      toast({\n        title: \"Error\",\n        description: \"Failed to start matching run. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const syncDataMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('POST', '/api/sync-data');\n      return response.json();\n    },\n    onSuccess: (data: any) => {\n      console.log('Data synced:', data);\n      setDataSourceSynced(new Date(data.timestamp));\n      toast({\n        title: \"Data Synced\",\n        description: `Successfully synced ${data.data.requests} requests, ${data.data.peers} peers.`,\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/matching-runs'] });\n    },\n    onError: (error) => {\n      console.error('Error syncing data:', error);\n      setProgress(0);\n      setIsRunning(false);\n      toast({\n        title: \"Error\",\n        description: \"Failed to sync data from Google Sheets.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleStartRun = (newReqOnly: boolean) => {\n    // If not using \"Match New Requests Only\", show warning about clearing previous matches\n    if (!newReqOnly) {\n      setShowClearConfirm(true);\n      return;\n    }\n    proceedWithMatching(newReqOnly);\n  };\n\n  const proceedWithMatching = (newReqOnly: boolean) => {\n    setShowClearConfirm(false);\n    setNewRequestsOnly(newReqOnly);\n    setIsRunning(true);\n    setProgress(0);\n    // Use newReqOnly directly instead of state\n    const response = apiRequest('POST', '/api/matching-runs', {\n      newRequestsOnly: newReqOnly,\n    }).then(r => r.json());\n    response.then((data: any) => {\n      console.log('Matching run started:', data);\n      toast({\n        title: \"Matching Run Started\",\n        description: newReqOnly ? \n          \"Processing only new requests (skipping already-matched learners)...\" :\n          \"Processing all student and Learning Peer data from Google Sheets...\",\n      });\n      \n      const runId = data.runId;\n      \n      // Clear any existing polling\n      if (pollIntervalRef.current) {\n        clearInterval(pollIntervalRef.current);\n      }\n      if (pollTimeoutRef.current) {\n        clearTimeout(pollTimeoutRef.current);\n      }\n      \n      const cleanupPolling = () => {\n        if (pollIntervalRef.current) {\n          clearInterval(pollIntervalRef.current);\n          pollIntervalRef.current = null;\n        }\n        if (pollTimeoutRef.current) {\n          clearTimeout(pollTimeoutRef.current);\n          pollTimeoutRef.current = null;\n        }\n      };\n      \n      let failureCount = 0;\n      const MAX_FAILURES = 3;\n      \n      pollIntervalRef.current = setInterval(async () => {\n        try {\n          const response = await fetch(`/api/matching-runs/${runId}`);\n          \n          if (!response.ok) {\n            failureCount++;\n            console.error(`Failed to fetch run status (${failureCount}/${MAX_FAILURES}):`, response.statusText);\n            \n            if (failureCount >= MAX_FAILURES) {\n              cleanupPolling();\n              setIsRunning(false);\n              setProgress(0);\n              toast({\n                title: \"Error\",\n                description: \"Failed to check matching run status. Please refresh the page.\",\n                variant: \"destructive\",\n              });\n            }\n            return;\n          }\n          \n          // Reset failure count on success\n          failureCount = 0;\n          \n          const result = await response.json();\n          \n          if (result.success && result.run) {\n            if (result.run.status === 'completed') {\n              cleanupPolling();\n              setIsRunning(false);\n              setProgress(100);\n              queryClient.invalidateQueries({ queryKey: ['/api/matching-runs'] });\n              queryClient.invalidateQueries({ queryKey: ['/api/groups'] });\n              queryClient.invalidateQueries({ queryKey: ['/api/unmatched'] });\n              toast({\n                title: \"Matching Complete\",\n                description: `Successfully matched ${result.run.matchedLearners} learners into ${result.run.proposedGroups} groups.`,\n              });\n            } else if (result.run.status === 'failed') {\n              cleanupPolling();\n              setIsRunning(false);\n              setProgress(0);\n              toast({\n                title: \"Matching Failed\",\n                description: \"An error occurred during the matching process.\",\n                variant: \"destructive\",\n              });\n            } else {\n              setProgress((prev) => Math.min(prev + 15, 90));\n            }\n          }\n        } catch (error) {\n          failureCount++;\n          console.error(`Error checking progress (${failureCount}/${MAX_FAILURES}):`, error);\n          \n          if (failureCount >= MAX_FAILURES) {\n            cleanupPolling();\n            setIsRunning(false);\n            setProgress(0);\n            toast({\n              title: \"Error\",\n              description: \"Failed to check matching run status. Please refresh the page.\",\n              variant: \"destructive\",\n            });\n          }\n        }\n      }, 1000);\n      \n      pollTimeoutRef.current = setTimeout(() => {\n        cleanupPolling();\n        setIsRunning(false);\n        setProgress(0);\n        toast({\n          title: \"Timeout\",\n          description: \"Matching run is taking longer than expected. Please check the status manually.\",\n          variant: \"destructive\",\n        });\n      }, 60000);\n    }).catch((error) => {\n      console.error('Error starting matching run:', error);\n      setIsRunning(false);\n      setProgress(0);\n      toast({\n        title: \"Error\",\n        description: \"Failed to start matching run. Please try again.\",\n        variant: \"destructive\",\n      });\n    });\n  };\n\n  const handleSyncData = () => {\n    syncDataMutation.mutate();\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold\" data-testid=\"text-page-title\">Run Matching</h1>\n        <p className=\"text-muted-foreground mt-1\">\n          Initiate a new matching run to process current data\n        </p>\n      </div>\n\n      <div className=\"max-w-3xl\">\n        <MatchingRunPanel\n          lastRun={lastRun}\n          dataSourceSynced={dataSourceSynced}\n          isRunning={isRunning}\n          progress={progress}\n          newRequestsOnly={newRequestsOnly}\n          onNewRequestsOnlyChange={setNewRequestsOnly}\n          onStartRun={handleStartRun}\n          onSyncData={handleSyncData}\n        />\n      </div>\n\n      <AlertDialog open={showClearConfirm} onOpenChange={setShowClearConfirm}>\n        <AlertDialogContent data-testid=\"dialog-clear-matches-confirm\">\n          <AlertDialogHeader>\n            <AlertDialogTitle>Clear Previous Matches?</AlertDialogTitle>\n            <AlertDialogDescription>\n              You're about to run a full matching process. This will clear all previously proposed groups and re-match all learners from scratch. \n              <br /><br />\n              If you want to preserve your approved matches and only process new requests, enable \"Match New Requests Only\" before running.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <div className=\"flex gap-3 justify-end pt-4\">\n            <AlertDialogCancel data-testid=\"button-cancel-full-match\">Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => proceedWithMatching(false)}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-full-match\"\n            >\n              Continue Full Match\n            </AlertDialogAction>\n          </div>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":13438,"size_tokens":null},"client/src/components/examples/GroupCard.tsx":{"content":"import { GroupCard } from '../GroupCard';\n\nexport default function GroupCardExample() {\n  const handleApprove = (groupId: string) => {\n    console.log('Approve group:', groupId);\n  };\n\n  const handleReject = (groupId: string) => {\n    console.log('Reject group:', groupId);\n  };\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 max-w-5xl\">\n      <GroupCard\n        groupId=\"group-1\"\n        course=\"MATH 1505 - Calculus I\"\n        timeSlot=\"Mon 2:00 PM - 3:00 PM\"\n        peer={{\n          id: \"peer-1\",\n          name: \"Sarah Johnson\",\n          email: \"sarah.johnson@mtroyal.ca\"\n        }}\n        learners={[\n          { id: \"l1\", name: \"Alex Chen\", email: \"alex.chen@mtroyal.ca\" },\n          { id: \"l2\", name: \"Emma Wilson\", email: \"emma.wilson@mtroyal.ca\" },\n          { id: \"l3\", name: \"Marcus Brown\", email: \"marcus.brown@mtroyal.ca\" }\n        ]}\n        onApprove={handleApprove}\n        onReject={handleReject}\n      />\n      <GroupCard\n        groupId=\"group-2\"\n        course=\"COMP 1501 - Introduction to Programming\"\n        timeSlot=\"Wed 10:00 AM - 11:00 AM\"\n        peer={{\n          id: \"peer-2\",\n          name: \"David Martinez\",\n          email: \"david.martinez@mtroyal.ca\"\n        }}\n        learners={[\n          { id: \"l4\", name: \"Sophie Taylor\", email: \"sophie.taylor@mtroyal.ca\" },\n          { id: \"l5\", name: \"James Anderson\", email: \"james.anderson@mtroyal.ca\" }\n        ]}\n        onApprove={handleApprove}\n        onReject={handleReject}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":1516,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"@/components/AppSidebar\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { LogOut, Loader2 } from \"lucide-react\";\nimport Dashboard from \"@/pages/Dashboard\";\nimport RunMatching from \"@/pages/RunMatching\";\nimport ReviewGroups from \"@/pages/ReviewGroups\";\nimport Matched from \"@/pages/Matched\";\nimport Unmatched from \"@/pages/Unmatched\";\nimport PeersWithoutGroups from \"@/pages/PeersWithoutGroups\";\nimport Settings from \"@/pages/Settings\";\nimport Landing from \"@/pages/Landing\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction AuthenticatedRouter() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Dashboard} />\n      <Route path=\"/run-matching\" component={RunMatching} />\n      <Route path=\"/review-groups\" component={ReviewGroups} />\n      <Route path=\"/matched\" component={Matched} />\n      <Route path=\"/unmatched\" component={Unmatched} />\n      <Route path=\"/peers-without-groups\" component={PeersWithoutGroups} />\n      <Route path=\"/settings\" component={Settings} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction MainApp() {\n  const { user, isLoading, isAuthenticated } = useAuth();\n\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return <Landing />;\n  }\n\n  const userInitials = user?.firstName && user?.lastName\n    ? `${user.firstName[0]}${user.lastName[0]}`\n    : user?.email?.[0]?.toUpperCase() || \"U\";\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\">\n        <AppSidebar />\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          <header className=\"flex items-center justify-between gap-4 p-4 border-b\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n            <div className=\"flex items-center gap-3\">\n              <span className=\"text-sm text-muted-foreground hidden sm:block\">\n                {user?.email || \"Admin\"}\n              </span>\n              <Avatar className=\"h-8 w-8\">\n                <AvatarImage src={user?.profileImageUrl || undefined} />\n                <AvatarFallback className=\"text-xs\">{userInitials}</AvatarFallback>\n              </Avatar>\n              <Button \n                variant=\"ghost\" \n                size=\"icon\" \n                asChild\n                data-testid=\"button-logout\"\n              >\n                <a href=\"/api/logout\" title=\"Sign Out\">\n                  <LogOut className=\"h-4 w-4\" />\n                </a>\n              </Button>\n            </div>\n          </header>\n          <main className=\"flex-1 overflow-auto p-6\">\n            <AuthenticatedRouter />\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <MainApp />\n        <Toaster />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n","path":null,"size_bytes":3624,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"client/src/pages/ReviewGroups.tsx":{"content":"import { GroupCard } from \"@/components/GroupCard\";\nimport { EmailPreviewModal } from \"@/components/EmailPreviewModal\";\nimport { useState } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { ProposedGroup } from \"@shared/schema\";\nimport { Download, CheckCircle } from \"lucide-react\";\n\nfunction formatTimeSlot(group: ProposedGroup): string {\n  const dayMap: Record<string, string> = {\n    monday: 'Mon',\n    tuesday: 'Tue',\n    wednesday: 'Wed',\n    thursday: 'Thu',\n    friday: 'Fri',\n  };\n  \n  const formatTime = (time: string) => {\n    const [hours, minutes] = time.split(':').map(Number);\n    const period = hours >= 12 ? 'PM' : 'AM';\n    const displayHours = hours % 12 || 12;\n    return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;\n  };\n  \n  return `${dayMap[group.timeSlot.day]} ${formatTime(group.timeSlot.start)} - ${formatTime(group.timeSlot.end)}`;\n}\n\nexport default function ReviewGroups() {\n  const { toast } = useToast();\n  const [emailModalOpen, setEmailModalOpen] = useState(false);\n  const [selectedGroup, setSelectedGroup] = useState<any>(null);\n  const [selectionMode, setSelectionMode] = useState(false);\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());\n  \n  const { data: groupsData, isLoading } = useQuery<{ success: boolean; groups: ProposedGroup[] }>({\n    queryKey: ['/api/groups'],\n  });\n\n  const pendingGroups = (groupsData?.groups || []).filter(group => group.status === 'pending');\n\n  const approveMutation = useMutation({\n    mutationFn: async (groupId: string) => {\n      const response = await apiRequest('POST', `/api/groups/${groupId}/approve`);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/groups'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/dashboard-stats'] });\n    },\n  });\n\n  const bulkApproveMutation = useMutation({\n    mutationFn: async (groupIds: string[]) => {\n      const response = await apiRequest('POST', '/api/groups/bulk-approve', { groupIds });\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/groups'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/dashboard-stats'] });\n      setSelectedIds(new Set());\n      setSelectionMode(false);\n      toast({\n        title: \"Groups Approved\",\n        description: data.message,\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to approve groups. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const rejectMutation = useMutation({\n    mutationFn: async (groupId: string) => {\n      const response = await apiRequest('POST', `/api/groups/${groupId}/reject`);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/groups'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/dashboard-stats'] });\n      toast({\n        title: \"Group Rejected\",\n        description: \"Participants have been re-queued for future matching runs.\",\n        variant: \"destructive\"\n      });\n    },\n  });\n\n  // Calculate group number for each peer\n  const peerGroupCounts = new Map<string, number>();\n  const transformedGroups = pendingGroups.map((g: ProposedGroup) => {\n    const peerKey = g.peerId;\n    const groupNumber = (peerGroupCounts.get(peerKey) || 0) + 1;\n    peerGroupCounts.set(peerKey, groupNumber);\n    \n    return {\n      groupId: g.id,\n      courseCode: g.courseCode,\n      course: `${g.courseCode} - ${g.instructor}`,\n      timeSlot: formatTimeSlot(g),\n      peer: {\n        id: g.peerId,\n        name: g.peerName,\n        email: g.peerEmail,\n      },\n      learners: g.learners.map((l: any) => ({\n        id: l.id,\n        name: l.name,\n        email: l.email,\n        instructor: l.instructor,\n      })),\n      peerGroupNumber: groupNumber,\n    };\n  });\n\n  const handleApprove = (groupId: string) => {\n    const group = transformedGroups.find(g => g.groupId === groupId);\n    if (group) {\n      setSelectedGroup(group);\n      setEmailModalOpen(true);\n    }\n  };\n\n  const handleReject = (groupId: string) => {\n    rejectMutation.mutate(groupId);\n  };\n\n  const handleEmailConfirm = (sendCopy: boolean) => {\n    console.log('Sending emails, send copy:', sendCopy);\n    if (selectedGroup) {\n      approveMutation.mutate(selectedGroup.groupId, {\n        onSuccess: () => {\n          setEmailModalOpen(false);\n          toast({\n            title: \"Group Approved\",\n            description: `Email notifications sent to all ${selectedGroup.learners.length + 1} participants.`,\n          });\n        },\n      });\n    }\n  };\n\n  const handleSelectChange = (groupId: string, selected: boolean) => {\n    setSelectedIds(prev => {\n      const next = new Set(prev);\n      if (selected) {\n        next.add(groupId);\n      } else {\n        next.delete(groupId);\n      }\n      return next;\n    });\n  };\n\n  const handleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedIds(new Set(transformedGroups.map(g => g.groupId)));\n    } else {\n      setSelectedIds(new Set());\n    }\n  };\n\n  const handleBulkApprove = () => {\n    if (selectedIds.size > 0) {\n      bulkApproveMutation.mutate(Array.from(selectedIds));\n    }\n  };\n\n  const handleExportCSV = () => {\n    window.open('/api/export/groups', '_blank');\n  };\n\n  const allSelected = transformedGroups.length > 0 && selectedIds.size === transformedGroups.length;\n  const someSelected = selectedIds.size > 0 && selectedIds.size < transformedGroups.length;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between flex-wrap gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-semibold\" data-testid=\"text-page-title\">Review Groups</h1>\n          <p className=\"text-muted-foreground mt-1\">\n            Review and approve proposed group matches\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleExportCSV}\n            data-testid=\"button-export-csv\"\n          >\n            <Download className=\"h-4 w-4 mr-2\" />\n            Export CSV\n          </Button>\n          <Badge variant=\"secondary\" className=\"text-sm\" data-testid=\"badge-pending-count\">\n            {transformedGroups.length} Pending\n          </Badge>\n        </div>\n      </div>\n\n      {isLoading ? (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">Loading...</p>\n        </div>\n      ) : transformedGroups.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\" data-testid=\"text-no-groups\">\n            No pending groups to review. Start a matching run to generate new groups.\n          </p>\n        </div>\n      ) : (\n        <>\n          <div className=\"flex items-center justify-between bg-muted/50 p-3 rounded-lg\">\n            <div className=\"flex items-center gap-3\">\n              <Checkbox\n                checked={allSelected}\n                onCheckedChange={handleSelectAll}\n                data-testid=\"checkbox-select-all\"\n                ref={(ref) => {\n                  if (ref && someSelected) {\n                    (ref as unknown as HTMLButtonElement).dataset.state = 'indeterminate';\n                  }\n                }}\n              />\n              <span className=\"text-sm font-medium\">\n                {selectionMode ? (\n                  selectedIds.size > 0 \n                    ? `${selectedIds.size} of ${transformedGroups.length} selected`\n                    : 'Select groups for bulk actions'\n                ) : (\n                  'Select groups for bulk actions'\n                )}\n              </span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              {selectedIds.size > 0 && (\n                <Button\n                  size=\"sm\"\n                  onClick={handleBulkApprove}\n                  disabled={bulkApproveMutation.isPending}\n                  data-testid=\"button-bulk-approve\"\n                >\n                  <CheckCircle className=\"h-4 w-4 mr-2\" />\n                  Approve {selectedIds.size} Groups\n                </Button>\n              )}\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => {\n                  setSelectionMode(!selectionMode);\n                  if (selectionMode) {\n                    setSelectedIds(new Set());\n                  }\n                }}\n                data-testid=\"button-toggle-selection\"\n              >\n                {selectionMode ? 'Cancel Selection' : 'Bulk Select'}\n              </Button>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            {transformedGroups.map((group: any) => (\n              <GroupCard\n                key={group.groupId}\n                groupId={group.groupId}\n                course={group.course}\n                courseCode={group.courseCode}\n                timeSlot={group.timeSlot}\n                peer={group.peer}\n                learners={group.learners}\n                onApprove={handleApprove}\n                onReject={handleReject}\n                selected={selectedIds.has(group.groupId)}\n                onSelectChange={handleSelectChange}\n                selectionMode={selectionMode}\n                peerGroupNumber={group.peerGroupNumber}\n              />\n            ))}\n          </div>\n        </>\n      )}\n\n      {selectedGroup && (\n        <EmailPreviewModal\n          open={emailModalOpen}\n          onOpenChange={setEmailModalOpen}\n          recipients={[\n            { ...selectedGroup.peer, role: 'Peer' as const },\n            ...selectedGroup.learners.map((l: any) => ({ ...l, role: 'Learner' as const }))\n          ]}\n          course={selectedGroup.course}\n          timeSlot={selectedGroup.timeSlot}\n          onConfirm={handleEmailConfirm}\n        />\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":10329,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/AppSidebar.tsx":{"content":"import { Home, PlayCircle, CheckCircle, CheckSquare, AlertCircle, Users2, Settings } from \"lucide-react\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarHeader,\n} from \"@/components/ui/sidebar\";\nimport { useLocation } from \"wouter\";\nimport logoUrl from \"@assets/MRU-TripleStack-CMYK_1764265137904.png\";\n\nconst menuItems = [\n  {\n    title: \"Dashboard\",\n    url: \"/\",\n    icon: Home,\n  },\n  {\n    title: \"Run Matching\",\n    url: \"/run-matching\",\n    icon: PlayCircle,\n  },\n  {\n    title: \"Review Groups\",\n    url: \"/review-groups\",\n    icon: CheckCircle,\n  },\n  {\n    title: \"Matched\",\n    url: \"/matched\",\n    icon: CheckSquare,\n  },\n  {\n    title: \"Unmatched Report\",\n    url: \"/unmatched\",\n    icon: AlertCircle,\n  },\n  {\n    title: \"Learning Peers Without Groups\",\n    url: \"/peers-without-groups\",\n    icon: Users2,\n  },\n  {\n    title: \"Settings\",\n    url: \"/settings\",\n    icon: Settings,\n  },\n];\n\nexport function AppSidebar() {\n  const [location] = useLocation();\n\n  return (\n    <Sidebar>\n      <SidebarHeader className=\"p-4\">\n        <img src={logoUrl} alt=\"Mount Royal University\" className=\"w-full\" />\n      </SidebarHeader>\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"text-xs uppercase tracking-wide\">\n            Navigation\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton\n                    asChild\n                    isActive={location === item.url}\n                    data-testid={`link-${item.title.toLowerCase().replace(/\\s+/g, '-')}`}\n                  >\n                    <a href={item.url}>\n                      <item.icon />\n                      <span>{item.title}</span>\n                    </a>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}\n","path":null,"size_bytes":2172,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/examples/EmailPreviewModal.tsx":{"content":"import { EmailPreviewModal } from '../EmailPreviewModal';\nimport { Button } from '@/components/ui/button';\nimport { useState } from 'react';\n\nexport default function EmailPreviewModalExample() {\n  const [open, setOpen] = useState(true);\n\n  const handleConfirm = (sendCopy: boolean) => {\n    console.log('Sending email, send copy:', sendCopy);\n  };\n\n  return (\n    <div className=\"p-4\">\n      <Button onClick={() => setOpen(true)} data-testid=\"button-open-modal\">\n        Open Email Preview\n      </Button>\n      <EmailPreviewModal\n        open={open}\n        onOpenChange={setOpen}\n        recipients={[\n          { name: 'Sarah Johnson', email: 'sarah.johnson@mtroyal.ca', role: 'Peer' },\n          { name: 'Alex Chen', email: 'alex.chen@mtroyal.ca', role: 'Learner' },\n          { name: 'Emma Wilson', email: 'emma.wilson@mtroyal.ca', role: 'Learner' }\n        ]}\n        course=\"MATH 1505 - Calculus I\"\n        timeSlot=\"Monday 2:00 PM - 3:00 PM\"\n        onConfirm={handleConfirm}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":1011,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/components/GroupCard.tsx":{"content":"import { Card, CardContent, CardFooter, CardHeader } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Clock } from \"lucide-react\";\n\ninterface Learner {\n  id: string;\n  name: string;\n  email: string;\n  instructor?: string;\n}\n\ninterface Peer {\n  id: string;\n  name: string;\n  email: string;\n}\n\ninterface GroupCardProps {\n  groupId: string;\n  course: string;\n  courseCode: string;\n  timeSlot: string;\n  learners: Learner[];\n  peer: Peer;\n  onApprove: (groupId: string) => void;\n  onReject: (groupId: string) => void;\n  selected?: boolean;\n  onSelectChange?: (groupId: string, selected: boolean) => void;\n  selectionMode?: boolean;\n  peerGroupNumber?: number;\n}\n\nexport function GroupCard({ groupId, course, courseCode, timeSlot, learners, peer, onApprove, onReject, selected = false, onSelectChange, selectionMode = false, peerGroupNumber = 1 }: GroupCardProps) {\n  const getInitials = (name: string) => {\n    return name\n      .split(' ')\n      .map(n => n[0])\n      .join('')\n      .toUpperCase()\n      .slice(0, 2);\n  };\n\n  return (\n    <Card data-testid={`card-group-${groupId}`} className={selected ? 'ring-2 ring-primary' : ''}>\n      <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-3\">\n        <div className=\"flex items-center gap-3\">\n          {selectionMode && (\n            <Checkbox\n              checked={selected}\n              onCheckedChange={(checked) => onSelectChange?.(groupId, !!checked)}\n              data-testid={`checkbox-select-${groupId}`}\n            />\n          )}\n          <h3 className=\"text-base font-semibold\" data-testid={`text-course-${groupId}`}>{peer.name} - {courseCode} - Group {peerGroupNumber}</h3>\n        </div>\n        <Badge variant=\"secondary\" className=\"text-xs\" data-testid={`badge-timeslot-${groupId}`}>\n          <Clock className=\"h-3 w-3 mr-1\" />\n          {timeSlot}\n        </Badge>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div>\n          <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2\">\n            Learning Peer\n          </p>\n          <div className=\"flex items-center gap-2\">\n            <Avatar className=\"h-8 w-8\">\n              <AvatarFallback className=\"bg-primary text-primary-foreground text-xs\">\n                {getInitials(peer.name)}\n              </AvatarFallback>\n            </Avatar>\n            <div>\n              <p className=\"text-sm font-medium\" data-testid={`text-peer-name-${groupId}`}>{peer.name}</p>\n              <p className=\"text-xs text-muted-foreground\">{peer.email}</p>\n            </div>\n          </div>\n        </div>\n        <div>\n          <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2\">\n            Learners ({learners.length})\n          </p>\n          <div className=\"border rounded-md overflow-hidden\">\n            <table className=\"w-full text-sm\">\n              <thead>\n                <tr className=\"border-b bg-muted\">\n                  <th className=\"px-3 py-2 text-left font-medium text-xs\">Name</th>\n                  <th className=\"px-3 py-2 text-left font-medium text-xs\">Instructor</th>\n                </tr>\n              </thead>\n              <tbody>\n                {learners.map((learner, idx) => (\n                  <tr key={learner.id} className={idx !== learners.length - 1 ? 'border-b' : ''}>\n                    <td className=\"px-3 py-2\">\n                      <p className=\"text-sm\" data-testid={`text-learner-name-${learner.id}`}>{learner.name}</p>\n                      <p className=\"text-xs text-muted-foreground\">{learner.email}</p>\n                    </td>\n                    <td className=\"px-3 py-2\">\n                      {learner.instructor ? (\n                        <p className=\"text-sm\" data-testid={`text-instructor-${learner.id}`}>{learner.instructor}</p>\n                      ) : (\n                        <p className=\"text-sm text-muted-foreground\"></p>\n                      )}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </CardContent>\n      <CardFooter className=\"flex gap-2\">\n        <Button\n          variant=\"default\"\n          className=\"flex-1\"\n          onClick={() => onApprove(groupId)}\n          data-testid={`button-approve-${groupId}`}\n        >\n          Approve\n        </Button>\n        <Button\n          variant=\"destructive\"\n          className=\"flex-1\"\n          onClick={() => onReject(groupId)}\n          data-testid={`button-reject-${groupId}`}\n        >\n          Reject & Re-queue\n        </Button>\n      </CardFooter>\n    </Card>\n  );\n}\n","path":null,"size_bytes":4858,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/EmailPreviewModal.tsx":{"content":"import {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useState } from \"react\";\n\ninterface EmailPreviewModalProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  recipients: Array<{ name: string; email: string; role: 'Learner' | 'Peer' }>;\n  course: string;\n  timeSlot: string;\n  onConfirm: (sendCopy: boolean) => void;\n}\n\nexport function EmailPreviewModal({\n  open,\n  onOpenChange,\n  recipients,\n  course,\n  timeSlot,\n  onConfirm\n}: EmailPreviewModalProps) {\n  const [sendCopy, setSendCopy] = useState(false);\n\n  const handleConfirm = () => {\n    onConfirm(sendCopy);\n    onOpenChange(false);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl\" data-testid=\"modal-email-preview\">\n        <DialogHeader>\n          <DialogTitle>Email Preview</DialogTitle>\n          <DialogDescription>\n            Review the email notification before sending to all participants\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <div>\n            <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2\">\n              Recipients\n            </p>\n            <div className=\"flex flex-wrap gap-2\">\n              {recipients.map((recipient, idx) => (\n                <Badge\n                  key={idx}\n                  variant={recipient.role === 'Peer' ? 'default' : 'secondary'}\n                  data-testid={`badge-recipient-${idx}`}\n                >\n                  {recipient.name} ({recipient.role})\n                </Badge>\n              ))}\n            </div>\n          </div>\n\n          <div>\n            <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2\">\n              Subject\n            </p>\n            <p className=\"text-sm font-mono bg-muted p-3 rounded-md\" data-testid=\"text-email-subject\">\n              Study Group Confirmation - {course}\n            </p>\n          </div>\n\n          <div>\n            <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2\">\n              Message\n            </p>\n            <div className=\"bg-muted p-4 rounded-md space-y-3 text-sm\" data-testid=\"text-email-body\">\n              <p>Dear Study Group Participants,</p>\n              <p>\n                Your study group for <strong>{course}</strong> has been confirmed!\n              </p>\n              <div className=\"bg-background p-3 rounded border\">\n                <p className=\"font-semibold mb-2\">Session Details:</p>\n                <ul className=\"space-y-1 text-sm\">\n                  <li><strong>Course:</strong> {course}</li>\n                  <li><strong>Time:</strong> {timeSlot}</li>\n                  <li><strong>Duration:</strong> 1 hour weekly (recurring for the semester)</li>\n                </ul>\n              </div>\n              <div>\n                <p className=\"font-semibold mb-2\">Group Members:</p>\n                <ul className=\"space-y-1\">\n                  {recipients.map((recipient, idx) => (\n                    <li key={idx}>\n                      {recipient.name} - <em>{recipient.role}</em> ({recipient.email})\n                    </li>\n                  ))}\n                </ul>\n              </div>\n              <p>\n                Please coordinate with your group to confirm the meeting location.\n              </p>\n              <p className=\"text-muted-foreground\">\n                Best regards,<br />\n                Mount Royal University Learning Support Team\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              id=\"send-copy\"\n              checked={sendCopy}\n              onCheckedChange={(checked) => setSendCopy(checked as boolean)}\n              data-testid=\"checkbox-send-copy\"\n            />\n            <Label htmlFor=\"send-copy\" className=\"text-sm cursor-pointer\">\n              Send me a copy of this email\n            </Label>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)} data-testid=\"button-cancel-email\">\n            Cancel\n          </Button>\n          <Button onClick={handleConfirm} data-testid=\"button-confirm-send-email\">\n            Confirm & Send\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":4679,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"replit.md":{"content":"# Semester Volunteer Matching System\n\n## Overview\n\nThe Semester Volunteer Matching System is an administrative tool for Mount Royal University that automates the process of matching students (learners) seeking academic help with volunteer Learning Peers. The system ingests participant data from Google Sheets, runs a constraint-based matching algorithm, and provides an administrative interface for reviewing and managing proposed groups.\n\n**Core Purpose**: Efficiently match 1-4 learners per group with qualified learning peers based on course requirements, instructor preferences, and schedule availability, while minimizing manual administrative overhead.\n\n**Key Workflows**:\n1. Data ingestion from Google Sheets (learner requests, peer availability, schedules)\n2. Algorithmic matching with hard constraints (group size, volunteer load, schedule conflicts, instructor requirements)\n3. Administrative review and approval of proposed groups\n4. Tracking of unmatched participants with constraint failure explanations\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React with TypeScript using Vite as the build tool\n\n**UI Component System**: shadcn/ui components built on Radix UI primitives with Tailwind CSS for styling\n\n**Design Philosophy**: Linear-inspired productivity interface with Material Design data patterns, optimized for administrative workflows with minimal cognitive load\n\n**State Management**: \n- TanStack Query (React Query) for server state management with automatic refetching and caching\n- Local component state for UI interactions\n- No global state library (Redux/Zustand) - server state is the source of truth\n\n**Routing**: Wouter for lightweight client-side routing with seven main routes:\n- `/` - Dashboard with overview statistics\n- `/run-matching` - Trigger matching runs and monitor progress\n- `/review-groups` - Review and approve/reject proposed groups\n- `/matched` - View approved groups with learner and peer information\n- `/unmatched` - View unmatched participants with failure reasons\n- `/peers-without-groups` - View learning peers with no assigned groups\n- `/settings` - System configuration\n\n**Key UI Patterns**:\n- Sidebar navigation with fixed 16rem width\n- Card-based layouts for grouping related information\n- Stat cards for key metrics (total learners, peers, match rate)\n- Table-based views for detailed data (unmatched participants)\n- Modal dialogs for email previews and confirmations\n- Real-time progress indicators for matching runs\n\n### Backend Architecture\n\n**Runtime**: Node.js with Express.js server\n\n**Language**: TypeScript with ESM module format\n\n**API Design**: RESTful HTTP endpoints with JSON payloads\n- `POST /api/matching-runs` - Start new matching run\n- `GET /api/matching-runs` - Retrieve matching run history\n- `GET /api/groups` - Retrieve proposed groups for review\n- `POST /api/groups/:id/approve` - Approve a group\n- `POST /api/groups/:id/reject` - Reject and re-queue a group\n- `PATCH /api/groups/:id` - Update group manually (add/remove participants)\n- `GET /api/unmatched` - Retrieve unmatched participants\n- `GET /api/peers/without-groups` - Retrieve learning peers with no assigned groups\n\n**Data Storage Strategy**: PostgreSQL database with `DbStorage` class implementing `IStorage` interface\n- **Database**: Replit-provided Neon-backed PostgreSQL database\n- **Schema**: Three main tables (matching_runs, proposed_groups, unmatched_participants) managed via Drizzle ORM\n- **Data Persistence**: All matching runs, proposed groups, and manual adjustments survive server restarts\n- **JSONB Columns**: Learner data, time slots, and peer info stored as JSONB for flexibility\n- **Performance**: Indexed on run_id, status, and course_code for optimized queries\n- **Concurrency Safety**: Explicit runId parameters prevent race conditions between simultaneous matching runs\n- **Legacy Support**: MemStorage class retained for testing, but production uses DbStorage\n- **Primary Data Source**: Google Sheets remains read-only source; database holds derived/computed state\n\n**Matching Algorithm Design**:\n\n*Hard Constraints* (must be satisfied):\n- Group size: 1-4 learners per group, same course code\n- Volunteer load: Maximum 2 groups per learning peer\n- Schedule conflicts: No overlaps with class times (5-minute buffer for travel)\n- Instructor matching: When `instructorMatchRequired === true`, learner must be grouped with peers having the same normalized instructor\n\n*Optimization Priorities* (in order):\n1. Minimize unmatched participants\n2. Maximize group sizes (prefer 3-4 learners over 1-2)\n3. Prefer time slots within preferred proximity windows\n4. Balance peer workloads across groups\n\n*Algorithm Approach*:\n- **Two-phase prioritization**: Process instructor-required groups first to reserve peers for learners with specific instructor needs\n- **Mixed cohort groups**: Instructor-flexible learners can join instructor-specific groups to maximize group sizes (e.g., 1 instructor-required learner + 3 flexible learners = group of 4)\n- **Combinatorial search**: For each potential group, try all combinations of 1-4 learners to find the best fit (limited to 20 combinations for performance)\n- **Backtracking**: When peers are reserved for instructor-required matches, any unused capacity remains available for later general matching\n- Track unmatched participants with specific failure reasons (schedule conflicts, no peers available, instructor mismatch)\n\n**Instructor Normalization**: Case-insensitive, whitespace-trimmed matching for instructor names (e.g., \"Sarah Haughey\", \"Sarah haughey\", \"sarah haughey\" all treated as same instructor)\n\n**Recent Improvements** (Nov 2025):\n- **Email Allowlist Access Control** (Nov 29): Restricts admin access to approved emails only\n  - Database-backed allowlist (allowed_emails table) with CRUD operations\n  - Login verification rejects users not on the allowlist with clear access denied message\n  - Admin UI in Settings page to view, add, and remove allowed emails\n  - Initial allowed emails: plp@mtroyal.ca and ucalgary.ca team members\n  - Audit trail: tracks who added each email and when\n- **Admin Authentication** (Nov 29): Added Replit Auth for secure admin access\n  - All API endpoints now require authentication\n  - Landing page for unauthenticated users with sign-in button\n  - Login via Google, GitHub, email/password through Replit's OpenID Connect\n  - User sessions stored in PostgreSQL with 1-week TTL\n  - Logout button in header with user avatar display\n- **Enhanced Instructor Matching** (Nov 27): Improved name normalization to correctly group similar instructor names:\n  - \"Pete Jackson\" + \"Peter Jackson\"  Same group\n  - \"Dr. Kurosawa\" + \"Akira Kurosawa\"  Same group\n  - All title variations (Dr., Professor, etc.) and common abbreviations (Pete/Peter, etc.) now properly unified\n  - Uses fuzzy matching and abbreviation lookup during grouping phase, not just matching phase\n- **Semester Reset** (Nov 27): \"Reset for New Semester\" button on Settings page with confirmation dialog to safely clear all matching data while preserving system configuration\n- **Incremental Matching** (Nov 27): \"Match New Requests Only\" toggle on Run Matching page to process only new learners while skipping already-approved matches, avoiding re-matching and preserving established groups\n- **Matched Groups CSV Export** (Nov 27): Export approved groups to CSV file with all group details, participant information, and scheduling\n- **Match Confirmation Email Template** (Nov 27): Integrated professional email template for group notifications with course info, meeting times, and peer learning guidelines\n- **Updated Terminology** (Nov 27): Changed all instances of \"tutors\" to \"Learning Peers\" throughout platform for consistency\n- **Peers Without Groups Page** (Nov 27): New administrative page to view all learning peers without assigned groups, with search functionality\n- **Manual Placement Modal** (Nov 27): Modal dialog allowing assignment of unmatched learners to existing groups from Matched or Review Groups pages\n- **Specific Constraint Failure Reasons** (Nov 26): Unmatched participants now show exactly why they weren't matched:\n  - \"No eligible peers\" - No peers available for the course\n  - \"No eligible peers with instructor\" - No peers for course + specific instructor requirement\n  - \"Schedule conflict\" - Lists which peers were tried but had no common time slots\n  - \"Peer capacity exhausted\" - Lists which peers are at their maximum group limit\n  - \"Missing schedule\" - Learner's class schedule not found in Google Sheets\n- **Database Persistence** (Nov 24): Migrated from MemStorage to PostgreSQL with full data persistence across server restarts\n  - Manual group adjustments now survive server restarts, code refactoring, and new matching runs\n  - Fixed critical concurrency bug by removing latestRunId singleton and using explicit runId parameters\n  - Added database indexes on run_id, status, course_code for optimized query performance\n  - Architect-approved as production-ready with all concurrency issues resolved\n- **Matching Algorithm**: Fixed critical bug where instructor-flexible matching incorrectly rejected peers with different instructors (improved match rate from 4 to 21 learners)\n- **Instructor Normalization**: Implemented case-insensitive matching to prevent duplicate groups from case sensitivity\n- **Mixed Cohorts**: Allow flexible learners to fill instructor-specific groups (maintains 21-learner throughput while honoring all instructor requirements)\n- **Time Slot Intelligence**: Gap detection with scoring (3=between classes, 2=within 1hr, 1=within 2hrs, 0=far from classes)\n  - Group-level gap detection maximizes convenience when different participants arrive from/stay for classes\n\n### External Dependencies\n\n**Google Sheets API Integration**:\n- **Purpose**: Primary data source for all participant information\n- **Authentication**: OAuth2 via Replit Connectors with automatic token refresh\n- **Spreadsheet Structure**: Single spreadsheet with 4 worksheets:\n  - `Requests` - Learner requests (timestamp, email, name, course, instructor, section)\n  - `Learning Peers` - Volunteer tutors (email, name, courses 1-3, other courses)\n  - `Volunteer Class Schedule` - Peer availability (email, name, Mon-Fri time slots)\n  - `Learner Class Schedule` - Learner class times (email, name, Mon-Fri time slots)\n- **Data Access Module**: `server/googleSheets.ts` with dedicated loader functions:\n  - `loadRequests()` - Parse learner requests, validate instructor match requirements\n  - `loadLearningPeers()` - Parse peer data, extract course/instructor pairs from \"Other Courses\"\n  - `loadVolunteerSchedules()` - Parse peer schedules as blocked time slots\n  - `loadLearnerSchedules()` - Parse learner schedules as blocked time slots\n- **Schedule Format**: Time slots represented as \"0830-0950; 1000-1120\" (semicolon-separated ranges during which participants are unavailable)\n- **Data Cleaning**: Trim whitespace, strip grade markers (A+, B-, etc.) from course entries, exclude test email \"chickey@test\"\n\n**Third-Party UI Libraries**:\n- **shadcn/ui**: Component library built on Radix UI primitives\n- **Radix UI**: Unstyled, accessible component primitives (dialogs, dropdowns, accordions, etc.)\n- **Tailwind CSS**: Utility-first CSS framework with custom theme (neutral base color, Linear-inspired spacing)\n- **Lucide React**: Icon library for UI elements\n- **date-fns**: Date manipulation and formatting\n\n**Development Tools**:\n- **Drizzle ORM**: Type-safe ORM with PostgreSQL dialect - actively used for database persistence\n- **Database Migrations**: Use `npm run db:push` to sync schema changes (add `--force` if needed)\n- **Vite**: Build tool and dev server with HMR\n- **TypeScript**: Type safety across client, server, and shared schemas\n- **Zod**: Runtime schema validation for data parsing and type inference\n\n**Deployment Environment**: Replit with environment variables managed through Replit Secrets\n- `REPLIT_CONNECTORS_HOSTNAME` - Connector API hostname\n- `REPL_IDENTITY` / `WEB_REPL_RENEWAL` - Authentication tokens for Google Sheets connector\n- `DATABASE_URL` - PostgreSQL connection string (actively used for Neon database)\n- `PGHOST`, `PGPORT`, `PGUSER`, `PGPASSWORD`, `PGDATABASE` - PostgreSQL connection details\n\n**Font Delivery**: Google Fonts CDN for Inter (UI text) and JetBrains Mono (data/monospace)","path":null,"size_bytes":12472,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1080,"size_tokens":null},"client/src/components/examples/MatchingRunPanel.tsx":{"content":"import { MatchingRunPanel } from '../MatchingRunPanel';\nimport { useState } from 'react';\n\nexport default function MatchingRunPanelExample() {\n  const [isRunning, setIsRunning] = useState(false);\n  const [progress, setProgress] = useState(0);\n\n  const handleStartRun = () => {\n    console.log('Start matching run');\n    setIsRunning(true);\n    setProgress(0);\n    \n    const interval = setInterval(() => {\n      setProgress(prev => {\n        if (prev >= 100) {\n          clearInterval(interval);\n          setIsRunning(false);\n          return 100;\n        }\n        return prev + 10;\n      });\n    }, 500);\n  };\n\n  const handleSyncData = () => {\n    console.log('Sync Google Sheets data');\n  };\n\n  return (\n    <div className=\"p-4 max-w-3xl\">\n      <MatchingRunPanel\n        lastRun={new Date('2024-01-15T14:30:00')}\n        dataSourceSynced={new Date('2024-01-17T09:15:00')}\n        isRunning={isRunning}\n        progress={progress}\n        onStartRun={handleStartRun}\n        onSyncData={handleSyncData}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":1034,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"server/storage.ts":{"content":"import type {\n  ProposedGroup,\n  MatchingRun,\n  UnmatchedParticipant,\n  InsertProposedGroup,\n  InsertMatchingRun,\n  User,\n  UpsertUser,\n  AllowedEmail,\n} from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\nexport interface IStorage {\n  // User operations (required for Replit Auth)\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  \n  // Matching Runs\n  createMatchingRun(run: InsertMatchingRun): Promise<MatchingRun>;\n  getMatchingRun(id: string): Promise<MatchingRun | undefined>;\n  getAllMatchingRuns(): Promise<MatchingRun[]>;\n  getLatestMatchingRun(): Promise<MatchingRun | undefined>;\n  updateMatchingRunStatus(id: string, status: 'running' | 'completed' | 'failed'): Promise<void>;\n  updateMatchingRunMetrics(id: string, metrics: {\n    totalLearners: number;\n    totalPeers: number;\n    matchedLearners: number;\n    unmatchedLearners: number;\n    proposedGroups: number;\n  }): Promise<void>;\n  \n  // Proposed Groups\n  createGroup(runId: string, group: InsertProposedGroup): Promise<ProposedGroup>;\n  getGroup(id: string): Promise<ProposedGroup | undefined>;\n  getAllGroups(): Promise<ProposedGroup[]>;\n  getGroupsByRunId(runId: string): Promise<ProposedGroup[]>;\n  updateGroupStatus(id: string, status: 'pending' | 'approved' | 'rejected'): Promise<void>;\n  updateGroup(id: string, updates: Partial<Omit<ProposedGroup, 'id' | 'status'>>): Promise<void>;\n  deleteGroup(id: string): Promise<void>;\n  \n  // Unmatched Participants\n  setUnmatchedParticipants(runId: string, participants: UnmatchedParticipant[]): Promise<void>;\n  getUnmatchedParticipants(runId: string): Promise<UnmatchedParticipant[]>;\n  getLatestUnmatchedParticipants(): Promise<UnmatchedParticipant[]>;\n  \n  // Allowed Emails (access control)\n  getAllowedEmails(): Promise<AllowedEmail[]>;\n  isEmailAllowed(email: string): Promise<boolean>;\n  addAllowedEmail(email: string, addedBy?: string): Promise<AllowedEmail>;\n  removeAllowedEmail(id: string): Promise<void>;\n}\n\nexport class MemStorage implements IStorage {\n  private matchingRuns: Map<string, MatchingRun>;\n  private proposedGroups: Map<string, ProposedGroup>;\n  private unmatchedByRun: Map<string, UnmatchedParticipant[]>;\n  private groupsByRun: Map<string, string[]>; // runId -> groupIds[]\n  private users: Map<string, User>;\n  private allowedEmailsMap: Map<string, AllowedEmail>;\n\n  constructor() {\n    this.matchingRuns = new Map();\n    this.proposedGroups = new Map();\n    this.unmatchedByRun = new Map();\n    this.groupsByRun = new Map();\n    this.users = new Map();\n    this.allowedEmailsMap = new Map();\n  }\n\n  // User operations (required for Replit Auth)\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const existing = userData.id ? this.users.get(userData.id) : undefined;\n    const user: User = {\n      id: userData.id || randomUUID(),\n      email: userData.email || null,\n      firstName: userData.firstName || null,\n      lastName: userData.lastName || null,\n      profileImageUrl: userData.profileImageUrl || null,\n      createdAt: existing?.createdAt || new Date(),\n      updatedAt: new Date(),\n    };\n    this.users.set(user.id, user);\n    return user;\n  }\n\n  // Matching Runs\n  async createMatchingRun(insertRun: InsertMatchingRun): Promise<MatchingRun> {\n    const id = randomUUID();\n    const run: MatchingRun = { ...insertRun, id };\n    this.matchingRuns.set(id, run);\n    this.groupsByRun.set(id, []);\n    return run;\n  }\n\n  async getMatchingRun(id: string): Promise<MatchingRun | undefined> {\n    return this.matchingRuns.get(id);\n  }\n\n  async getAllMatchingRuns(): Promise<MatchingRun[]> {\n    return Array.from(this.matchingRuns.values()).sort((a, b) => \n      b.timestamp.getTime() - a.timestamp.getTime()\n    );\n  }\n\n  async getLatestMatchingRun(): Promise<MatchingRun | undefined> {\n    const runs = await this.getAllMatchingRuns();\n    return runs[0];\n  }\n\n  async updateMatchingRunStatus(id: string, status: 'running' | 'completed' | 'failed'): Promise<void> {\n    const run = this.matchingRuns.get(id);\n    if (run) {\n      run.status = status;\n      this.matchingRuns.set(id, run);\n    }\n  }\n\n  async updateMatchingRunMetrics(id: string, metrics: {\n    totalLearners: number;\n    totalPeers: number;\n    matchedLearners: number;\n    unmatchedLearners: number;\n    proposedGroups: number;\n  }): Promise<void> {\n    const run = this.matchingRuns.get(id);\n    if (run) {\n      run.totalLearners = metrics.totalLearners;\n      run.totalPeers = metrics.totalPeers;\n      run.matchedLearners = metrics.matchedLearners;\n      run.unmatchedLearners = metrics.unmatchedLearners;\n      run.proposedGroups = metrics.proposedGroups;\n      this.matchingRuns.set(id, run);\n    }\n  }\n\n  // Proposed Groups\n  async createGroup(runId: string, insertGroup: InsertProposedGroup): Promise<ProposedGroup> {\n    const id = randomUUID();\n    const group: ProposedGroup = { ...insertGroup, id, status: 'pending' };\n    this.proposedGroups.set(id, group);\n    \n    // Associate with the provided run ID\n    const runGroups = this.groupsByRun.get(runId) || [];\n    runGroups.push(id);\n    this.groupsByRun.set(runId, runGroups);\n    \n    return group;\n  }\n\n  async getGroup(id: string): Promise<ProposedGroup | undefined> {\n    return this.proposedGroups.get(id);\n  }\n\n  async getAllGroups(): Promise<ProposedGroup[]> {\n    return Array.from(this.proposedGroups.values());\n  }\n\n  async getGroupsByRunId(runId: string): Promise<ProposedGroup[]> {\n    const groupIds = this.groupsByRun.get(runId) || [];\n    return groupIds\n      .map(id => this.proposedGroups.get(id))\n      .filter((g): g is ProposedGroup => g !== undefined);\n  }\n\n  async updateGroupStatus(id: string, status: 'pending' | 'approved' | 'rejected'): Promise<void> {\n    const group = this.proposedGroups.get(id);\n    if (group) {\n      group.status = status;\n      this.proposedGroups.set(id, group);\n    }\n  }\n\n  async updateGroup(id: string, updates: Partial<Omit<ProposedGroup, 'id' | 'status'>>): Promise<void> {\n    const group = this.proposedGroups.get(id);\n    if (group) {\n      const updatedGroup = { ...group, ...updates };\n      this.proposedGroups.set(id, updatedGroup);\n    }\n  }\n\n  async deleteGroup(id: string): Promise<void> {\n    this.proposedGroups.delete(id);\n    \n    // Remove from run associations\n    for (const [runId, groupIds] of Array.from(this.groupsByRun.entries())) {\n      const filtered = groupIds.filter((gid: string) => gid !== id);\n      this.groupsByRun.set(runId, filtered);\n    }\n  }\n\n  // Unmatched Participants\n  async setUnmatchedParticipants(runId: string, participants: UnmatchedParticipant[]): Promise<void> {\n    this.unmatchedByRun.set(runId, participants);\n  }\n\n  async getUnmatchedParticipants(runId: string): Promise<UnmatchedParticipant[]> {\n    return this.unmatchedByRun.get(runId) || [];\n  }\n\n  async getLatestUnmatchedParticipants(): Promise<UnmatchedParticipant[]> {\n    const latestRun = await this.getLatestMatchingRun();\n    if (!latestRun) {\n      return [];\n    }\n    return this.unmatchedByRun.get(latestRun.id) || [];\n  }\n\n  async getApprovedLearnerEmails(): Promise<string[]> {\n    const approvedEmails = new Set<string>();\n    const groups = Array.from(this.proposedGroups.values());\n    for (const group of groups) {\n      if (group.status === 'approved') {\n        for (const learner of group.learners) {\n          approvedEmails.add(learner.email);\n        }\n      }\n    }\n    return Array.from(approvedEmails);\n  }\n\n  async resetSemester(): Promise<void> {\n    this.matchingRuns.clear();\n    this.proposedGroups.clear();\n    this.unmatchedByRun.clear();\n    this.groupsByRun.clear();\n  }\n\n  // Allowed Emails operations\n  async getAllowedEmails(): Promise<AllowedEmail[]> {\n    return Array.from(this.allowedEmailsMap.values());\n  }\n\n  async isEmailAllowed(email: string): Promise<boolean> {\n    const normalizedEmail = email.toLowerCase().trim();\n    const allowedList = Array.from(this.allowedEmailsMap.values());\n    for (const allowed of allowedList) {\n      if (allowed.email.toLowerCase().trim() === normalizedEmail) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  async addAllowedEmail(email: string, addedBy?: string): Promise<AllowedEmail> {\n    const id = randomUUID();\n    const allowedEmail: AllowedEmail = {\n      id,\n      email: email.toLowerCase().trim(),\n      addedBy: addedBy || null,\n      addedAt: new Date(),\n    };\n    this.allowedEmailsMap.set(id, allowedEmail);\n    return allowedEmail;\n  }\n\n  async removeAllowedEmail(id: string): Promise<void> {\n    this.allowedEmailsMap.delete(id);\n  }\n}\n\nimport { DbStorage } from \"./dbStorage\";\n\nexport const storage = new DbStorage();\n","path":null,"size_bytes":8750,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","path":null,"size_bytes":2210,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/pages/Dashboard.tsx":{"content":"import { StatCard } from \"@/components/StatCard\";\nimport { ActivityTimeline } from \"@/components/ActivityTimeline\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Users, GraduationCap, CheckCircle, PlayCircle, FileText, AlertCircle } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ninterface DashboardStats {\n  totalLearners: number;\n  totalPeers: number;\n  matchedLearners: number;\n  matchRate: number;\n  pendingGroups: number;\n  approvedGroups: number;\n  unmatchedCount: number;\n}\n\ninterface RecentActivity {\n  id: string;\n  type: 'run' | 'approval' | 'rejection';\n  description: string;\n  timestamp: string;\n  status: string;\n}\n\ninterface DashboardResponse {\n  success: boolean;\n  stats: DashboardStats;\n  recentActivity: RecentActivity[];\n  lastRunTimestamp?: string;\n}\n\nexport default function Dashboard() {\n  const { data, isLoading } = useQuery<DashboardResponse>({\n    queryKey: ['/api/dashboard-stats'],\n    refetchInterval: 30000,\n  });\n\n  const stats = data?.stats || {\n    totalLearners: 0,\n    totalPeers: 0,\n    matchedLearners: 0,\n    matchRate: 0,\n    pendingGroups: 0,\n    approvedGroups: 0,\n    unmatchedCount: 0,\n  };\n\n  const activities = (data?.recentActivity || []).map(activity => ({\n    id: activity.id,\n    type: activity.type,\n    description: activity.description,\n    timestamp: new Date(activity.timestamp),\n  }));\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold\" data-testid=\"text-page-title\">Dashboard</h1>\n        <p className=\"text-muted-foreground mt-1\">\n          Overview of matching activity and system status\n        </p>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          {[1, 2, 3].map((i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardHeader className=\"pb-2\">\n                <div className=\"h-4 bg-muted rounded w-24\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-8 bg-muted rounded w-16\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <StatCard\n            title=\"Total Learners\"\n            value={stats.totalLearners}\n            subtitle=\"Requesting tutoring\"\n            icon={GraduationCap}\n          />\n          <StatCard\n            title=\"Total Learning Peers\"\n            value={stats.totalPeers}\n            subtitle=\"Available Learning Peers\"\n            icon={Users}\n          />\n          <StatCard\n            title=\"Matched\"\n            value={stats.matchedLearners}\n            subtitle={`${stats.matchRate}% match rate`}\n            icon={CheckCircle}\n          />\n          <StatCard\n            title=\"Unmatched\"\n            value={stats.unmatchedCount}\n            subtitle=\"Need attention\"\n            icon={AlertCircle}\n            variant={stats.unmatchedCount > 0 ? \"warning\" : \"default\"}\n          />\n        </div>\n      )}\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <StatCard\n          title=\"Pending Review\"\n          value={stats.pendingGroups}\n          subtitle=\"Groups awaiting approval\"\n          icon={FileText}\n        />\n        <StatCard\n          title=\"Approved Groups\"\n          value={stats.approvedGroups}\n          subtitle=\"Ready for notifications\"\n          icon={CheckCircle}\n        />\n        <Card data-testid=\"card-last-run\">\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Last Run</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-lg font-semibold\" data-testid=\"text-last-run\">\n              {data?.lastRunTimestamp \n                ? new Date(data.lastRunTimestamp).toLocaleDateString('en-US', {\n                    month: 'short',\n                    day: 'numeric',\n                    hour: '2-digit',\n                    minute: '2-digit',\n                  })\n                : 'No runs yet'}\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        <ActivityTimeline activities={activities} />\n        \n        <Card data-testid=\"card-quick-actions\">\n          <CardHeader>\n            <CardTitle className=\"text-base\">Quick Actions</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-2\">\n            <Link href=\"/run-matching\">\n              <Button variant=\"outline\" className=\"w-full justify-start\" data-testid=\"button-quick-run-matching\">\n                <PlayCircle className=\"h-4 w-4 mr-2\" />\n                Start New Matching Run\n              </Button>\n            </Link>\n            <Link href=\"/review-groups\">\n              <Button variant=\"outline\" className=\"w-full justify-start\" data-testid=\"button-quick-review-groups\">\n                <CheckCircle className=\"h-4 w-4 mr-2\" />\n                Review Proposed Groups ({stats.pendingGroups} pending)\n              </Button>\n            </Link>\n            <Link href=\"/unmatched\">\n              <Button variant=\"outline\" className=\"w-full justify-start\" data-testid=\"button-quick-unmatched\">\n                <AlertCircle className=\"h-4 w-4 mr-2\" />\n                View Unmatched Report ({stats.unmatchedCount} participants)\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":5616,"size_tokens":null},"client/src/components/examples/UnmatchedTable.tsx":{"content":"import { UnmatchedTable } from '../UnmatchedTable';\n\nexport default function UnmatchedTableExample() {\n  const mockParticipants = [\n    {\n      id: 'u1',\n      name: 'Jessica Williams',\n      email: 'jessica.williams@mtroyal.ca',\n      role: 'Learner' as const,\n      course: 'MATH 1505',\n      constraintFailure: 'Instructor Match Required - No peer available with same instructor',\n      suggestedAlternative: 'Tue 3:00 PM with different instructor'\n    },\n    {\n      id: 'u2',\n      name: 'Ryan Thompson',\n      email: 'ryan.thompson@mtroyal.ca',\n      role: 'Learner' as const,\n      course: 'COMP 1501',\n      constraintFailure: 'No available time slots - Schedule conflicts with all peers',\n    },\n    {\n      id: 'u3',\n      name: 'Maria Garcia',\n      email: 'maria.garcia@mtroyal.ca',\n      role: 'Peer' as const,\n      course: 'PHYS 2201',\n      constraintFailure: 'Maximum group capacity reached (2 groups)',\n    },\n  ];\n\n  const handleManualPlace = (id: string) => {\n    console.log('Manual placement for:', id);\n  };\n\n  return (\n    <div className=\"p-4\">\n      <UnmatchedTable\n        participants={mockParticipants}\n        onManualPlace={handleManualPlace}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":1200,"size_tokens":null},"client/src/components/examples/ActivityTimeline.tsx":{"content":"import { ActivityTimeline } from '../ActivityTimeline';\n\nexport default function ActivityTimelineExample() {\n  const mockActivities = [\n    {\n      id: 'a1',\n      type: 'approval' as const,\n      description: 'Approved group for MATH 1505 (3 learners)',\n      timestamp: new Date(Date.now() - 1000 * 60 * 5)\n    },\n    {\n      id: 'a2',\n      type: 'approval' as const,\n      description: 'Approved group for COMP 1501 (2 learners)',\n      timestamp: new Date(Date.now() - 1000 * 60 * 12)\n    },\n    {\n      id: 'a3',\n      type: 'rejection' as const,\n      description: 'Rejected and re-queued group for PHYS 2201',\n      timestamp: new Date(Date.now() - 1000 * 60 * 45)\n    },\n    {\n      id: 'a4',\n      type: 'run' as const,\n      description: 'Started matching run for Fall 2024',\n      timestamp: new Date(Date.now() - 1000 * 60 * 60 * 2)\n    },\n    {\n      id: 'a5',\n      type: 'sync' as const,\n      description: 'Synced data from Google Sheets',\n      timestamp: new Date(Date.now() - 1000 * 60 * 60 * 3)\n    }\n  ];\n\n  return (\n    <div className=\"p-4 max-w-md\">\n      <ActivityTimeline activities={mockActivities} />\n    </div>\n  );\n}\n","path":null,"size_bytes":1147,"size_tokens":null},"client/src/components/examples/StatCard.tsx":{"content":"import { StatCard } from '../StatCard';\nimport { Users, GraduationCap, CheckCircle } from 'lucide-react';\n\nexport default function StatCardExample() {\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 p-4\">\n      <StatCard\n        title=\"Total Learners\"\n        value={342}\n        subtitle=\"Active this semester\"\n        icon={GraduationCap}\n        trend={{ value: \"12% from last semester\", positive: true }}\n      />\n      <StatCard\n        title=\"Total Peers\"\n        value={89}\n        subtitle=\"Available Learning Peers\"\n        icon={Users}\n      />\n      <StatCard\n        title=\"Matched This Semester\"\n        value={287}\n        subtitle=\"84% match rate\"\n        icon={CheckCircle}\n        trend={{ value: \"8% from last semester\", positive: true }}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":805,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/pages/Settings.tsx":{"content":"import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Input } from \"@/components/ui/input\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { CheckCircle, Database, Clock, Users, GraduationCap, Layers, Settings2, Trash2, Shield, Plus, X, Mail } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\ninterface AllowedEmail {\n  id: string;\n  email: string;\n  addedBy: string | null;\n  addedAt: string | null;\n}\n\ninterface SettingsResponse {\n  success: boolean;\n  settings: {\n    dataSource: {\n      connected: boolean;\n      type: string;\n      lastSync: string | null;\n    };\n    matchingConstraints: {\n      maxGroupSize: number;\n      minGroupSize: number;\n      maxPeerGroups: number;\n      travelBufferMinutes: number;\n      availabilityStart: string;\n      availabilityEnd: string;\n    };\n    statistics: {\n      totalMatchingRuns: number;\n      totalLearners: number;\n      totalPeers: number;\n      totalGroups: number;\n      lastRunStatus: string;\n    };\n  };\n}\n\nexport default function Settings() {\n  const [showResetDialog, setShowResetDialog] = useState(false);\n  const [newEmail, setNewEmail] = useState('');\n  const { toast } = useToast();\n  const { data, isLoading } = useQuery<SettingsResponse>({\n    queryKey: ['/api/settings'],\n  });\n\n  const { data: allowedEmails, isLoading: emailsLoading } = useQuery<AllowedEmail[]>({\n    queryKey: ['/api/admin/allowed-emails'],\n  });\n\n  const settings = data?.settings;\n\n  const resetMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('POST', '/api/admin/reset-semester');\n      return response.json();\n    },\n    onSuccess: () => {\n      setShowResetDialog(false);\n      toast({\n        title: \"Semester Reset Complete\",\n        description: \"All matching data has been cleared. Ready for new semester.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/settings'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/matching-runs'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/groups'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/unmatched'] });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to reset semester. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const addEmailMutation = useMutation({\n    mutationFn: async (email: string) => {\n      const response = await apiRequest('POST', '/api/admin/allowed-emails', { email });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to add email');\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      setNewEmail('');\n      toast({\n        title: \"Email Added\",\n        description: \"The email has been added to the allowlist.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/allowed-emails'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const removeEmailMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const response = await apiRequest('DELETE', `/api/admin/allowed-emails/${id}`);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Email Removed\",\n        description: \"The email has been removed from the allowlist.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/allowed-emails'] });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to remove email. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleAddEmail = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (newEmail.trim()) {\n      addEmailMutation.mutate(newEmail.trim());\n    }\n  };\n\n  const formatTime = (time: string) => {\n    const [hours, minutes] = time.split(':').map(Number);\n    const period = hours >= 12 ? 'PM' : 'AM';\n    const displayHours = hours % 12 || 12;\n    return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;\n  };\n\n  const formatDate = (dateString: string | null) => {\n    if (!dateString) return 'Never';\n    return new Date(dateString).toLocaleString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold\" data-testid=\"text-page-title\">Settings</h1>\n        <p className=\"text-muted-foreground mt-1\">\n          System configuration and connection status\n        </p>\n      </div>\n\n      {isLoading ? (\n        <div className=\"max-w-3xl space-y-6\">\n          {[1, 2, 3].map((i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardHeader>\n                <div className=\"h-5 bg-muted rounded w-32\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-4 bg-muted rounded w-48\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        <div className=\"max-w-3xl space-y-6\">\n          <Card data-testid=\"card-data-source\">\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  <Database className=\"h-5 w-5 text-muted-foreground\" />\n                  <CardTitle>Data Source</CardTitle>\n                </div>\n                <Badge variant={settings?.dataSource.connected ? \"default\" : \"destructive\"}>\n                  {settings?.dataSource.connected ? (\n                    <>\n                      <CheckCircle className=\"h-3 w-3 mr-1\" />\n                      Connected\n                    </>\n                  ) : (\n                    'Disconnected'\n                  )}\n                </Badge>\n              </div>\n              <CardDescription>\n                Connection to participant data source\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Source Type</p>\n                  <p className=\"text-sm\">{settings?.dataSource.type || 'Unknown'}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Last Sync</p>\n                  <p className=\"text-sm\">{formatDate(settings?.dataSource.lastSync || null)}</p>\n                </div>\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                Data source connection is managed through Replit Connectors. Contact your administrator to modify connection settings.\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-access-control\">\n            <CardHeader>\n              <div className=\"flex items-center gap-2\">\n                <Shield className=\"h-5 w-5 text-muted-foreground\" />\n                <CardTitle>Access Control</CardTitle>\n              </div>\n              <CardDescription>\n                Manage which email addresses can access this system\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <form onSubmit={handleAddEmail} className=\"flex gap-2\">\n                <Input\n                  type=\"email\"\n                  placeholder=\"Enter email address...\"\n                  value={newEmail}\n                  onChange={(e) => setNewEmail(e.target.value)}\n                  data-testid=\"input-add-email\"\n                  className=\"flex-1\"\n                />\n                <Button\n                  type=\"submit\"\n                  disabled={addEmailMutation.isPending || !newEmail.trim()}\n                  data-testid=\"button-add-email\"\n                >\n                  <Plus className=\"h-4 w-4 mr-1\" />\n                  {addEmailMutation.isPending ? \"Adding...\" : \"Add\"}\n                </Button>\n              </form>\n\n              <Separator />\n\n              <div className=\"space-y-2\">\n                <p className=\"text-sm font-medium text-muted-foreground\">\n                  Allowed Emails ({allowedEmails?.length || 0})\n                </p>\n                {emailsLoading ? (\n                  <div className=\"animate-pulse space-y-2\">\n                    {[1, 2, 3].map((i) => (\n                      <div key={i} className=\"h-10 bg-muted rounded\" />\n                    ))}\n                  </div>\n                ) : allowedEmails && allowedEmails.length > 0 ? (\n                  <div className=\"space-y-2 max-h-64 overflow-y-auto\">\n                    {allowedEmails.map((email) => (\n                      <div\n                        key={email.id}\n                        className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg\"\n                        data-testid={`email-item-${email.id}`}\n                      >\n                        <div className=\"flex items-center gap-2 min-w-0\">\n                          <Mail className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n                          <span className=\"text-sm truncate\">{email.email}</span>\n                        </div>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => removeEmailMutation.mutate(email.id)}\n                          disabled={removeEmailMutation.isPending}\n                          data-testid={`button-remove-email-${email.id}`}\n                        >\n                          <X className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <p className=\"text-sm text-muted-foreground py-4 text-center\">\n                    No emails in allowlist. Add emails above to grant access.\n                  </p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-matching-constraints\">\n            <CardHeader>\n              <div className=\"flex items-center gap-2\">\n                <Settings2 className=\"h-5 w-5 text-muted-foreground\" />\n                <CardTitle>Matching Constraints</CardTitle>\n              </div>\n              <CardDescription>\n                Algorithm parameters for group matching\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-6\">\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Group Size</p>\n                  <p className=\"text-lg font-semibold\">\n                    {settings?.matchingConstraints.minGroupSize} - {settings?.matchingConstraints.maxGroupSize} learners\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Max Peer Groups</p>\n                  <p className=\"text-lg font-semibold\">{settings?.matchingConstraints.maxPeerGroups} groups</p>\n                </div>\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Travel Buffer</p>\n                  <p className=\"text-lg font-semibold\">{settings?.matchingConstraints.travelBufferMinutes} minutes</p>\n                </div>\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Availability Window</p>\n                  <p className=\"text-lg font-semibold\">\n                    {formatTime(settings?.matchingConstraints.availabilityStart || '08:00')} - {formatTime(settings?.matchingConstraints.availabilityEnd || '20:00')}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-statistics\">\n            <CardHeader>\n              <div className=\"flex items-center gap-2\">\n                <Layers className=\"h-5 w-5 text-muted-foreground\" />\n                <CardTitle>System Statistics</CardTitle>\n              </div>\n              <CardDescription>\n                Cumulative usage and performance data\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-primary/10 rounded-lg\">\n                    <Clock className=\"h-5 w-5 text-primary\" />\n                  </div>\n                  <div>\n                    <p className=\"text-2xl font-semibold\">{settings?.statistics.totalMatchingRuns || 0}</p>\n                    <p className=\"text-xs text-muted-foreground\">Matching Runs</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-blue-500/10 rounded-lg\">\n                    <GraduationCap className=\"h-5 w-5 text-blue-500\" />\n                  </div>\n                  <div>\n                    <p className=\"text-2xl font-semibold\">{settings?.statistics.totalLearners || 0}</p>\n                    <p className=\"text-xs text-muted-foreground\">Learners (Latest)</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-green-500/10 rounded-lg\">\n                    <Users className=\"h-5 w-5 text-green-500\" />\n                  </div>\n                  <div>\n                    <p className=\"text-2xl font-semibold\">{settings?.statistics.totalPeers || 0}</p>\n                    <p className=\"text-xs text-muted-foreground\">Learning Peers (Latest)</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-amber-500/10 rounded-lg\">\n                    <Layers className=\"h-5 w-5 text-amber-500\" />\n                  </div>\n                  <div>\n                    <p className=\"text-2xl font-semibold\">{settings?.statistics.totalGroups || 0}</p>\n                    <p className=\"text-xs text-muted-foreground\">Groups (Latest)</p>\n                  </div>\n                </div>\n              </div>\n\n              <Separator className=\"my-6\" />\n\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground mb-2\">Last Run Status</p>\n                <Badge variant={settings?.statistics.lastRunStatus === 'completed' ? 'default' : 'secondary'}>\n                  {settings?.statistics.lastRunStatus === 'completed' ? 'Completed' : \n                   settings?.statistics.lastRunStatus === 'running' ? 'Running' :\n                   settings?.statistics.lastRunStatus === 'failed' ? 'Failed' : 'No runs yet'}\n                </Badge>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-semester-reset\">\n            <CardHeader>\n              <div className=\"flex items-center gap-2\">\n                <Trash2 className=\"h-5 w-5 text-muted-foreground\" />\n                <CardTitle>Semester Reset</CardTitle>\n              </div>\n              <CardDescription>\n                Clear all matching data for a new semester\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <p className=\"text-sm text-muted-foreground\">\n                Reset the system by clearing all matching runs, proposed groups, and unmatched participants. This action is permanent and cannot be undone.\n              </p>\n              <Button\n                variant=\"destructive\"\n                onClick={() => setShowResetDialog(true)}\n                disabled={resetMutation.isPending}\n                data-testid=\"button-reset-semester\"\n              >\n                <Trash2 className=\"h-4 w-4 mr-2\" />\n                {resetMutation.isPending ? \"Resetting...\" : \"Reset for New Semester\"}\n              </Button>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-about\">\n            <CardHeader>\n              <CardTitle>About</CardTitle>\n              <CardDescription>\n                System information\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <p className=\"text-sm text-muted-foreground\">Application</p>\n                <p className=\"text-sm font-medium\">Semester Volunteer Matching System</p>\n              </div>\n              <div className=\"flex justify-between\">\n                <p className=\"text-sm text-muted-foreground\">Organization</p>\n                <p className=\"text-sm font-medium\">Mount Royal University</p>\n              </div>\n              <div className=\"flex justify-between\">\n                <p className=\"text-sm text-muted-foreground\">Version</p>\n                <p className=\"text-sm font-medium\">1.0.0</p>\n              </div>\n            </CardContent>\n          </Card>\n\n          <AlertDialog open={showResetDialog} onOpenChange={setShowResetDialog}>\n            <AlertDialogContent>\n              <AlertDialogHeader>\n                <AlertDialogTitle>Reset Semester?</AlertDialogTitle>\n                <AlertDialogDescription>\n                  This will permanently delete all matching runs, proposed groups, and unmatched participant data. This action cannot be undone. Are you sure?\n                </AlertDialogDescription>\n              </AlertDialogHeader>\n              <div className=\"space-y-2 text-sm\">\n                <p className=\"font-medium\">This will clear:</p>\n                <ul className=\"list-disc list-inside text-muted-foreground space-y-1\">\n                  <li>All matching run records</li>\n                  <li>All proposed groups</li>\n                  <li>All unmatched participant data</li>\n                </ul>\n              </div>\n              <AlertDialogCancel>Cancel</AlertDialogCancel>\n              <AlertDialogAction\n                onClick={() => resetMutation.mutate()}\n                className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              >\n                Reset\n              </AlertDialogAction>\n            </AlertDialogContent>\n          </AlertDialog>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":19095,"size_tokens":null},"shared/schema.ts":{"content":"import { z } from \"zod\";\nimport { pgTable, text, integer, timestamp, uuid, jsonb, pgEnum, index, varchar } from \"drizzle-orm/pg-core\";\nimport { sql } from \"drizzle-orm\";\n\n// Session storage table for Replit Auth\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table for Replit Auth\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n\n// Allowed emails table for access control\nexport const allowedEmails = pgTable(\"allowed_emails\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").notNull().unique(),\n  addedBy: varchar(\"added_by\"),\n  addedAt: timestamp(\"added_at\").defaultNow(),\n});\n\nexport type AllowedEmail = typeof allowedEmails.$inferSelect;\nexport type InsertAllowedEmail = typeof allowedEmails.$inferInsert;\n\n// Time slot format: \"0830-0950\"\nexport const timeSlotSchema = z.object({\n  start: z.string(), // \"08:30\"\n  end: z.string(),   // \"09:50\"\n});\n\nexport type TimeSlot = z.infer<typeof timeSlotSchema>;\n\n// Learner Request from Google Sheets\nexport const learnerRequestSchema = z.object({\n  timestamp: z.string(),\n  email: z.string().email(),\n  firstName: z.string(),\n  lastName: z.string(),\n  courseCode: z.string(),\n  instructor: z.string(),\n  instructorMatchRequired: z.boolean(),\n  sectionNumber: z.string().optional(),\n});\n\nexport type LearnerRequest = z.infer<typeof learnerRequestSchema>;\n\n// Learning Peer from Google Sheets\nexport const learningPeerSchema = z.object({\n  email: z.string().email(),\n  preferredName: z.string(),\n  lastName: z.string(),\n  groups: z.number().default(0), // Current number of assigned groups\n  courseCode1: z.string().optional(),\n  instructor1: z.string().optional(),\n  courseCode2: z.string().optional(),\n  instructor2: z.string().optional(),\n  courseCode3: z.string().optional(),\n  instructor3: z.string().optional(),\n  otherCourses: z.array(z.object({\n    courseCode: z.string(),\n    instructor: z.string(),\n  })).default([]),\n});\n\nexport type LearningPeer = z.infer<typeof learningPeerSchema>;\n\n// Class Schedule (used for both volunteers and learners)\nexport const classScheduleSchema = z.object({\n  email: z.string().email(),\n  firstName: z.string(),\n  monday: z.array(timeSlotSchema).default([]),\n  tuesday: z.array(timeSlotSchema).default([]),\n  wednesday: z.array(timeSlotSchema).default([]),\n  thursday: z.array(timeSlotSchema).default([]),\n  friday: z.array(timeSlotSchema).default([]),\n});\n\nexport type ClassSchedule = z.infer<typeof classScheduleSchema>;\n\n// Proposed Group (result of matching algorithm)\nexport const proposedGroupSchema = z.object({\n  id: z.string(),\n  courseCode: z.string(),\n  instructor: z.string(),\n  peerId: z.string(),\n  peerName: z.string(),\n  peerEmail: z.string(),\n  learners: z.array(z.object({\n    id: z.string(),\n    name: z.string(),\n    email: z.string(),\n    instructor: z.string().optional(),\n  })),\n  timeSlot: z.object({\n    day: z.enum(['monday', 'tuesday', 'wednesday', 'thursday', 'friday']),\n    start: z.string(),\n    end: z.string(),\n  }),\n  status: z.enum(['pending', 'approved', 'rejected']).default('pending'),\n});\n\nexport type ProposedGroup = z.infer<typeof proposedGroupSchema>;\n\n// Matching Run\nexport const matchingRunSchema = z.object({\n  id: z.string(),\n  timestamp: z.date(),\n  totalLearners: z.number(),\n  totalPeers: z.number(),\n  matchedLearners: z.number(),\n  unmatchedLearners: z.number(),\n  proposedGroups: z.number(),\n  status: z.enum(['running', 'completed', 'failed']),\n  newRequestsOnly: z.boolean().default(false),\n});\n\nexport type MatchingRun = z.infer<typeof matchingRunSchema>;\n\n// Unmatched Participant\nexport const unmatchedParticipantSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  email: z.string(),\n  role: z.enum(['Learner', 'Peer']),\n  courseCode: z.string(),\n  constraintFailure: z.string(),\n  suggestedAlternative: z.string().optional(),\n});\n\nexport type UnmatchedParticipant = z.infer<typeof unmatchedParticipantSchema>;\n\n// Export types for insert operations\nexport const insertProposedGroupSchema = proposedGroupSchema.omit({ id: true, status: true });\nexport const insertMatchingRunSchema = matchingRunSchema.omit({ id: true });\n\nexport type InsertProposedGroup = z.infer<typeof insertProposedGroupSchema>;\nexport type InsertMatchingRun = z.infer<typeof insertMatchingRunSchema>;\n\n// Drizzle Database Schema\nexport const statusEnum = pgEnum('status', ['running', 'completed', 'failed']);\nexport const groupStatusEnum = pgEnum('group_status', ['pending', 'approved', 'rejected']);\nexport const roleEnum = pgEnum('role', ['Learner', 'Peer']);\nexport const dayEnum = pgEnum('day', ['monday', 'tuesday', 'wednesday', 'thursday', 'friday']);\n\nexport const matchingRunsTable = pgTable('matching_runs', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  timestamp: timestamp('timestamp').notNull().defaultNow(),\n  totalLearners: integer('total_learners').notNull().default(0),\n  totalPeers: integer('total_peers').notNull().default(0),\n  matchedLearners: integer('matched_learners').notNull().default(0),\n  unmatchedLearners: integer('unmatched_learners').notNull().default(0),\n  proposedGroups: integer('proposed_groups').notNull().default(0),\n  status: statusEnum('status').notNull().default('running'),\n  newRequestsOnly: integer('new_requests_only').notNull().default(0), // Boolean stored as 0/1\n});\n\nexport const proposedGroupsTable = pgTable('proposed_groups', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  runId: uuid('run_id').references(() => matchingRunsTable.id).notNull(),\n  courseCode: text('course_code').notNull(),\n  instructor: text('instructor').notNull(),\n  peerId: text('peer_id').notNull(),\n  peerName: text('peer_name').notNull(),\n  peerEmail: text('peer_email').notNull(),\n  learners: jsonb('learners').notNull(),\n  timeSlotDay: dayEnum('time_slot_day').notNull(),\n  timeSlotStart: text('time_slot_start').notNull(),\n  timeSlotEnd: text('time_slot_end').notNull(),\n  status: groupStatusEnum('status').notNull().default('pending'),\n}, (table) => ({\n  runIdIdx: index('proposed_groups_run_id_idx').on(table.runId),\n  statusIdx: index('proposed_groups_status_idx').on(table.status),\n  courseCodeIdx: index('proposed_groups_course_code_idx').on(table.courseCode),\n}));\n\nexport const unmatchedParticipantsTable = pgTable('unmatched_participants', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  runId: uuid('run_id').references(() => matchingRunsTable.id).notNull(),\n  participantId: text('participant_id').notNull(),\n  name: text('name').notNull(),\n  email: text('email').notNull(),\n  role: roleEnum('role').notNull(),\n  courseCode: text('course_code').notNull(),\n  constraintFailure: text('constraint_failure').notNull(),\n  suggestedAlternative: text('suggested_alternative'),\n}, (table) => ({\n  runIdIdx: index('unmatched_participants_run_id_idx').on(table.runId),\n}));\n","path":null,"size_bytes":7410,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":2263,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"server/googleSheets.ts":{"content":"import { google } from 'googleapis';\nimport type {\n  LearnerRequest,\n  LearningPeer,\n  ClassSchedule,\n  TimeSlot,\n} from '@shared/schema';\n\n// WARNING: Never cache this client.\n// Access tokens expire, so a new client must be created each time.\n// Always call this function again to get a fresh client.\nasync function getGoogleSheetClient() {\n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME\n  const xReplitToken = process.env.REPL_IDENTITY \n    ? 'repl ' + process.env.REPL_IDENTITY \n    : process.env.WEB_REPL_RENEWAL \n    ? 'depl ' + process.env.WEB_REPL_RENEWAL \n    : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  const connectionSettings = await fetch(\n    'https://' + hostname + '/api/v2/connection?include_secrets=true&connector_names=google-sheet',\n    {\n      headers: {\n        'Accept': 'application/json',\n        'X_REPLIT_TOKEN': xReplitToken\n      }\n    }\n  ).then(res => res.json()).then(data => data.items?.[0]);\n\n  const accessToken = connectionSettings?.settings?.access_token || connectionSettings.settings?.oauth?.credentials?.access_token;\n\n  if (!connectionSettings || !accessToken) {\n    throw new Error('Google Sheet not connected');\n  }\n\n  const oauth2Client = new google.auth.OAuth2();\n  oauth2Client.setCredentials({\n    access_token: accessToken\n  });\n\n  return google.sheets({ version: 'v4', auth: oauth2Client });\n}\n\nconst SPREADSHEET_ID = '1pNHzIYH58a7zPTjexSQW6eGibYJGQYk5Yfv1pdNYdW8';\n\n// Parse time slot string like \"0830-0950\" to TimeSlot object\nfunction parseTimeSlot(slot: string): TimeSlot {\n  const cleaned = slot.trim();\n  const [start, end] = cleaned.split('-');\n  \n  if (!start || !end || start.length !== 4 || end.length !== 4) {\n    throw new Error(`Invalid time slot format: ${slot}`);\n  }\n  \n  return {\n    start: `${start.slice(0, 2)}:${start.slice(2)}`,\n    end: `${end.slice(0, 2)}:${end.slice(2)}`,\n  };\n}\n\n// Parse schedule field like \"0830-0950; 1000-1120\" into array of TimeSlots\nfunction parseScheduleField(field: string): TimeSlot[] {\n  if (!field || field.trim() === '') {\n    return [];\n  }\n  \n  return field\n    .split(';')\n    .map(s => s.trim())\n    .filter(s => s.length > 0)\n    .map(parseTimeSlot);\n}\n\n// Parse \"Other Courses\" field, stripping grade letters\nfunction parseOtherCourses(field: string): Array<{ courseCode: string; instructor: string }> {\n  if (!field || field.trim() === '') {\n    return [];\n  }\n  \n  const courses: Array<{ courseCode: string; instructor: string }> = [];\n  const entries = field.split(',').map(s => s.trim()).filter(s => s.length > 0);\n  \n  for (const entry of entries) {\n    // Remove grade letters like (A), (A-), (B+), etc.\n    const cleaned = entry.replace(/\\s*\\([A-F][+-]?\\)/gi, '').trim();\n    \n    // Expected format: \"COURSE CODE - Instructor Name\"\n    const parts = cleaned.split('-').map(p => p.trim());\n    if (parts.length >= 2) {\n      courses.push({\n        courseCode: parts[0],\n        instructor: parts.slice(1).join('-'), // Handle instructor names with hyphens\n      });\n    }\n  }\n  \n  return courses;\n}\n\nexport async function loadRequests(): Promise<LearnerRequest[]> {\n  const sheets = await getGoogleSheetClient();\n  \n  const response = await sheets.spreadsheets.values.get({\n    spreadsheetId: SPREADSHEET_ID,\n    range: 'Requests!A:V', // Extended to column V to include Section Number at column 21\n  });\n  \n  const rows = response.data.values || [];\n  if (rows.length === 0) {\n    return [];\n  }\n  \n  const [header, ...dataRows] = rows;\n  const requests: LearnerRequest[] = [];\n  \n  for (const row of dataRows) {\n    const email = (row[7] || '').trim(); // Column 8 in Excel = index 7\n    \n    // Skip test data\n    if (email === 'chickey@test') {\n      continue;\n    }\n    \n    if (!email) {\n      continue;\n    }\n    \n    requests.push({\n      timestamp: (row[6] || '').trim(),     // Column 7 = index 6\n      email,                                  // Column 8 = index 7\n      firstName: (row[8] || '').trim(),      // Column 9 = index 8\n      lastName: (row[11] || '').trim(),      // Column 12 = index 11\n      courseCode: (row[16] || '').trim(),    // Column 17 = index 16\n      instructor: (row[17] || '').trim(),    // Column 18 = index 17\n      instructorMatchRequired: (row[18] || '').trim().toUpperCase() === 'Y', // Column 19 = index 18\n      sectionNumber: (row[21] || '').trim() || undefined, // Column 22 = index 21\n    });\n  }\n  \n  return requests;\n}\n\nexport async function loadLearningPeers(): Promise<LearningPeer[]> {\n  const sheets = await getGoogleSheetClient();\n  \n  const response = await sheets.spreadsheets.values.get({\n    spreadsheetId: SPREADSHEET_ID,\n    range: 'Learning Peers!A:Q', // Extended to column Q to include \"Other Courses\"\n  });\n  \n  const rows = response.data.values || [];\n  if (rows.length === 0) {\n    return [];\n  }\n  \n  const [header, ...dataRows] = rows;\n  const peers: LearningPeer[] = [];\n  \n  for (const row of dataRows) {\n    const email = (row[1] || '').trim(); // Column 2 in Excel = index 1\n    \n    // Skip test data\n    if (email === 'chickey@test') {\n      continue;\n    }\n    \n    if (!email) {\n      continue;\n    }\n    \n    const otherCourses = parseOtherCourses(row[15] || ''); // Column 16 = index 15\n    \n    peers.push({\n      email,                                     // Column 2 = index 1\n      preferredName: (row[4] || '').trim(),     // Column 5 (Preferred Name) = index 4\n      lastName: (row[5] || '').trim(),          // Column 6 = index 5\n      groups: parseInt(row[8] || '0', 10) || 0, // Column 9 = index 8\n      courseCode1: (row[9] || '').trim() || undefined,  // Column 10 = index 9\n      instructor1: (row[10] || '').trim() || undefined, // Column 11 = index 10\n      courseCode2: (row[11] || '').trim() || undefined, // Column 12 = index 11\n      instructor2: (row[12] || '').trim() || undefined, // Column 13 = index 12\n      courseCode3: (row[13] || '').trim() || undefined, // Column 14 = index 13\n      instructor3: (row[14] || '').trim() || undefined, // Column 15 = index 14\n      otherCourses,                             // Column 16 = index 15\n    });\n  }\n  \n  return peers;\n}\n\nexport async function loadVolunteerSchedules(): Promise<ClassSchedule[]> {\n  const sheets = await getGoogleSheetClient();\n  \n  const response = await sheets.spreadsheets.values.get({\n    spreadsheetId: SPREADSHEET_ID,\n    range: 'Volunteer Class Schedule!A:G',\n  });\n  \n  const rows = response.data.values || [];\n  if (rows.length === 0) {\n    return [];\n  }\n  \n  const [header, ...dataRows] = rows;\n  const schedules: ClassSchedule[] = [];\n  \n  for (const row of dataRows) {\n    const email = (row[0] || '').trim();\n    \n    // Skip test data\n    if (email === 'chickey@test') {\n      continue;\n    }\n    \n    if (!email) {\n      continue;\n    }\n    \n    schedules.push({\n      email,\n      firstName: (row[1] || '').trim(),\n      monday: parseScheduleField(row[2] || ''),\n      tuesday: parseScheduleField(row[3] || ''),\n      wednesday: parseScheduleField(row[4] || ''),\n      thursday: parseScheduleField(row[5] || ''),\n      friday: parseScheduleField(row[6] || ''),\n    });\n  }\n  \n  return schedules;\n}\n\nexport async function loadLearnerSchedules(): Promise<ClassSchedule[]> {\n  const sheets = await getGoogleSheetClient();\n  \n  const response = await sheets.spreadsheets.values.get({\n    spreadsheetId: SPREADSHEET_ID,\n    range: 'Learner Class Schedule!A:G',\n  });\n  \n  const rows = response.data.values || [];\n  if (rows.length === 0) {\n    return [];\n  }\n  \n  const [header, ...dataRows] = rows;\n  const schedules: ClassSchedule[] = [];\n  \n  for (const row of dataRows) {\n    const email = (row[0] || '').trim();\n    \n    // Skip test data\n    if (email === 'chickey@test') {\n      continue;\n    }\n    \n    if (!email) {\n      continue;\n    }\n    \n    schedules.push({\n      email,\n      firstName: (row[1] || '').trim(),\n      monday: parseScheduleField(row[2] || ''),\n      tuesday: parseScheduleField(row[3] || ''),\n      wednesday: parseScheduleField(row[4] || ''),\n      thursday: parseScheduleField(row[5] || ''),\n      friday: parseScheduleField(row[6] || ''),\n    });\n  }\n  \n  return schedules;\n}\n","path":null,"size_bytes":8170,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/components/StatCard.tsx":{"content":"import { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { LucideIcon } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface StatCardProps {\n  title: string;\n  value: string | number;\n  subtitle?: string;\n  icon: LucideIcon;\n  trend?: {\n    value: string;\n    positive: boolean;\n  };\n  variant?: \"default\" | \"warning\" | \"success\";\n}\n\nexport function StatCard({ title, value, subtitle, icon: Icon, trend, variant = \"default\" }: StatCardProps) {\n  const iconColorClass = variant === \"warning\" \n    ? \"text-amber-600 dark:text-amber-500\" \n    : variant === \"success\"\n      ? \"text-green-600 dark:text-green-500\"\n      : \"text-muted-foreground\";\n\n  const valueColorClass = variant === \"warning\" \n    ? \"text-amber-700 dark:text-amber-400\" \n    : variant === \"success\"\n      ? \"text-green-700 dark:text-green-400\"\n      : \"\";\n\n  return (\n    <Card data-testid={`card-stat-${title.toLowerCase().replace(/\\s+/g, '-')}`}>\n      <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n        <p className=\"text-sm font-medium text-muted-foreground\">{title}</p>\n        <Icon className={cn(\"h-4 w-4\", iconColorClass)} />\n      </CardHeader>\n      <CardContent>\n        <div className={cn(\"text-3xl font-semibold\", valueColorClass)} data-testid={`text-stat-value-${title.toLowerCase().replace(/\\s+/g, '-')}`}>\n          {value}\n        </div>\n        {subtitle && (\n          <p className=\"text-xs text-muted-foreground mt-1\">{subtitle}</p>\n        )}\n        {trend && (\n          <p className={`text-xs mt-2 ${trend.positive ? 'text-green-600 dark:text-green-500' : 'text-red-600 dark:text-red-500'}`}>\n            {trend.positive ? '' : ''} {trend.value}\n          </p>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":1786,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"design_guidelines.md":{"content":"# Semester Volunteer Matching System - Design Guidelines\n\n## Design Approach\n**System**: Linear-inspired productivity interface with Material Design data patterns\n**Rationale**: This is a utility-focused administrative tool requiring efficient workflows, clear data visualization, and minimal cognitive load. Linear's clarity and Material Design's robust data components provide the perfect foundation.\n\n## Typography System\n\n**Font Family**: \n- Primary: Inter (via Google Fonts CDN)\n- Monospace: JetBrains Mono (for data/IDs)\n\n**Type Scale**:\n- Page Headers: text-3xl font-semibold\n- Section Headers: text-xl font-semibold  \n- Card Titles: text-base font-medium\n- Body Text: text-sm font-normal\n- Labels/Meta: text-xs font-medium uppercase tracking-wide\n- Data/Numbers: text-sm font-mono\n\n## Layout System\n\n**Spacing Primitives**: Tailwind units of 2, 3, 4, 6, 8, 12, 16\n- Consistent use of p-4, p-6, p-8 for component padding\n- Gap spacing: gap-4 for cards, gap-2 for inline elements\n- Section margins: mb-6, mb-8 for vertical rhythm\n\n**Grid Structure**:\n- Dashboard: Sidebar (256px fixed) + Main content area\n- Content max-width: max-w-7xl\n- Card grids: grid-cols-1 md:grid-cols-2 lg:grid-cols-3\n\n## Component Library\n\n### Navigation\n**Sidebar Navigation** (Left-aligned, persistent):\n- Fixed width sidebar with Mount Royal logo at top\n- Vertical nav items with icons (Heroicons)\n- Active state: subtle background treatment\n- Sections: Dashboard, Run Matching, Review Groups, Unmatched Report, Settings\n\n### Dashboard Layout\n**Top Bar**:\n- Full-width header with page title, breadcrumbs, and primary action button\n- Height: h-16 with border-b\n- Right-aligned: User profile dropdown\n\n**Main Content Area**:\n- Three-column stat cards showing: Total Learners, Total Peers, Matched This Semester\n- Each stat card: Large number display, label, trend indicator\n- Below stats: Recent activity timeline and quick actions panel\n\n### Matching Run Interface\n**Trigger Panel**:\n- Prominent card with \"Start New Matching Run\" as primary action\n- Display: Last run timestamp, data source sync status\n- Secondary action: \"Sync Google Sheets Data\" button\n- Progress indicator when run is active\n\n### Review Groups Interface\n**Group Cards Grid**:\n- Card design: Bordered container with subtle shadow\n- Card header: Course name (prominent), time slot badge\n- Card body: List of learners (with avatars/initials), peer highlighted\n- Card footer: Two-button action row (Approve - primary, Reject & Re-queue - secondary)\n\n**Layout**: 2-column grid on desktop, single column on mobile/tablet\n\n### Unmatched Report\n**Data Table**:\n- Clean table design with alternating row backgrounds\n- Columns: Name, Role, Course, Constraint Failure, Suggested Alternative\n- Row actions: Icon button for manual placement\n- Sortable headers, search/filter bar above table\n- Pagination at bottom\n\n### Email Preview Modal\n**Triggered on Approve**:\n- Modal overlay showing email preview before sending\n- Display: Recipients list, subject line, formatted email body\n- Actions: Confirm Send, Edit, Cancel\n- Checkbox: \"Send me a copy\"\n\n## Icons\n**Library**: Heroicons (outline style via CDN)\n- Navigation icons: 24px\n- Action buttons: 20px\n- Inline/table icons: 16px\n- Consistent use throughout for actions (play, check, x-mark, clock, users)\n\n## Component Treatments\n**Cards**: Rounded corners (rounded-lg), subtle border, minimal shadow\n**Buttons**: \n- Primary: Solid, rounded-md, px-4 py-2\n- Secondary: Outlined variant\n- Destructive: Use for reject actions\n**Badges**: Pill-shaped (rounded-full) for status indicators, time slots\n**Forms**: Clean inputs with floating labels, grouped in logical sections\n**Tables**: Minimal borders, clear header separation, hover states on rows\n\n## Accessibility\n- All interactive elements: min-height of h-10 (40px)\n- Form inputs: Clear labels, error states with descriptive text\n- Focus states: Visible ring on all interactive elements\n- ARIA labels for icon-only buttons\n- Keyboard navigation support throughout\n\n## Images\n**Mount Royal Logo**: Top-left of sidebar navigation (full color on light background)\n**No hero image needed** - this is an administrative tool, not a marketing page\n\n## Animations\n**Minimal and purposeful only**:\n- Page transitions: Subtle fade-in\n- Button loading states: Spinner icon\n- Success confirmations: Brief check animation\n- Avoid decorative animations - focus on functional feedback\n\nThis design creates a professional, efficient administrative interface that prioritizes clarity, speed, and data-driven decision making.","path":null,"size_bytes":4553,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"client/src/components/ActivityTimeline.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { CheckCircle, PlayCircle, XCircle, Database } from \"lucide-react\";\n\ninterface Activity {\n  id: string;\n  type: 'run' | 'approval' | 'rejection' | 'sync';\n  description: string;\n  timestamp: Date;\n}\n\ninterface ActivityTimelineProps {\n  activities: Activity[];\n}\n\nexport function ActivityTimeline({ activities }: ActivityTimelineProps) {\n  const getIcon = (type: Activity['type']) => {\n    switch (type) {\n      case 'run':\n        return <PlayCircle className=\"h-4 w-4 text-primary\" />;\n      case 'approval':\n        return <CheckCircle className=\"h-4 w-4 text-green-600\" />;\n      case 'rejection':\n        return <XCircle className=\"h-4 w-4 text-destructive\" />;\n      case 'sync':\n        return <Database className=\"h-4 w-4 text-blue-600\" />;\n    }\n  };\n\n  const formatTimestamp = (date: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - date.getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMins / 60);\n    const diffDays = Math.floor(diffHours / 24);\n\n    if (diffMins < 60) {\n      return `${diffMins}m ago`;\n    } else if (diffHours < 24) {\n      return `${diffHours}h ago`;\n    } else {\n      return `${diffDays}d ago`;\n    }\n  };\n\n  return (\n    <Card data-testid=\"card-activity-timeline\">\n      <CardHeader>\n        <CardTitle className=\"text-base\">Recent Activity</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4\">\n          {activities.length === 0 ? (\n            <p className=\"text-sm text-muted-foreground text-center py-4\">\n              No recent activity\n            </p>\n          ) : (\n            activities.map((activity) => (\n              <div key={activity.id} className=\"flex gap-3\" data-testid={`activity-${activity.id}`}>\n                <div className=\"mt-0.5\">\n                  {getIcon(activity.type)}\n                </div>\n                <div className=\"flex-1 space-y-1\">\n                  <p className=\"text-sm\">{activity.description}</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {formatTimestamp(activity.timestamp)}\n                  </p>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":2347,"size_tokens":null},"client/src/components/MatchingRunPanel.tsx":{"content":"import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { PlayCircle, RefreshCw, CheckCircle, Database, Plus } from \"lucide-react\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Label } from \"@/components/ui/label\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\n\ninterface MatchingRunPanelProps {\n  lastRun?: Date;\n  dataSourceSynced?: Date;\n  isRunning?: boolean;\n  progress?: number;\n  newRequestsOnly?: boolean;\n  onNewRequestsOnlyChange?: (checked: boolean) => void;\n  onStartRun: (newRequestsOnly: boolean) => void;\n  onSyncData: () => void;\n}\n\nexport function MatchingRunPanel({\n  lastRun,\n  dataSourceSynced,\n  isRunning = false,\n  progress = 0,\n  newRequestsOnly = false,\n  onNewRequestsOnlyChange,\n  onStartRun,\n  onSyncData\n}: MatchingRunPanelProps) {\n  const formatDate = (date?: Date) => {\n    if (!date) return 'Never';\n    return new Intl.DateTimeFormat('en-US', {\n      month: 'short',\n      day: 'numeric',\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    }).format(date);\n  };\n\n  return (\n    <Card data-testid=\"card-matching-run\">\n      <CardHeader>\n        <CardTitle className=\"text-xl\">Matching Run</CardTitle>\n        <CardDescription>\n          Trigger a new matching run to process current student and Learning Peer data\n        </CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div className=\"space-y-1\">\n            <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide\">\n              Last Run\n            </p>\n            <p className=\"text-sm font-mono\" data-testid=\"text-last-run\">\n              {formatDate(lastRun)}\n            </p>\n          </div>\n          <div className=\"space-y-1\">\n            <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide\">\n              Data Source Sync\n            </p>\n            <div className=\"flex items-center gap-2\">\n              <p className=\"text-sm font-mono\" data-testid=\"text-data-sync\">\n                {formatDate(dataSourceSynced)}\n              </p>\n              {dataSourceSynced && (\n                <Badge variant=\"secondary\" className=\"text-xs\">\n                  <CheckCircle className=\"h-3 w-3 mr-1\" />\n                  Synced\n                </Badge>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {isRunning && (\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center justify-between\">\n              <p className=\"text-sm font-medium\">Processing...</p>\n              <p className=\"text-sm text-muted-foreground\">{progress}%</p>\n            </div>\n            <Progress value={progress} data-testid=\"progress-matching\" />\n          </div>\n        )}\n\n        <div className=\"flex items-center gap-3 p-3 bg-muted rounded-md\">\n          <Checkbox\n            id=\"new-requests-only\"\n            checked={newRequestsOnly}\n            onCheckedChange={(checked) => {\n              onNewRequestsOnlyChange?.(checked === true);\n            }}\n            disabled={isRunning}\n            data-testid=\"checkbox-new-requests-only\"\n          />\n          <div className=\"flex-1\">\n            <Label htmlFor=\"new-requests-only\" className=\"cursor-pointer font-medium\">\n              Match New Requests Only\n            </Label>\n            <p className=\"text-xs text-muted-foreground\">\n              Skip already-matched learners and process only new requests\n            </p>\n          </div>\n        </div>\n\n        <div className=\"flex gap-2\">\n          <Button\n            onClick={() => onStartRun(newRequestsOnly)}\n            disabled={isRunning}\n            className=\"flex-1\"\n            data-testid=\"button-start-matching\"\n          >\n            {isRunning ? (\n              <>\n                <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n                Running...\n              </>\n            ) : (\n              <>\n                <PlayCircle className=\"h-4 w-4 mr-2\" />\n                Start New Matching Run\n              </>\n            )}\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={onSyncData}\n            disabled={isRunning}\n            data-testid=\"button-sync-data\"\n          >\n            <Database className=\"h-4 w-4 mr-2\" />\n            Sync Data\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":4588,"size_tokens":null},"server/matchingUtils.ts":{"content":"import type { TimeSlot, ClassSchedule } from '@shared/schema';\n\n// Convert time string \"HH:MM\" to minutes since midnight\nexport function timeToMinutes(time: string): number {\n  const [hours, minutes] = time.split(':').map(Number);\n  return hours * 60 + minutes;\n}\n\n// Convert minutes since midnight back to \"HH:MM\"\nexport function minutesToTime(minutes: number): string {\n  const hours = Math.floor(minutes / 60);\n  const mins = minutes % 60;\n  return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;\n}\n\n// Check if two time slots overlap\nexport function slotsOverlap(slot1: TimeSlot, slot2: TimeSlot): boolean {\n  const start1 = timeToMinutes(slot1.start);\n  const end1 = timeToMinutes(slot1.end);\n  const start2 = timeToMinutes(slot2.start);\n  const end2 = timeToMinutes(slot2.end);\n  \n  return start1 < end2 && start2 < end1;\n}\n\n// Check if a proposed session conflicts with any class times\n// Includes travel buffer (default 5 minutes before and after)\nexport function hasScheduleConflict(\n  sessionSlot: TimeSlot,\n  classSlots: TimeSlot[],\n  bufferMinutes: number = 5\n): boolean {\n  const sessionStart = timeToMinutes(sessionSlot.start);\n  const sessionEnd = timeToMinutes(sessionSlot.end);\n  \n  for (const classSlot of classSlots) {\n    const classStart = timeToMinutes(classSlot.start);\n    const classEnd = timeToMinutes(classSlot.end);\n    \n    // Check if session conflicts with class + buffer\n    const sessionStartWithBuffer = sessionStart - bufferMinutes;\n    const sessionEndWithBuffer = sessionEnd + bufferMinutes;\n    \n    if (sessionStartWithBuffer < classEnd && sessionEndWithBuffer > classStart) {\n      return true;\n    }\n  }\n  \n  return false;\n}\n\n// Get schedule for a specific day\nexport function getScheduleForDay(\n  schedule: ClassSchedule,\n  day: 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday'\n): TimeSlot[] {\n  return schedule[day] || [];\n}\n\n// Find all possible 1-hour time slots in a day that don't conflict with schedules\n// Returns slots within the availability window (08:00 - 20:00 by default)\nexport function findAvailableSlots(\n  participantSchedules: ClassSchedule[],\n  day: 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday',\n  startHour: number = 8,\n  endHour: number = 20,\n  sessionDurationMinutes: number = 60,\n  bufferMinutes: number = 5\n): TimeSlot[] {\n  const availableSlots: TimeSlot[] = [];\n  const startMinutes = startHour * 60;\n  const endMinutes = endHour * 60;\n  \n  // Try every 30-minute increment for potential session starts\n  for (let slotStart = startMinutes; slotStart + sessionDurationMinutes <= endMinutes; slotStart += 30) {\n    const slotEnd = slotStart + sessionDurationMinutes;\n    const proposedSlot: TimeSlot = {\n      start: minutesToTime(slotStart),\n      end: minutesToTime(slotEnd),\n    };\n    \n    // Check if this slot conflicts with any participant's schedule\n    let hasConflict = false;\n    for (const schedule of participantSchedules) {\n      const daySchedule = getScheduleForDay(schedule, day);\n      if (hasScheduleConflict(proposedSlot, daySchedule, bufferMinutes)) {\n        hasConflict = true;\n        break;\n      }\n    }\n    \n    if (!hasConflict) {\n      availableSlots.push(proposedSlot);\n    }\n  }\n  \n  return availableSlots;\n}\n\n// Calculate how close a time slot is to existing classes (for optimization)\n// Returns minimum distance in minutes to nearest class\nexport function calculateClassProximity(\n  sessionSlot: TimeSlot,\n  classSlots: TimeSlot[]\n): number {\n  if (classSlots.length === 0) {\n    return Infinity;\n  }\n  \n  const sessionStart = timeToMinutes(sessionSlot.start);\n  const sessionEnd = timeToMinutes(sessionSlot.end);\n  \n  let minDistance = Infinity;\n  \n  for (const classSlot of classSlots) {\n    const classStart = timeToMinutes(classSlot.start);\n    const classEnd = timeToMinutes(classSlot.end);\n    \n    // Calculate distance to this class\n    let distance: number;\n    if (sessionEnd <= classStart) {\n      // Session is before class\n      distance = classStart - sessionEnd;\n    } else if (sessionStart >= classEnd) {\n      // Session is after class\n      distance = sessionStart - classEnd;\n    } else {\n      // Should not happen if we filtered conflicts properly\n      distance = 0;\n    }\n    \n    minDistance = Math.min(minDistance, distance);\n  }\n  \n  return minDistance;\n}\n\n// Check if a time slot is between classes for a single participant\n// This is the most preferred slot type - student is already on campus\nexport function isBetweenClasses(\n  sessionSlot: TimeSlot,\n  classSlots: TimeSlot[]\n): boolean {\n  if (classSlots.length < 2) {\n    return false;\n  }\n  \n  const sessionStart = timeToMinutes(sessionSlot.start);\n  const sessionEnd = timeToMinutes(sessionSlot.end);\n  \n  let hasClassBefore = false;\n  let hasClassAfter = false;\n  \n  for (const classSlot of classSlots) {\n    const classStart = timeToMinutes(classSlot.start);\n    const classEnd = timeToMinutes(classSlot.end);\n    \n    if (classEnd <= sessionStart) {\n      hasClassBefore = true;\n    }\n    if (classStart >= sessionEnd) {\n      hasClassAfter = true;\n    }\n  }\n  \n  return hasClassBefore && hasClassAfter;\n}\n\n// Check if a time slot is between classes at the GROUP level\n// Returns true if:\n// - At least ONE person has it between their own classes (individual gap), OR\n// - The group has classes before AND after, AND those classes are close enough (within 90 min)\n//   to make it genuinely convenient (some arrive from class, others stay for next class)\nexport function isBetweenClassesForGroup(\n  sessionSlot: TimeSlot,\n  allParticipantSchedules: ClassSchedule[],\n  day: 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday'\n): boolean {\n  const sessionStart = timeToMinutes(sessionSlot.start);\n  const sessionEnd = timeToMinutes(sessionSlot.end);\n  \n  // First, check if ANY individual has this between their own classes\n  for (const schedule of allParticipantSchedules) {\n    const daySchedule = getScheduleForDay(schedule, day);\n    if (isBetweenClasses(sessionSlot, daySchedule)) {\n      return true; // Someone has it as a personal gap\n    }\n  }\n  \n  // If no individual gap, check for group-level convenience:\n  // Someone has class ending within 90 min before AND someone has class starting within 90 min after\n  let hasRecentClassBefore = false;\n  let hasUpcomingClassAfter = false;\n  const proximityWindow = 90; // minutes\n  \n  for (const schedule of allParticipantSchedules) {\n    const daySchedule = getScheduleForDay(schedule, day);\n    \n    for (const classSlot of daySchedule) {\n      const classStart = timeToMinutes(classSlot.start);\n      const classEnd = timeToMinutes(classSlot.end);\n      \n      // Class ends before session and within proximity window\n      if (classEnd <= sessionStart && (sessionStart - classEnd) <= proximityWindow) {\n        hasRecentClassBefore = true;\n      }\n      \n      // Class starts after session and within proximity window\n      if (classStart >= sessionEnd && (classStart - sessionEnd) <= proximityWindow) {\n        hasUpcomingClassAfter = true;\n      }\n    }\n  }\n  \n  return hasRecentClassBefore && hasUpcomingClassAfter;\n}\n\n// Check if a time slot is within preferred proximity (2 hours) of any class\nexport function isWithinPreferredProximity(\n  sessionSlot: TimeSlot,\n  allParticipantSchedules: ClassSchedule[],\n  day: 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday',\n  preferredProximityMinutes: number = 120\n): boolean {\n  for (const schedule of allParticipantSchedules) {\n    const daySchedule = getScheduleForDay(schedule, day);\n    const proximity = calculateClassProximity(sessionSlot, daySchedule);\n    \n    if (proximity <= preferredProximityMinutes) {\n      return true;\n    }\n  }\n  \n  return false;\n}\n\n// Map of common first name abbreviations\nconst firstNameAbbreviations: Record<string, string[]> = {\n  'peter': ['pete', 'p'],\n  'pete': ['peter', 'p'],\n  'robert': ['bob', 'rob', 'r'],\n  'bob': ['robert', 'rob', 'r'],\n  'rob': ['robert', 'bob', 'r'],\n  'james': ['jim', 'j'],\n  'jim': ['james', 'j'],\n  'william': ['bill', 'will', 'w'],\n  'bill': ['william', 'will', 'w'],\n  'will': ['william', 'bill', 'w'],\n  'richard': ['rick', 'rich', 'r'],\n  'rick': ['richard', 'rich', 'r'],\n  'rich': ['richard', 'rick', 'r'],\n  'michael': ['mike', 'm'],\n  'mike': ['michael', 'm'],\n  'christopher': ['chris', 'c'],\n  'chris': ['christopher', 'c'],\n  'jennifer': ['jen', 'jenny', 'j'],\n  'jen': ['jennifer', 'jenny', 'j'],\n  'jenny': ['jennifer', 'jen', 'j'],\n  'elizabeth': ['liz', 'beth', 'e'],\n  'liz': ['elizabeth', 'beth', 'e'],\n  'beth': ['elizabeth', 'liz', 'e'],\n};\n\n// Calculate Levenshtein distance for fuzzy matching\nfunction levenshteinDistance(str1: string, str2: string): number {\n  const len1 = str1.length;\n  const len2 = str2.length;\n  const matrix: number[][] = Array(len1 + 1).fill(null).map(() => Array(len2 + 1).fill(0));\n  \n  for (let i = 0; i <= len1; i++) matrix[i][0] = i;\n  for (let j = 0; j <= len2; j++) matrix[0][j] = j;\n  \n  for (let i = 1; i <= len1; i++) {\n    for (let j = 1; j <= len2; j++) {\n      const cost = str1[i - 1] === str2[j - 1] ? 0 : 1;\n      matrix[i][j] = Math.min(\n        matrix[i - 1][j] + 1,\n        matrix[i][j - 1] + 1,\n        matrix[i - 1][j - 1] + cost\n      );\n    }\n  }\n  \n  return matrix[len1][len2];\n}\n\n// Normalize instructor name for matching\n// Handles variations like \"Marina Elliot\" vs \"Marina Elliott\" vs \"Dr. Elliott\"\nexport function normalizeInstructorName(name: string): string {\n  if (!name) return '';\n  \n  // Remove common titles and trim\n  let normalized = name\n    .replace(/^(Dr\\.|Professor|Prof\\.|Mr\\.|Mrs\\.|Ms\\.|Miss)\\s+/gi, '')\n    .replace(/,?\\s+(Ph\\.?D\\.?|M\\.?A\\.?|B\\.?A\\.?|M\\.?Sc\\.?|B\\.?Sc\\.?)$/gi, '')\n    .trim()\n    .toLowerCase();\n  \n  // Remove extra whitespace\n  normalized = normalized.replace(/\\s+/g, ' ');\n  \n  return normalized;\n}\n\n// Create a canonical instructor name for grouping that handles abbreviations\n// This ensures \"Pete Jackson\" and \"Peter Jackson\" are treated as the same instructor\n// Also handles \"Dr. Kurosawa\" and \"Akira Kurosawa\" by matching on last name\nexport function getCanonicalInstructorName(name: string): string {\n  const normalized = normalizeInstructorName(name);\n  if (!normalized) return '';\n  \n  const parts = normalized.split(' ');\n  if (parts.length === 0) return normalized;\n  \n  // If we only have a last name (e.g., \"kurosawa\" from \"Dr. Kurosawa\")\n  // Return it as-is so it can match with any first name + same last name\n  if (parts.length === 1) {\n    return normalized;\n  }\n  \n  // We have first name + last name (or more)\n  const firstName = parts[0];\n  const lastName = parts.slice(1).join(' ');\n  \n  // Normalize first name if it's a common abbreviation\n  const abbrev = firstNameAbbreviations[firstName] || [];\n  \n  // Use the longest form of the name (e.g., \"peter\" instead of \"pete\")\n  let canonicalFirstName = firstName;\n  for (const variant of abbrev) {\n    if (variant.length > canonicalFirstName.length) {\n      canonicalFirstName = variant;\n    }\n  }\n  \n  // Also check if firstName is in the values of abbreviations (e.g., \"peter\" in abbrev[\"pete\"])\n  for (const [key, values] of Object.entries(firstNameAbbreviations)) {\n    if (values.includes(firstName) && key.length > canonicalFirstName.length) {\n      canonicalFirstName = key;\n    }\n  }\n  \n  // Return canonical form: canonical first name + last name\n  return `${canonicalFirstName} ${lastName}`;\n}\n\n// Check if two instructor names match (accounting for variations)\nexport function instructorsMatch(name1: string, name2: string): boolean {\n  const norm1 = normalizeInstructorName(name1);\n  const norm2 = normalizeInstructorName(name2);\n  \n  if (norm1 === norm2) {\n    return true;\n  }\n  \n  const words1 = norm1.split(' ');\n  const words2 = norm2.split(' ');\n  \n  if (words1.length === 0 || words2.length === 0) {\n    return false;\n  }\n  \n  const lastName1 = words1[words1.length - 1];\n  const lastName2 = words2[words2.length - 1];\n  \n  // Check if last names match exactly or with fuzzy matching (edit distance <= 1)\n  if (lastName1 === lastName2 || levenshteinDistance(lastName1, lastName2) <= 1) {\n    // If last names match, check first names\n    const firstName1 = words1.length > 1 ? words1[0] : '';\n    const firstName2 = words2.length > 1 ? words2[0] : '';\n    \n    // If both have first names, check if they're related (common abbreviations or similar)\n    if (firstName1 && firstName2) {\n      if (firstName1 === firstName2) {\n        return true;\n      }\n      \n      // Check if first names are common abbreviations of each other\n      const abbrev1 = firstNameAbbreviations[firstName1] || [];\n      const abbrev2 = firstNameAbbreviations[firstName2] || [];\n      \n      if (abbrev1.includes(firstName2) || abbrev2.includes(firstName1)) {\n        return true;\n      }\n      \n      // Check fuzzy match for first names\n      if (levenshteinDistance(firstName1, firstName2) <= 1) {\n        return true;\n      }\n    }\n    \n    // Last names match, so consider it a match even if first names differ\n    return true;\n  }\n  \n  return false;\n}\n\n// Check if a peer can teach a specific course/instructor combination\nexport function peerCanTeach(\n  peer: {\n    courseCode1?: string;\n    instructor1?: string;\n    courseCode2?: string;\n    instructor2?: string;\n    courseCode3?: string;\n    instructor3?: string;\n    otherCourses: Array<{ courseCode: string; instructor: string }>;\n  },\n  courseCode: string,\n  instructor: string\n): boolean {\n  // Check main course slots\n  const slots = [\n    { courseCode: peer.courseCode1, instructor: peer.instructor1 },\n    { courseCode: peer.courseCode2, instructor: peer.instructor2 },\n    { courseCode: peer.courseCode3, instructor: peer.instructor3 },\n    ...peer.otherCourses,\n  ];\n  \n  // If instructor is empty/blank, match ANY instructor for this course\n  const anyInstructorOk = !instructor || instructor.trim() === '';\n  \n  for (const slot of slots) {\n    if (slot.courseCode) {\n      const courseMatches = slot.courseCode.trim() === courseCode.trim();\n      \n      if (courseMatches) {\n        // If we don't care about instructor, just need course match\n        if (anyInstructorOk) {\n          return true;\n        }\n        \n        // If peer's instructor is empty, they can teach any instructor for this course\n        if (!slot.instructor || slot.instructor.trim() === '') {\n          return true;\n        }\n        \n        // Otherwise check if instructor matches\n        if (instructorsMatch(slot.instructor, instructor)) {\n          return true;\n        }\n      }\n    }\n  }\n  \n  return false;\n}\n","path":null,"size_bytes":14574,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"client/src/pages/Unmatched.tsx":{"content":"import { UnmatchedTable } from \"@/components/UnmatchedTable\";\nimport { ManualPlacementModal } from \"@/components/ManualPlacementModal\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { UnmatchedParticipant } from \"@shared/schema\";\nimport { Download } from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function Unmatched() {\n  const { toast } = useToast();\n  const [modalOpen, setModalOpen] = useState(false);\n  const [selectedParticipant, setSelectedParticipant] = useState<UnmatchedParticipant | null>(null);\n\n  const { data: unmatchedData, isLoading } = useQuery<{ success: boolean; participants: UnmatchedParticipant[] }>({\n    queryKey: ['/api/unmatched'],\n  });\n\n  const participants: UnmatchedParticipant[] = unmatchedData?.participants || [] as UnmatchedParticipant[];\n\n  const addToGroupMutation = useMutation({\n    mutationFn: async ({ groupId, participantId }: { groupId: string; participantId: string }) => {\n      const response = await apiRequest('PATCH', `/api/groups/${groupId}`, { \n        addParticipantId: participantId \n      });\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/unmatched'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/groups'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/dashboard-stats'] });\n      toast({\n        title: \"Success\",\n        description: \"Participant added to group successfully.\",\n      });\n      setModalOpen(false);\n      setSelectedParticipant(null);\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to add participant to group.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleManualPlace = (id: string) => {\n    const participant = participants.find(p => p.id === id);\n    if (participant) {\n      setSelectedParticipant(participant);\n      setModalOpen(true);\n    }\n  };\n\n  const handleSelectGroup = (groupId: string) => {\n    if (selectedParticipant) {\n      addToGroupMutation.mutate({ groupId, participantId: selectedParticipant.id });\n    }\n  };\n\n  const handleExportCSV = () => {\n    window.open('/api/export/unmatched', '_blank');\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between flex-wrap gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-semibold\" data-testid=\"text-page-title\">Unmatched Report</h1>\n          <p className=\"text-muted-foreground mt-1\">\n            Participants who could not be matched with constraint failure details\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleExportCSV}\n            disabled={participants.length === 0}\n            data-testid=\"button-export-csv\"\n          >\n            <Download className=\"h-4 w-4 mr-2\" />\n            Export CSV\n          </Button>\n          <Badge variant=\"destructive\" className=\"text-sm\" data-testid=\"badge-unmatched-count\">\n            {participants.length} Unmatched\n          </Badge>\n        </div>\n      </div>\n\n      {isLoading ? (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">Loading...</p>\n        </div>\n      ) : participants.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">No unmatched participants. All learners and peers have been successfully matched.</p>\n        </div>\n      ) : (\n        <UnmatchedTable\n          participants={participants as any[]}\n          onManualPlace={handleManualPlace}\n        />\n      )}\n\n      <ManualPlacementModal\n        isOpen={modalOpen}\n        onClose={() => {\n          setModalOpen(false);\n          setSelectedParticipant(null);\n        }}\n        participantName={selectedParticipant?.name || ''}\n        participantEmail={selectedParticipant?.email || ''}\n        courseCode={selectedParticipant?.courseCode || ''}\n        onSelectGroup={handleSelectGroup}\n        isLoading={addToGroupMutation.isPending}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":4339,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"db/schema.ts":{"content":"import { pgTable, text, integer, timestamp, uuid, jsonb, pgEnum } from \"drizzle-orm/pg-core\";\n\n// Enums\nexport const statusEnum = pgEnum('status', ['running', 'completed', 'failed']);\nexport const groupStatusEnum = pgEnum('group_status', ['pending', 'approved', 'rejected']);\nexport const roleEnum = pgEnum('role', ['Learner', 'Peer']);\nexport const dayEnum = pgEnum('day', ['monday', 'tuesday', 'wednesday', 'thursday', 'friday']);\n\n// Matching Runs table\nexport const matchingRuns = pgTable('matching_runs', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  timestamp: timestamp('timestamp').notNull().defaultNow(),\n  totalLearners: integer('total_learners').notNull().default(0),\n  totalPeers: integer('total_peers').notNull().default(0),\n  matchedLearners: integer('matched_learners').notNull().default(0),\n  unmatchedLearners: integer('unmatched_learners').notNull().default(0),\n  proposedGroups: integer('proposed_groups').notNull().default(0),\n  status: statusEnum('status').notNull().default('running'),\n});\n\n// Proposed Groups table\nexport const proposedGroups = pgTable('proposed_groups', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  runId: uuid('run_id').references(() => matchingRuns.id).notNull(),\n  courseCode: text('course_code').notNull(),\n  instructor: text('instructor').notNull(),\n  peerId: text('peer_id').notNull(),\n  peerName: text('peer_name').notNull(),\n  peerEmail: text('peer_email').notNull(),\n  learners: jsonb('learners').notNull(), // Array of {id, name, email}\n  timeSlotDay: dayEnum('time_slot_day').notNull(),\n  timeSlotStart: text('time_slot_start').notNull(),\n  timeSlotEnd: text('time_slot_end').notNull(),\n  status: groupStatusEnum('status').notNull().default('pending'),\n});\n\n// Unmatched Participants table\nexport const unmatchedParticipants = pgTable('unmatched_participants', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  runId: uuid('run_id').references(() => matchingRuns.id).notNull(),\n  participantId: text('participant_id').notNull(),\n  name: text('name').notNull(),\n  email: text('email').notNull(),\n  role: roleEnum('role').notNull(),\n  courseCode: text('course_code').notNull(),\n  constraintFailure: text('constraint_failure').notNull(),\n  suggestedAlternative: text('suggested_alternative'),\n});\n\nexport type MatchingRun = typeof matchingRuns.$inferSelect;\nexport type InsertMatchingRun = typeof matchingRuns.$inferInsert;\nexport type ProposedGroup = typeof proposedGroups.$inferSelect;\nexport type InsertProposedGroup = typeof proposedGroups.$inferInsert;\nexport type UnmatchedParticipant = typeof unmatchedParticipants.$inferSelect;\nexport type InsertUnmatchedParticipant = typeof unmatchedParticipants.$inferInsert;\n","path":null,"size_bytes":2681,"size_tokens":null},"server/dbStorage.ts":{"content":"import { drizzle } from \"drizzle-orm/neon-serverless\";\nimport { Pool, neonConfig } from \"@neondatabase/serverless\";\nimport { eq, desc } from \"drizzle-orm\";\nimport type {\n  ProposedGroup,\n  MatchingRun,\n  UnmatchedParticipant,\n  InsertProposedGroup,\n  InsertMatchingRun,\n  User,\n  UpsertUser,\n  AllowedEmail,\n} from \"@shared/schema\";\nimport { \n  matchingRunsTable, \n  proposedGroupsTable, \n  unmatchedParticipantsTable,\n  users,\n  allowedEmails,\n} from \"@shared/schema\";\nimport type { IStorage } from \"./storage\";\nimport ws from \"ws\";\n\nneonConfig.webSocketConstructor = ws;\n\nexport class DbStorage implements IStorage {\n  private db;\n\n  constructor() {\n    if (!process.env.DATABASE_URL) {\n      throw new Error(\"DATABASE_URL is not set\");\n    }\n    const pool = new Pool({ connectionString: process.env.DATABASE_URL });\n    this.db = drizzle(pool);\n  }\n\n  // User operations (required for Replit Auth)\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await this.db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await this.db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  // Matching Runs\n  async createMatchingRun(insertRun: InsertMatchingRun): Promise<MatchingRun> {\n    const dbValues = {\n      ...insertRun,\n      newRequestsOnly: insertRun.newRequestsOnly ? 1 : 0,\n    };\n    const [run] = await this.db\n      .insert(matchingRunsTable)\n      .values(dbValues)\n      .returning();\n    \n    return {\n      id: run.id,\n      timestamp: run.timestamp,\n      totalLearners: run.totalLearners,\n      totalPeers: run.totalPeers,\n      matchedLearners: run.matchedLearners,\n      unmatchedLearners: run.unmatchedLearners,\n      proposedGroups: run.proposedGroups,\n      status: run.status,\n      newRequestsOnly: Boolean(run.newRequestsOnly),\n    };\n  }\n\n  async getMatchingRun(id: string): Promise<MatchingRun | undefined> {\n    const [run] = await this.db\n      .select()\n      .from(matchingRunsTable)\n      .where(eq(matchingRunsTable.id, id));\n    \n    if (!run) return undefined;\n\n    return {\n      id: run.id,\n      timestamp: run.timestamp,\n      totalLearners: run.totalLearners,\n      totalPeers: run.totalPeers,\n      matchedLearners: run.matchedLearners,\n      unmatchedLearners: run.unmatchedLearners,\n      proposedGroups: run.proposedGroups,\n      status: run.status,\n      newRequestsOnly: Boolean(run.newRequestsOnly),\n    };\n  }\n\n  async getAllMatchingRuns(): Promise<MatchingRun[]> {\n    const runs = await this.db\n      .select()\n      .from(matchingRunsTable)\n      .orderBy(desc(matchingRunsTable.timestamp));\n\n    return runs.map(run => ({\n      id: run.id,\n      timestamp: run.timestamp,\n      totalLearners: run.totalLearners,\n      totalPeers: run.totalPeers,\n      matchedLearners: run.matchedLearners,\n      unmatchedLearners: run.unmatchedLearners,\n      proposedGroups: run.proposedGroups,\n      status: run.status,\n      newRequestsOnly: Boolean(run.newRequestsOnly),\n    }));\n  }\n\n  async getLatestMatchingRun(): Promise<MatchingRun | undefined> {\n    const runs = await this.getAllMatchingRuns();\n    return runs[0];\n  }\n\n  async updateMatchingRunStatus(id: string, status: 'running' | 'completed' | 'failed'): Promise<void> {\n    await this.db\n      .update(matchingRunsTable)\n      .set({ status })\n      .where(eq(matchingRunsTable.id, id));\n  }\n\n  async updateMatchingRunMetrics(id: string, metrics: {\n    totalLearners: number;\n    totalPeers: number;\n    matchedLearners: number;\n    unmatchedLearners: number;\n    proposedGroups: number;\n  }): Promise<void> {\n    await this.db\n      .update(matchingRunsTable)\n      .set(metrics)\n      .where(eq(matchingRunsTable.id, id));\n  }\n\n  // Proposed Groups\n  async createGroup(runId: string, insertGroup: InsertProposedGroup): Promise<ProposedGroup> {\n    const [group] = await this.db\n      .insert(proposedGroupsTable)\n      .values({\n        courseCode: insertGroup.courseCode,\n        instructor: insertGroup.instructor,\n        peerId: insertGroup.peerId,\n        peerName: insertGroup.peerName,\n        peerEmail: insertGroup.peerEmail,\n        learners: insertGroup.learners,\n        timeSlotDay: insertGroup.timeSlot.day,\n        timeSlotStart: insertGroup.timeSlot.start,\n        timeSlotEnd: insertGroup.timeSlot.end,\n        runId: runId,\n      })\n      .returning();\n\n    return {\n      id: group.id,\n      courseCode: group.courseCode,\n      instructor: group.instructor,\n      peerId: group.peerId,\n      peerName: group.peerName,\n      peerEmail: group.peerEmail,\n      learners: group.learners as Array<{id: string; name: string; email: string; instructor?: string}>,\n      timeSlot: {\n        day: group.timeSlotDay,\n        start: group.timeSlotStart,\n        end: group.timeSlotEnd,\n      },\n      status: group.status,\n    };\n  }\n\n  async getGroup(id: string): Promise<ProposedGroup | undefined> {\n    const [group] = await this.db\n      .select()\n      .from(proposedGroupsTable)\n      .where(eq(proposedGroupsTable.id, id));\n\n    if (!group) return undefined;\n\n    return {\n      id: group.id,\n      courseCode: group.courseCode,\n      instructor: group.instructor,\n      peerId: group.peerId,\n      peerName: group.peerName,\n      peerEmail: group.peerEmail,\n      learners: group.learners as Array<{id: string; name: string; email: string; instructor?: string}>,\n      timeSlot: {\n        day: group.timeSlotDay,\n        start: group.timeSlotStart,\n        end: group.timeSlotEnd,\n      },\n      status: group.status,\n    };\n  }\n\n  async getAllGroups(): Promise<ProposedGroup[]> {\n    const groups = await this.db\n      .select()\n      .from(proposedGroupsTable);\n\n    return groups.map(group => ({\n      id: group.id,\n      courseCode: group.courseCode,\n      instructor: group.instructor,\n      peerId: group.peerId,\n      peerName: group.peerName,\n      peerEmail: group.peerEmail,\n      learners: group.learners as Array<{id: string; name: string; email: string; instructor?: string}>,\n      timeSlot: {\n        day: group.timeSlotDay,\n        start: group.timeSlotStart,\n        end: group.timeSlotEnd,\n      },\n      status: group.status,\n    }));\n  }\n\n  async getGroupsByRunId(runId: string): Promise<ProposedGroup[]> {\n    const groups = await this.db\n      .select()\n      .from(proposedGroupsTable)\n      .where(eq(proposedGroupsTable.runId, runId));\n\n    return groups.map(group => ({\n      id: group.id,\n      courseCode: group.courseCode,\n      instructor: group.instructor,\n      peerId: group.peerId,\n      peerName: group.peerName,\n      peerEmail: group.peerEmail,\n      learners: group.learners as Array<{id: string; name: string; email: string; instructor?: string}>,\n      timeSlot: {\n        day: group.timeSlotDay,\n        start: group.timeSlotStart,\n        end: group.timeSlotEnd,\n      },\n      status: group.status,\n    }));\n  }\n\n  async updateGroupStatus(id: string, status: 'pending' | 'approved' | 'rejected'): Promise<void> {\n    await this.db\n      .update(proposedGroupsTable)\n      .set({ status })\n      .where(eq(proposedGroupsTable.id, id));\n  }\n\n  async updateGroup(id: string, updates: Partial<Omit<ProposedGroup, 'id' | 'status'>>): Promise<void> {\n    const dbUpdates: any = {};\n    \n    if (updates.courseCode) dbUpdates.courseCode = updates.courseCode;\n    if (updates.instructor) dbUpdates.instructor = updates.instructor;\n    if (updates.peerId) dbUpdates.peerId = updates.peerId;\n    if (updates.peerName) dbUpdates.peerName = updates.peerName;\n    if (updates.peerEmail) dbUpdates.peerEmail = updates.peerEmail;\n    if (updates.learners) dbUpdates.learners = updates.learners;\n    if (updates.timeSlot) {\n      dbUpdates.timeSlotDay = updates.timeSlot.day;\n      dbUpdates.timeSlotStart = updates.timeSlot.start;\n      dbUpdates.timeSlotEnd = updates.timeSlot.end;\n    }\n\n    await this.db\n      .update(proposedGroupsTable)\n      .set(dbUpdates)\n      .where(eq(proposedGroupsTable.id, id));\n  }\n\n  async deleteGroup(id: string): Promise<void> {\n    await this.db\n      .delete(proposedGroupsTable)\n      .where(eq(proposedGroupsTable.id, id));\n  }\n\n  // Unmatched Participants\n  async setUnmatchedParticipants(runId: string, participants: UnmatchedParticipant[]): Promise<void> {\n    // Delete existing unmatched participants for this run\n    await this.db\n      .delete(unmatchedParticipantsTable)\n      .where(eq(unmatchedParticipantsTable.runId, runId));\n\n    // Insert new unmatched participants\n    if (participants.length > 0) {\n      await this.db\n        .insert(unmatchedParticipantsTable)\n        .values(\n          participants.map(p => ({\n            runId,\n            participantId: p.id,\n            name: p.name,\n            email: p.email,\n            role: p.role,\n            courseCode: p.courseCode,\n            constraintFailure: p.constraintFailure,\n            suggestedAlternative: p.suggestedAlternative || null,\n          }))\n        );\n    }\n  }\n\n  async getUnmatchedParticipants(runId: string): Promise<UnmatchedParticipant[]> {\n    const participants = await this.db\n      .select()\n      .from(unmatchedParticipantsTable)\n      .where(eq(unmatchedParticipantsTable.runId, runId));\n\n    return participants.map(p => ({\n      id: p.participantId,\n      name: p.name,\n      email: p.email,\n      role: p.role,\n      courseCode: p.courseCode,\n      constraintFailure: p.constraintFailure,\n      suggestedAlternative: p.suggestedAlternative || undefined,\n    }));\n  }\n\n  async getLatestUnmatchedParticipants(): Promise<UnmatchedParticipant[]> {\n    const latestRun = await this.getLatestMatchingRun();\n    if (!latestRun) return [];\n    return this.getUnmatchedParticipants(latestRun.id);\n  }\n\n  async getApprovedLearnerEmails(): Promise<string[]> {\n    const approvedGroups = await this.db\n      .select()\n      .from(proposedGroupsTable)\n      .where(eq(proposedGroupsTable.status, 'approved'));\n\n    const emails = new Set<string>();\n    for (const group of approvedGroups) {\n      const learners = group.learners as any[];\n      if (Array.isArray(learners)) {\n        for (const learner of learners) {\n          if (learner.email) {\n            emails.add(learner.email);\n          }\n        }\n      }\n    }\n    return Array.from(emails);\n  }\n\n  async resetSemester(): Promise<void> {\n    // Delete all unmatched participants first (foreign key constraint)\n    await this.db.delete(unmatchedParticipantsTable);\n    \n    // Delete all proposed groups (foreign key constraint)\n    await this.db.delete(proposedGroupsTable);\n    \n    // Delete all matching runs\n    await this.db.delete(matchingRunsTable);\n  }\n\n  // Allowed Emails operations\n  async getAllowedEmails(): Promise<AllowedEmail[]> {\n    return await this.db\n      .select()\n      .from(allowedEmails)\n      .orderBy(desc(allowedEmails.addedAt));\n  }\n\n  async isEmailAllowed(email: string): Promise<boolean> {\n    const normalizedEmail = email.toLowerCase().trim();\n    const results = await this.db.select().from(allowedEmails);\n    \n    for (const allowed of results) {\n      if (allowed.email.toLowerCase().trim() === normalizedEmail) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  async addAllowedEmail(email: string, addedBy?: string): Promise<AllowedEmail> {\n    const [result] = await this.db\n      .insert(allowedEmails)\n      .values({\n        email: email.toLowerCase().trim(),\n        addedBy: addedBy || null,\n      })\n      .returning();\n    return result;\n  }\n\n  async removeAllowedEmail(id: string): Promise<void> {\n    await this.db\n      .delete(allowedEmails)\n      .where(eq(allowedEmails.id, id));\n  }\n}\n","path":null,"size_bytes":11798,"size_tokens":null},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User | null>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user: user ?? null,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","path":null,"size_bytes":328,"size_tokens":null},"server/emailTemplate.ts":{"content":"import type { ProposedGroup } from \"@shared/schema\";\n\nfunction formatTimeSlot(group: ProposedGroup, peerGroupNumber: number): string {\n  const dayMap: Record<string, string> = {\n    monday: 'Monday',\n    tuesday: 'Tuesday',\n    wednesday: 'Wednesday',\n    thursday: 'Thursday',\n    friday: 'Friday',\n  };\n  \n  const formatTime = (time: string) => {\n    const [hours, minutes] = time.split(':').map(Number);\n    const period = hours >= 12 ? 'PM' : 'AM';\n    const displayHours = hours % 12 || 12;\n    return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;\n  };\n  \n  return `${dayMap[group.timeSlot.day]} ${formatTime(group.timeSlot.start)} - ${formatTime(group.timeSlot.end)}`;\n}\n\nexport function generateMatchConfirmationEmail(\n  group: ProposedGroup,\n  peerGroupNumber: number\n): { subject: string; body: string } {\n  const learnerNames = group.learners.map(l => l.name).join(', ');\n  const meetingTime = formatTimeSlot(group, peerGroupNumber);\n  \n  const body = `Hi All,\n\nI am happy to confirm that you will be working together to review content from ${group.courseCode} this semester! \n\nLearning Peer (LP): ${group.peerName}\nPotential meetings times (based on course schedules): ${meetingTime}\nRefer to this group as: ${group.courseCode} - ${group.peerName} - Group ${peerGroupNumber}\nFollow up with your Learner(s) within two business days to arrange your first meeting\nLog your first meeting on Google Calendar \nReoccurring invites will auto-generate when you complete the PLP Agreement\nLearner(s): ${learnerNames}\nYour LP will email you within two business days from receiving this email  \nPlease respond ASAP (no later than two business days)\nBring a copy of your course outline and class schedule to your first session\nYour LP will create a Google Calendar invite for the first meeting\nPlease email PLP@mtroyal.ca if you no longer require support or have questions\nThe First Meeting:\nFirst meetings are 60 minutes \nUse the First Meeting Checklist to guide your session\nTake time to get to know each other, review the PLP Agreement, and set expectations, goals, and regular meeting times\nOther Reminders:\nSessions should take place Monday to Friday between 8:00 AM - 8:00 PM  If necessary sessions can be held on the weekend ONLINE only.     \nPlease email PLP@mtroyal.ca to approve alternate times\nPLP runs until the last day of classes \nPlease notify your LP and PLP staff if you need to withdraw from PLP\nIf you have questions at any time, please do not hesitate to reach out.\n\nHave a fantastic semester!\n\n-The Peer Learning Team`;\n\n  const subject = `${group.courseCode} - ${group.peerName} Group ${peerGroupNumber}`;\n\n  return { subject, body };\n}\n","path":null,"size_bytes":2679,"size_tokens":null},"client/src/pages/PeersWithoutGroups.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { LearningPeer } from \"@shared/schema\";\nimport { Users, AlertCircle } from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport { useState } from \"react\";\n\ninterface PeerWithoutGroupsResponse {\n  success: boolean;\n  peers: LearningPeer[];\n}\n\nexport default function PeersWithoutGroups() {\n  const [searchQuery, setSearchQuery] = useState('');\n\n  const { data, isLoading } = useQuery<PeerWithoutGroupsResponse>({\n    queryKey: ['/api/peers/without-groups'],\n  });\n\n  const peers = data?.peers || [];\n  const filteredPeers = peers.filter(peer =>\n    peer.preferredName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    peer.lastName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    peer.email.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const getCourses = (peer: LearningPeer): string => {\n    const courses: string[] = [];\n    if (peer.courseCode1) courses.push(peer.courseCode1);\n    if (peer.courseCode2) courses.push(peer.courseCode2);\n    if (peer.courseCode3) courses.push(peer.courseCode3);\n    return courses.join(', ') || 'No courses listed';\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold\" data-testid=\"text-page-title\">Peers Without Groups</h1>\n        <p className=\"text-muted-foreground mt-1\">\n          Learning peers who have not been assigned to any groups\n        </p>\n      </div>\n\n      <div className=\"flex items-center gap-2\">\n        <AlertCircle className=\"w-5 h-5\" />\n        <span className=\"text-sm font-medium\">\n          {filteredPeers.length} peer{filteredPeers.length !== 1 ? 's' : ''} available\n        </span>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid gap-4\">\n          {[1, 2, 3].map((i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardHeader className=\"pb-3\">\n                <div className=\"h-5 bg-muted rounded w-40\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <div className=\"h-4 bg-muted rounded w-60\" />\n                  <div className=\"h-4 bg-muted rounded w-48\" />\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : peers.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">All learning peers have been assigned to groups!</p>\n        </div>\n      ) : (\n        <>\n          <div>\n            <Input\n              placeholder=\"Search by name or email...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"max-w-md\"\n              data-testid=\"input-search-peers\"\n            />\n          </div>\n\n          {filteredPeers.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              No peers match your search\n            </div>\n          ) : (\n            <div className=\"grid gap-4\">\n              {filteredPeers.map((peer) => (\n                <Card key={peer.email} data-testid={`card-peer-${peer.email}`}>\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-start justify-between\">\n                      <div>\n                        <CardTitle className=\"text-lg\" data-testid={`text-peer-name-${peer.email}`}>\n                          {peer.preferredName} {peer.lastName}\n                        </CardTitle>\n                        <p className=\"text-sm text-muted-foreground mt-1\" data-testid={`text-peer-email-${peer.email}`}>\n                          {peer.email}\n                        </p>\n                      </div>\n                      <Badge variant=\"outline\" data-testid={`badge-availability-${peer.email}`}>\n                        Available\n                      </Badge>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"space-y-3\">\n                    <div>\n                      <p className=\"text-sm font-medium text-muted-foreground mb-1\">Courses Teaching:</p>\n                      <p className=\"text-sm\" data-testid={`text-courses-${peer.email}`}>\n                        {getCourses(peer)}\n                      </p>\n                    </div>\n                    \n                    <div>\n                      <p className=\"text-sm font-medium text-muted-foreground mb-1\">Max Groups:</p>\n                      <p className=\"text-sm\" data-testid={`text-max-groups-${peer.email}`}>\n                        {peer.groups || 0} group{(peer.groups || 0) !== 1 ? 's' : ''}\n                      </p>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":4984,"size_tokens":null},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","path":null,"size_bytes":116,"size_tokens":null},"client/src/components/ManualPlacementModal.tsx":{"content":"import { useState } from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { ProposedGroup } from \"@shared/schema\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\n\ninterface ManualPlacementModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  participantName: string;\n  participantEmail: string;\n  courseCode: string;\n  onSelectGroup: (groupId: string) => void;\n  isLoading?: boolean;\n}\n\nfunction formatTimeSlot(group: ProposedGroup): string {\n  const dayMap: Record<string, string> = {\n    monday: 'Mon',\n    tuesday: 'Tue',\n    wednesday: 'Wed',\n    thursday: 'Thu',\n    friday: 'Fri',\n  };\n  \n  const formatTime = (time: string) => {\n    const [hours, minutes] = time.split(':').map(Number);\n    const period = hours >= 12 ? 'PM' : 'AM';\n    const displayHours = hours % 12 || 12;\n    return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;\n  };\n  \n  return `${dayMap[group.timeSlot.day]} ${formatTime(group.timeSlot.start)} - ${formatTime(group.timeSlot.end)}`;\n}\n\nexport function ManualPlacementModal({\n  isOpen,\n  onClose,\n  participantName,\n  participantEmail,\n  courseCode,\n  onSelectGroup,\n  isLoading,\n}: ManualPlacementModalProps) {\n  const [selectedGroupId, setSelectedGroupId] = useState<string | null>(null);\n\n  const { data: groupsData } = useQuery<{ success: boolean; groups: ProposedGroup[] }>({\n    queryKey: ['/api/groups'],\n    enabled: isOpen,\n  });\n\n  // Filter groups by course code - show both pending and approved\n  const availableGroups = (groupsData?.groups || []).filter(\n    (group) => group.courseCode === courseCode\n  );\n\n  const handleSelectGroup = () => {\n    if (selectedGroupId) {\n      onSelectGroup(selectedGroupId);\n      setSelectedGroupId(null);\n      onClose();\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl\" data-testid=\"modal-manual-placement\">\n        <DialogHeader>\n          <DialogTitle>Manually Add to Group</DialogTitle>\n          <DialogDescription>\n            Add {participantName} to an existing group\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <div className=\"bg-muted/50 p-3 rounded-lg space-y-2\">\n            <p className=\"text-sm\">\n              <span className=\"font-medium\">Participant:</span> {participantName} ({participantEmail})\n            </p>\n            <p className=\"text-sm\">\n              <span className=\"font-medium\">Course:</span> {courseCode}\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"font-medium mb-3\">Available Groups for {courseCode}</h3>\n            {isLoading ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                Loading groups...\n              </div>\n            ) : availableGroups.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                No groups available for {courseCode}\n              </div>\n            ) : (\n              <ScrollArea className=\"h-[300px] border rounded-lg p-4\">\n                <div className=\"space-y-2\" data-testid=\"list-available-groups\">\n                  {availableGroups.map((group) => (\n                    <button\n                      key={group.id}\n                      onClick={() => setSelectedGroupId(group.id)}\n                      className={`w-full text-left p-3 rounded-lg border-2 transition-colors ${\n                        selectedGroupId === group.id\n                          ? 'border-primary bg-primary/5'\n                          : 'border-muted hover:border-muted-foreground/50'\n                      }`}\n                      data-testid={`button-group-${group.id}`}\n                    >\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <div className=\"flex-1\">\n                          <p className=\"font-medium text-sm\">{group.peerName}</p>\n                          <p className=\"text-xs text-muted-foreground mt-1\">\n                            {formatTimeSlot(group)}\n                          </p>\n                          <p className=\"text-xs text-muted-foreground mt-1\">\n                            {group.learners.length} learner{group.learners.length !== 1 ? 's' : ''}\n                          </p>\n                        </div>\n                        <Badge \n                          variant={group.status === 'approved' ? 'default' : 'secondary'}\n                          data-testid={`badge-status-${group.id}`}\n                        >\n                          {group.status}\n                        </Badge>\n                      </div>\n                    </button>\n                  ))}\n                </div>\n              </ScrollArea>\n            )}\n          </div>\n\n          <div className=\"flex justify-end gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={onClose}\n              data-testid=\"button-cancel\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSelectGroup}\n              disabled={!selectedGroupId}\n              data-testid=\"button-confirm-placement\"\n            >\n              Add to Group\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":5538,"size_tokens":null},"client/src/pages/Landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { Users, Calendar, CheckCircle, ArrowRight, ShieldX } from \"lucide-react\";\n\nexport default function Landing() {\n  const urlParams = new URLSearchParams(window.location.search);\n  const accessDenied = urlParams.get('error') === 'access_denied';\n  \n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <header className=\"border-b px-6 py-4\">\n        <div className=\"max-w-6xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <Users className=\"h-6 w-6 text-primary\" />\n            <span className=\"font-semibold text-lg\">Volunteer Matching System</span>\n          </div>\n          <Button asChild data-testid=\"button-login\">\n            <a href=\"/api/login\">\n              Sign In\n              <ArrowRight className=\"h-4 w-4 ml-2\" />\n            </a>\n          </Button>\n        </div>\n      </header>\n\n      <main className=\"flex-1 flex items-center justify-center px-6 py-12\">\n        {accessDenied && (\n          <div className=\"absolute top-20 left-1/2 -translate-x-1/2 w-full max-w-lg px-4\">\n            <Alert variant=\"destructive\" data-testid=\"alert-access-denied\">\n              <ShieldX className=\"h-4 w-4\" />\n              <AlertTitle>Access Denied</AlertTitle>\n              <AlertDescription>\n                Your email is not authorized to access this system. Please contact the administrator \n                to request access.\n              </AlertDescription>\n            </Alert>\n          </div>\n        )}\n        <div className=\"max-w-4xl mx-auto text-center\">\n          <h1 className=\"text-4xl font-bold tracking-tight mb-4\">\n            Semester Volunteer Matching System\n          </h1>\n          <p className=\"text-xl text-muted-foreground mb-8 max-w-2xl mx-auto\">\n            Automate the matching of students seeking academic help with qualified Learning Peers \n            based on course requirements, instructor preferences, and schedule availability.\n          </p>\n          \n          <div className=\"grid md:grid-cols-3 gap-6 mb-12\">\n            <Card>\n              <CardHeader>\n                <Calendar className=\"h-10 w-10 text-primary mb-2 mx-auto\" />\n                <CardTitle className=\"text-lg\">Smart Scheduling</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <CardDescription>\n                  Automatically detects schedule conflicts and finds optimal meeting times \n                  with travel buffers.\n                </CardDescription>\n              </CardContent>\n            </Card>\n            \n            <Card>\n              <CardHeader>\n                <Users className=\"h-10 w-10 text-primary mb-2 mx-auto\" />\n                <CardTitle className=\"text-lg\">Group Optimization</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <CardDescription>\n                  Creates balanced groups of 2-4 learners per peer, maximizing match rates \n                  while respecting constraints.\n                </CardDescription>\n              </CardContent>\n            </Card>\n            \n            <Card>\n              <CardHeader>\n                <CheckCircle className=\"h-10 w-10 text-primary mb-2 mx-auto\" />\n                <CardTitle className=\"text-lg\">Admin Review</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <CardDescription>\n                  Review proposed matches, approve or reject groups, and manually adjust \n                  placements as needed.\n                </CardDescription>\n              </CardContent>\n            </Card>\n          </div>\n\n          <Button size=\"lg\" asChild data-testid=\"button-get-started\">\n            <a href=\"/api/login\">\n              Sign In to Get Started\n              <ArrowRight className=\"h-5 w-5 ml-2\" />\n            </a>\n          </Button>\n          \n          <p className=\"text-sm text-muted-foreground mt-6\">\n            Mount Royal University Administration Tool\n          </p>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":4265,"size_tokens":null},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const claims = tokens.claims();\n    if (!claims) {\n      return verified(null, false, { message: \"invalid_claims\" });\n    }\n    \n    const email = claims[\"email\"] as string | undefined;\n    if (!email) {\n      return verified(null, false, { message: \"no_email\" });\n    }\n    \n    // Check if email is on the allowlist\n    const isAllowed = await storage.isEmailAllowed(email);\n    if (!isAllowed) {\n      return verified(null, false, { message: \"access_denied\" });\n    }\n    \n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(claims);\n    verified(null, user);\n  };\n\n  // Keep track of registered strategies\n  const registeredStrategies = new Set<string>();\n\n  // Helper function to ensure strategy exists for a domain\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, (err: any, user: any, info: any) => {\n      if (err) {\n        return next(err);\n      }\n      if (!user) {\n        // Check for access denied (email not on allowlist)\n        if (info?.message === \"access_denied\") {\n          return res.redirect(\"/?error=access_denied\");\n        }\n        return res.redirect(\"/api/login\");\n      }\n      req.logIn(user, (loginErr) => {\n        if (loginErr) {\n          return next(loginErr);\n        }\n        return res.redirect(\"/\");\n      });\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","path":null,"size_bytes":5382,"size_tokens":null},"client/src/pages/Matched.tsx":{"content":"import { GroupCard } from \"@/components/GroupCard\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { ProposedGroup } from \"@shared/schema\";\nimport { Users, Mail, Download } from \"lucide-react\";\n\nfunction formatTimeSlot(group: ProposedGroup): string {\n  const dayMap: Record<string, string> = {\n    monday: 'Mon',\n    tuesday: 'Tue',\n    wednesday: 'Wed',\n    thursday: 'Thu',\n    friday: 'Fri',\n  };\n  \n  const formatTime = (time: string) => {\n    const [hours, minutes] = time.split(':').map(Number);\n    const period = hours >= 12 ? 'PM' : 'AM';\n    const displayHours = hours % 12 || 12;\n    return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;\n  };\n  \n  return `${dayMap[group.timeSlot.day]} ${formatTime(group.timeSlot.start)} - ${formatTime(group.timeSlot.end)}`;\n}\n\nfunction getGroupEmailLink(group: any): string {\n  const emails: string[] = [];\n  \n  // Add peer email\n  if (group.peerEmail) {\n    emails.push(group.peerEmail);\n  }\n  \n  // Add learner emails\n  group.learners.forEach((learner: any) => {\n    if (learner.email) {\n      emails.push(learner.email);\n    }\n  });\n  \n  const to = emails.join(',');\n  const subject = encodeURIComponent(`${group.courseCode} - ${group.peerName} Group ${group.peerGroupNumber}`);\n  \n  return `mailto:${to}?subject=${subject}`;\n}\n\nfunction exportToCSV(groups: any[]): void {\n  if (groups.length === 0) return;\n  \n  // Build CSV headers\n  const headers = ['Group ID', 'Course Code', 'Peer Name', 'Peer Email', 'Status', 'Day', 'Start Time', 'End Time', 'Learner Names', 'Learner Instructors', 'Learner Emails'];\n  \n  // Build CSV rows\n  const rows = groups.map(g => [\n    g.id,\n    g.courseCode,\n    g.peerName,\n    g.peerEmail,\n    g.status,\n    g.timeSlot.day,\n    g.timeSlot.start,\n    g.timeSlot.end,\n    g.learners.map((l: any) => l.name).join('; '),\n    g.learners.map((l: any) => l.instructor || 'N/A').join('; '),\n    g.learners.map((l: any) => l.email).join('; '),\n  ]);\n  \n  // Create CSV string\n  const csv = [headers.join(','), ...rows.map(row => row.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(','))].join('\\n');\n  \n  // Create blob and trigger download\n  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n  const link = document.createElement('a');\n  const url = URL.createObjectURL(blob);\n  \n  link.setAttribute('href', url);\n  link.setAttribute('download', `matched-groups-${new Date().toISOString().split('T')[0]}.csv`);\n  link.style.visibility = 'hidden';\n  \n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n}\n\nexport default function Matched() {\n  const { data: groupsData, isLoading } = useQuery<{ success: boolean; groups: ProposedGroup[] }>({\n    queryKey: ['/api/groups'],\n  });\n\n  const approvedGroups = (groupsData?.groups || []).filter(group => group.status === 'approved');\n\n  // Calculate group number for each peer\n  const peerGroupCounts = new Map<string, number>();\n  const groupsWithNumbers = approvedGroups.map((g: ProposedGroup) => {\n    const peerKey = g.peerId;\n    const groupNumber = (peerGroupCounts.get(peerKey) || 0) + 1;\n    peerGroupCounts.set(peerKey, groupNumber);\n    return {\n      ...g,\n      peerGroupNumber: groupNumber,\n    };\n  });\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold\" data-testid=\"text-page-title\">Matched Groups</h1>\n        <p className=\"text-muted-foreground mt-1\">\n          Approved groups ready for Learning Peer sessions\n        </p>\n      </div>\n\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <Users className=\"w-5 h-5\" />\n          <span className=\"text-sm font-medium\">\n            {groupsWithNumbers.length} approved group{groupsWithNumbers.length !== 1 ? 's' : ''}\n          </span>\n        </div>\n        {groupsWithNumbers.length > 0 && (\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={() => exportToCSV(groupsWithNumbers)}\n            data-testid=\"button-export-matched-csv\"\n          >\n            <Download className=\"h-4 w-4 mr-2\" />\n            Export to CSV\n          </Button>\n        )}\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid gap-4\">\n          {[1, 2, 3].map((i) => (\n            <div key={i} className=\"h-32 bg-muted animate-pulse rounded-lg\" />\n          ))}\n        </div>\n      ) : groupsWithNumbers.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">No approved groups yet</p>\n          <p className=\"text-sm text-muted-foreground mt-1\">\n            Review and approve groups from the Review Groups page to see them here\n          </p>\n        </div>\n      ) : (\n        <div className=\"grid gap-4\">\n          {groupsWithNumbers.map((group: any) => (\n            <div\n              key={group.id}\n              className=\"border rounded-lg p-4 space-y-3\"\n              data-testid={`matched-group-${group.id}`}\n            >\n              <div className=\"flex items-start justify-between\">\n                <div>\n                  <h3 className=\"font-semibold\" data-testid={`text-peer-${group.id}`}>\n                    {group.peerName} - Group {group.peerGroupNumber}\n                  </h3>\n                  <p className=\"text-sm text-muted-foreground\" data-testid={`text-course-${group.id}`}>\n                    {group.courseCode}\n                  </p>\n                </div>\n                <Badge variant=\"secondary\" data-testid={`badge-status-${group.id}`}>\n                  Approved\n                </Badge>\n              </div>\n\n              <div className=\"space-y-2\">\n                <div className=\"text-sm\">\n                  <p className=\"font-medium mb-1\">Learners:</p>\n                  <ul className=\"space-y-1 ml-2\">\n                    {group.learners.map((learner: any, idx: number) => (\n                      <li key={idx} className=\"text-sm\" data-testid={`text-learner-${group.id}-${idx}`}>\n                        {learner.name}\n                        {learner.instructor && (\n                          <span className=\"text-muted-foreground text-xs ml-2\">\n                            ({learner.instructor})\n                          </span>\n                        )}\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              </div>\n\n              <div className=\"pt-2 border-t space-y-3\">\n                <p className=\"text-xs text-muted-foreground\" data-testid={`text-time-${group.id}`}>\n                  {formatTimeSlot(group)}\n                </p>\n                \n                <Button\n                  size=\"sm\"\n                  variant=\"outline\"\n                  onClick={() => {\n                    window.location.href = getGroupEmailLink(group);\n                  }}\n                  data-testid={`button-email-group-${group.id}`}\n                >\n                  <Mail className=\"h-4 w-4 mr-2\" />\n                  Email Group\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":7244,"size_tokens":null}},"version":2}